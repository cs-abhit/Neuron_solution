<?xml version="1.0"?>
<ESBMessagePipelineStorage xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
  <Id>d395d687-cdf7-4291-b558-f001435e7e91</Id>
  <Version>ab23c9f6-2e41-485c-bcb7-be52e29540cb</Version>
  <BusinessFlows />
  <Description />
  <Name>Enrich_LIMS_MaterialLot_ORIG</Name>
  <IsSystemObject>false</IsSystemObject>
  <IsPrivate>false</IsPrivate>
  <Category>General</Category>
  <IsEncrypted>true</IsEncrypted>
  <Path>Main Processes</Path>
  <PipelineBlob>&lt;ESBMessagePipeline xmlns:i="http://www.w3.org/2001/XMLSchema-instance" xmlns="http://schemas.neuronesb.com/pipelines/"&gt;&lt;Category&gt;General&lt;/Category&gt;&lt;Description /&gt;&lt;GlobalProperties xmlns:d2p1="http://schemas.microsoft.com/2003/10/Serialization/Arrays" /&gt;&lt;Name&gt;Enrich_LIMS_MaterialLot_ORIG&lt;/Name&gt;&lt;Properties xmlns:d2p1="http://schemas.microsoft.com/2003/10/Serialization/Arrays" /&gt;&lt;ReferencedAssemblies xmlns:d2p1="http://schemas.microsoft.com/2003/10/Serialization/Arrays"&gt;&lt;d2p1:string&gt;System.Configuration, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a&lt;/d2p1:string&gt;&lt;/ReferencedAssemblies&gt;&lt;Steps&gt;&lt;ESBMessagePipelineStep i:type="ExceptionPipelineStepOfESBMessagexAPWb1W4"&gt;&lt;Bindings xmlns:d4p1="http://schemas.datacontract.org/2004/07/Neuron.ComponentModel" /&gt;&lt;BreakPoint&gt;Disable&lt;/BreakPoint&gt;&lt;Disable&gt;false&lt;/Disable&gt;&lt;Id&gt;8bb7c1a9-bffe-428c-8dd6-ec464dcf620b&lt;/Id&gt;&lt;Name&gt;Catch Exceptions&lt;/Name&gt;&lt;Uniquename&gt;a41b1370-35f5-484c-8129-de326a653b7f&lt;/Uniquename&gt;&lt;Catch&gt;&lt;Bindings xmlns:d5p1="http://schemas.datacontract.org/2004/07/Neuron.ComponentModel" /&gt;&lt;BreakPoint&gt;Disable&lt;/BreakPoint&gt;&lt;Disable&gt;false&lt;/Disable&gt;&lt;Id&gt;3a0e673c-22a2-433a-8357-a84014e64d74&lt;/Id&gt;&lt;Name&gt;Group&lt;/Name&gt;&lt;Uniquename /&gt;&lt;Children&gt;&lt;ESBMessagePipelineStep xmlns:d6p1="http://schemas.neuronesb.com/pipelines/esb/" i:type="d6p1:EsbMessagePipelineExecutionPipelineStep"&gt;&lt;Bindings xmlns:d7p1="http://schemas.datacontract.org/2004/07/Neuron.ComponentModel" /&gt;&lt;BreakPoint&gt;Disable&lt;/BreakPoint&gt;&lt;Disable&gt;false&lt;/Disable&gt;&lt;Id&gt;d2de981b-c9a0-46a0-a60e-3225017c3bf5&lt;/Id&gt;&lt;Name&gt;Exception Handler&lt;/Name&gt;&lt;Uniquename /&gt;&lt;d6p1:FileName i:nil="true" /&gt;&lt;d6p1:MaxInstances&gt;100&lt;/d6p1:MaxInstances&gt;&lt;d6p1:PipelineName&gt;Exception Handler&lt;/d6p1:PipelineName&gt;&lt;d6p1:PoolTimeout&gt;PT1M&lt;/d6p1:PoolTimeout&gt;&lt;/ESBMessagePipelineStep&gt;&lt;/Children&gt;&lt;/Catch&gt;&lt;Finally&gt;&lt;Bindings xmlns:d5p1="http://schemas.datacontract.org/2004/07/Neuron.ComponentModel" /&gt;&lt;BreakPoint&gt;Disable&lt;/BreakPoint&gt;&lt;Disable&gt;false&lt;/Disable&gt;&lt;Id&gt;c27f13d8-2f59-4586-bd30-30f3e80befa3&lt;/Id&gt;&lt;Name&gt;Group&lt;/Name&gt;&lt;Uniquename /&gt;&lt;Children /&gt;&lt;/Finally&gt;&lt;Try&gt;&lt;Bindings xmlns:d5p1="http://schemas.datacontract.org/2004/07/Neuron.ComponentModel" /&gt;&lt;BreakPoint&gt;Disable&lt;/BreakPoint&gt;&lt;Disable&gt;false&lt;/Disable&gt;&lt;Id&gt;e1f15519-ab6f-4495-bca7-350973c328e8&lt;/Id&gt;&lt;Name&gt;Group&lt;/Name&gt;&lt;Uniquename /&gt;&lt;Children&gt;&lt;ESBMessagePipelineStep xmlns:d6p1="http://schemas.neuronesb.com/pipelines/esb/" i:type="d6p1:EsbMessageCSharpCodePipelineStep"&gt;&lt;Bindings xmlns:d7p1="http://schemas.datacontract.org/2004/07/Neuron.ComponentModel" /&gt;&lt;BreakPoint&gt;Disable&lt;/BreakPoint&gt;&lt;Disable&gt;false&lt;/Disable&gt;&lt;Id&gt;7cac5365-9528-4d94-8669-3d67ddb6a419&lt;/Id&gt;&lt;Name&gt;Check for Retry&lt;/Name&gt;&lt;Uniquename /&gt;&lt;BreakPointLines xmlns:d7p1="http://schemas.microsoft.com/2003/10/Serialization/Arrays" /&gt;&lt;Code&gt;//Check for retry. If it is a retry, sleep for 30 seconds
if (context.State.ContainsKey("RetryMessageID"))
{
        if (context.Data.Header.MessageId == (string)context.State["RetryMessageID"])
        {
               System.Threading.Thread.Sleep(30000);
        }
        else
        {
               context.State["RetryMessageID"] = context.Data.Header.MessageId;
        }
}
else
{
        context.State.Add("RetryMessageID", context.Data.Header.MessageId);
}&lt;/Code&gt;&lt;ReferencedAssemblies xmlns:d7p1="http://schemas.microsoft.com/2003/10/Serialization/Arrays"&gt;&lt;d7p1:string&gt;Neuron&lt;/d7p1:string&gt;&lt;d7p1:string&gt;Neuron.Pipelines&lt;/d7p1:string&gt;&lt;d7p1:string&gt;Neuron.Esb&lt;/d7p1:string&gt;&lt;d7p1:string&gt;System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d7p1:string&gt;&lt;d7p1:string&gt;System.Core, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d7p1:string&gt;&lt;d7p1:string&gt;System.Xml, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d7p1:string&gt;&lt;d7p1:string&gt;System.Xml.Linq, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d7p1:string&gt;&lt;d7p1:string&gt;System.Data, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d7p1:string&gt;&lt;d7p1:string&gt;System.Data.DataSetExtensions, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d7p1:string&gt;&lt;d7p1:string&gt;System.Runtime.Serialization, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d7p1:string&gt;&lt;d7p1:string&gt;System.ServiceModel, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d7p1:string&gt;&lt;/ReferencedAssemblies&gt;&lt;TypeName&gt;Type9dcd9e9363a4ca1892c29fa3800158&lt;/TypeName&gt;&lt;/ESBMessagePipelineStep&gt;&lt;ESBMessagePipelineStep xmlns:d6p1="http://schemas.neuronesb.com/pipelines/esb/" i:type="d6p1:EsbMessageCSharpCodePipelineStep"&gt;&lt;Bindings xmlns:d7p1="http://schemas.datacontract.org/2004/07/Neuron.ComponentModel" /&gt;&lt;BreakPoint&gt;Disable&lt;/BreakPoint&gt;&lt;Disable&gt;false&lt;/Disable&gt;&lt;Id&gt;47e02402-5489-4de5-badc-1546ddd7b0cf&lt;/Id&gt;&lt;Name&gt;Define Global Variables&lt;/Name&gt;&lt;Uniquename /&gt;&lt;BreakPointLines xmlns:d7p1="http://schemas.microsoft.com/2003/10/Serialization/Arrays" /&gt;&lt;Code /&gt;&lt;ReferencedAssemblies xmlns:d7p1="http://schemas.microsoft.com/2003/10/Serialization/Arrays"&gt;&lt;d7p1:string&gt;Neuron&lt;/d7p1:string&gt;&lt;d7p1:string&gt;Neuron.Pipelines&lt;/d7p1:string&gt;&lt;d7p1:string&gt;Neuron.Esb&lt;/d7p1:string&gt;&lt;d7p1:string&gt;System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d7p1:string&gt;&lt;d7p1:string&gt;System.Core, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d7p1:string&gt;&lt;d7p1:string&gt;System.Xml, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d7p1:string&gt;&lt;d7p1:string&gt;System.Xml.Linq, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d7p1:string&gt;&lt;d7p1:string&gt;System.Data, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d7p1:string&gt;&lt;d7p1:string&gt;System.Data.DataSetExtensions, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d7p1:string&gt;&lt;d7p1:string&gt;System.Runtime.Serialization, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d7p1:string&gt;&lt;d7p1:string&gt;System.ServiceModel, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d7p1:string&gt;&lt;d7p1:string&gt;Newtonsoft.Json, Version=8.0.0.0, Culture=neutral, PublicKeyToken=30ad4fe6b2a6aeed&lt;/d7p1:string&gt;&lt;d7p1:string&gt;Microsoft.CSharp, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a&lt;/d7p1:string&gt;&lt;/ReferencedAssemblies&gt;&lt;TypeName&gt;Type41df8f9d526461789c49437549b633&lt;/TypeName&gt;&lt;/ESBMessagePipelineStep&gt;&lt;ESBMessagePipelineStep xmlns:d6p1="http://schemas.neuronesb.com/pipelines/esb/" i:type="d6p1:EsbMessageSchemaValidationPipelineStep"&gt;&lt;Bindings xmlns:d7p1="http://schemas.datacontract.org/2004/07/Neuron.ComponentModel" /&gt;&lt;BreakPoint&gt;Disable&lt;/BreakPoint&gt;&lt;Disable&gt;false&lt;/Disable&gt;&lt;Id&gt;47548f5d-cf16-40e1-9bbd-9a33321245cd&lt;/Id&gt;&lt;Name&gt;SchemaValidation&lt;/Name&gt;&lt;Uniquename /&gt;&lt;OnInvalid&gt;&lt;Bindings xmlns:d8p1="http://schemas.datacontract.org/2004/07/Neuron.ComponentModel" /&gt;&lt;BreakPoint&gt;Disable&lt;/BreakPoint&gt;&lt;Disable&gt;false&lt;/Disable&gt;&lt;Id&gt;8cc1eeb3-5ddc-4bc2-9d6f-f9c46b53e9e8&lt;/Id&gt;&lt;Name&gt;Group&lt;/Name&gt;&lt;Uniquename /&gt;&lt;Children&gt;&lt;ESBMessagePipelineStep i:type="d6p1:EsbMessageCSharpCodePipelineStep"&gt;&lt;Bindings xmlns:d10p1="http://schemas.datacontract.org/2004/07/Neuron.ComponentModel" /&gt;&lt;BreakPoint&gt;Disable&lt;/BreakPoint&gt;&lt;Disable&gt;false&lt;/Disable&gt;&lt;Id&gt;5a540665-edcb-4770-9e4c-45421a7c5ce0&lt;/Id&gt;&lt;Name&gt;Trace the Available Information on the Exception&lt;/Name&gt;&lt;Uniquename /&gt;&lt;BreakPointLines xmlns:d10p1="http://schemas.microsoft.com/2003/10/Serialization/Arrays" /&gt;&lt;Code&gt;//get the current exception
Exception ex = (Exception)context.Properties["CurrentException"];

string msg = "Validation Exception: ";
if(ex.InnerException != null)
{
	msg += ex.InnerException.Message;
}
else
{
	msg += ex.Message;
}

//trace to designer window
context.Instance.TraceError(msg);&lt;/Code&gt;&lt;ReferencedAssemblies xmlns:d10p1="http://schemas.microsoft.com/2003/10/Serialization/Arrays"&gt;&lt;d10p1:string&gt;Neuron&lt;/d10p1:string&gt;&lt;d10p1:string&gt;Neuron.Pipelines&lt;/d10p1:string&gt;&lt;d10p1:string&gt;Neuron.Esb&lt;/d10p1:string&gt;&lt;d10p1:string&gt;System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d10p1:string&gt;&lt;d10p1:string&gt;System.Core, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d10p1:string&gt;&lt;d10p1:string&gt;System.Xml, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d10p1:string&gt;&lt;d10p1:string&gt;System.Xml.Linq, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d10p1:string&gt;&lt;d10p1:string&gt;System.Data, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d10p1:string&gt;&lt;d10p1:string&gt;System.Data.DataSetExtensions, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d10p1:string&gt;&lt;d10p1:string&gt;System.Runtime.Serialization, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d10p1:string&gt;&lt;d10p1:string&gt;System.ServiceModel, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d10p1:string&gt;&lt;d10p1:string&gt;Newtonsoft.Json, Version=8.0.0.0, Culture=neutral, PublicKeyToken=30ad4fe6b2a6aeed&lt;/d10p1:string&gt;&lt;d10p1:string&gt;Microsoft.CSharp, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a&lt;/d10p1:string&gt;&lt;/ReferencedAssemblies&gt;&lt;TypeName&gt;Type704279b027f4124a01e147e3dd82da&lt;/TypeName&gt;&lt;/ESBMessagePipelineStep&gt;&lt;ESBMessagePipelineStep i:type="d6p1:EsbMessageCSharpCodePipelineStep"&gt;&lt;Bindings xmlns:d10p1="http://schemas.datacontract.org/2004/07/Neuron.ComponentModel" /&gt;&lt;BreakPoint&gt;Disable&lt;/BreakPoint&gt;&lt;Disable&gt;false&lt;/Disable&gt;&lt;Id&gt;85c3615f-2b75-49fc-8f34-0583eea49d44&lt;/Id&gt;&lt;Name&gt;Create Invalid Schema Error&lt;/Name&gt;&lt;Uniquename /&gt;&lt;BreakPointLines xmlns:d10p1="http://schemas.microsoft.com/2003/10/Serialization/Arrays" /&gt;&lt;Code&gt;//get the current exception
Exception ex = (Exception)context.Properties["CurrentException"];

string msg = "Validation Exception: ";
if(ex.InnerException != null)
{
	msg += ex.InnerException.Message;
}
else
{
	msg += ex.Message;
}

//trace to designer window
context.Instance.TraceError(msg);

string errorMessage = System.Net.WebUtility.HtmlEncode (msg);

// Get the data together to send the Business Error Message
string endpointAddress = context.Data.Header.To;
string eSBAction = context.Data.Header.Action;
string eSBTopic = context.Data.Header.Topic;
string sourceSystemID = ""; 
string plantID = "";
string transactionID = context.Properties["OriginalMessageID"].ToString();
string messageDate = context.Data.Header.Created.ToString("yyyy-MM-ddTHH:mm:ssZ");
string errorCode = "1000";
string originalMessage = System.Net.WebUtility.HtmlEncode (context.Properties ["OrigMsg"].ToString());

// Get the business error template
string errorTemplate = context.Configuration.XmlDocs["ESB Invalid Schema Error Message"].Xml;

string eSBErrorMessage = string.Format(errorTemplate, endpointAddress, eSBAction, eSBTopic, sourceSystemID, plantID, transactionID, messageDate, errorCode, errorMessage, originalMessage);

context.Instance.TraceInformation ("System Error: " + eSBErrorMessage);

context.Data.Text = eSBErrorMessage;
&lt;/Code&gt;&lt;ReferencedAssemblies xmlns:d10p1="http://schemas.microsoft.com/2003/10/Serialization/Arrays"&gt;&lt;d10p1:string&gt;Neuron&lt;/d10p1:string&gt;&lt;d10p1:string&gt;Neuron.Pipelines&lt;/d10p1:string&gt;&lt;d10p1:string&gt;Neuron.Esb&lt;/d10p1:string&gt;&lt;d10p1:string&gt;System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d10p1:string&gt;&lt;d10p1:string&gt;System.Core, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d10p1:string&gt;&lt;d10p1:string&gt;System.Xml, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d10p1:string&gt;&lt;d10p1:string&gt;System.Xml.Linq, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d10p1:string&gt;&lt;d10p1:string&gt;System.Data, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d10p1:string&gt;&lt;d10p1:string&gt;System.Data.DataSetExtensions, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d10p1:string&gt;&lt;d10p1:string&gt;System.Runtime.Serialization, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d10p1:string&gt;&lt;d10p1:string&gt;System.ServiceModel, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d10p1:string&gt;&lt;d10p1:string&gt;Newtonsoft.Json, Version=8.0.0.0, Culture=neutral, PublicKeyToken=30ad4fe6b2a6aeed&lt;/d10p1:string&gt;&lt;d10p1:string&gt;Microsoft.CSharp, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a&lt;/d10p1:string&gt;&lt;/ReferencedAssemblies&gt;&lt;TypeName&gt;Type11624a5a2154ce58811e380fbf8048&lt;/TypeName&gt;&lt;/ESBMessagePipelineStep&gt;&lt;ESBMessagePipelineStep i:type="d6p1:EsbMessagePublishPipelineStep"&gt;&lt;Bindings xmlns:d10p1="http://schemas.datacontract.org/2004/07/Neuron.ComponentModel" /&gt;&lt;BreakPoint&gt;Disable&lt;/BreakPoint&gt;&lt;Disable&gt;false&lt;/Disable&gt;&lt;Id&gt;f0ba4496-b0fe-4e5e-90e5-a7a73a43f95b&lt;/Id&gt;&lt;Name&gt;Publish&lt;/Name&gt;&lt;Uniquename /&gt;&lt;d6p1:Semantic&gt;Multicast&lt;/d6p1:Semantic&gt;&lt;d6p1:Timeout&gt;0&lt;/d6p1:Timeout&gt;&lt;d6p1:TopicSelector i:type="d6p1:ESBMessageConstTopicSelector"&gt;&lt;d6p1:Topic&gt;ESBError&lt;/d6p1:Topic&gt;&lt;/d6p1:TopicSelector&gt;&lt;/ESBMessagePipelineStep&gt;&lt;ESBMessagePipelineStep i:type="CancelPipelineStepOfESBMessagexAPWb1W4"&gt;&lt;Bindings xmlns:d10p1="http://schemas.datacontract.org/2004/07/Neuron.ComponentModel" /&gt;&lt;BreakPoint&gt;Disable&lt;/BreakPoint&gt;&lt;Disable&gt;false&lt;/Disable&gt;&lt;Id&gt;4f0dae8c-3fa9-4adc-8971-91b9c46ff17d&lt;/Id&gt;&lt;Name&gt;Cancel&lt;/Name&gt;&lt;Uniquename /&gt;&lt;/ESBMessagePipelineStep&gt;&lt;/Children&gt;&lt;/OnInvalid&gt;&lt;OnValid&gt;&lt;Bindings xmlns:d8p1="http://schemas.datacontract.org/2004/07/Neuron.ComponentModel" /&gt;&lt;BreakPoint&gt;Disable&lt;/BreakPoint&gt;&lt;Disable&gt;false&lt;/Disable&gt;&lt;Id&gt;602e13e4-6502-4e56-9c9d-a0f601011f80&lt;/Id&gt;&lt;Name&gt;Group&lt;/Name&gt;&lt;Uniquename /&gt;&lt;Children&gt;&lt;ESBMessagePipelineStep i:type="d6p1:EsbMessageCSharpCodePipelineStep"&gt;&lt;Bindings xmlns:d10p1="http://schemas.datacontract.org/2004/07/Neuron.ComponentModel" /&gt;&lt;BreakPoint&gt;Disable&lt;/BreakPoint&gt;&lt;Disable&gt;false&lt;/Disable&gt;&lt;Id&gt;f8ccc59b-4a18-4243-ac07-fb700a4fadc9&lt;/Id&gt;&lt;Name&gt;Init Transaction&lt;/Name&gt;&lt;Uniquename&gt;0b4e561f-1671-4a2f-985a-be75a8f0f140&lt;/Uniquename&gt;&lt;BreakPointLines xmlns:d10p1="http://schemas.microsoft.com/2003/10/Serialization/Arrays" /&gt;&lt;Code&gt;//Save original message in case we need it later
context.Properties.Add("OrigMsg", context.Data.Clone(true));

//Init and load transaction values
context.Properties.Add("ProcessTitle", "LIMS Material Lot Enrichment");
context.Properties.Add ("OriginalMessageID", context.Data.Header.MessageId);

// Add Properties for Message Header
context.Properties.Add("SoapAction", "");
context.Properties.Add("SourceSystemID", "");
context.Properties.Add("TransactionID", "");

// Add all field values 
context.Properties.Add ("PlantID", "");
context.Properties.Add ("MaterialID", "");
context.Properties.Add ("MaterialLotID", "");
context.Properties.Add ("InspectionLotID", "");
context.Properties.Add ("TestTemplateID", "");
context.Properties.Add ("TestTemplateDescription", "");
context.Properties.Add ("TestTemplateType", "");
context.Properties.Add("TestTemplateVersion", "");

// Lookup Results
context.Properties.Add ("FacilityUID", "");
context.Properties.Add ("PlantCodeUID", "");
context.Properties.Add ("MaterialMasterUID", "");
context.Properties.Add ("NeoMaterialType", "");
context.Properties.Add ("MaterialLotUID", "");
context.Properties.Add ("LabHistoryUID", "");
context.Properties.Add ("LabSampleHistoryUID", "");
context.Properties.Add ("LabTestHistoryUID", "");
context.Properties.Add ("LabResultHistoryUID", "");
context.Properties.Add("LocalServiceURI", "");

// Create Properties to manage the loop collections
context.Properties.Add ("NeoPLMLabHistories", "");
context.Properties.Add ("NeoPLMLabSampleHistories", "");
context.Properties.Add ("NeoPLMLabTestHistories", "");
context.Properties.Add ("NeoPLMLabResultHistories", "");

if(context.Data.Header.Action.Length &amp;gt; 0) 
{
	context.Properties["SoapAction"] = context.Data.Header.Action;
}

// Source System ID 
var sourceSystemId = context.Data.ToXmlDocument().SelectSingleNode("/*[local-name()='NeoPlmLimsMaterialLot' and namespace-uri()='http://NeoPLM.LIMS.MaterialLot']/*[local-name()='ErpSourceSystemID' and namespace-uri()='']").InnerText;
context.Properties ["SourceSystemID"] = sourceSystemId;

// Transaction ID
var transactionID = context.Data.ToXmlDocument().SelectSingleNode("/*[local-name()='NeoPlmLimsMaterialLot' and namespace-uri()='http://NeoPLM.LIMS.MaterialLot']/*[local-name()='TransactionID' and namespace-uri()='']").InnerText;
context.Properties ["TransactionID"] = transactionID;

// Load the material lots nodelist for looping through
var materialLots = context.Data.ToXmlDocument().SelectNodes("/*[local-name()='NeoPlmLimsMaterialLot' and namespace-uri()='http://NeoPLM.LIMS.MaterialLot']/*[local-name()='NeoPLMLabHistories' and namespace-uri()='']/*[local-name()='NeoPLMLabHistory' and namespace-uri()='']");
context.Properties ["NeoPLMLabHistories"] = materialLots;

// Begin tracing
context.Instance.TraceInformation("Process Material Lot Transaction ID: " + context.Properties["TransactionID"] + "Material Lots Count: " + materialLots.Count.ToString());


&lt;/Code&gt;&lt;ReferencedAssemblies xmlns:d10p1="http://schemas.microsoft.com/2003/10/Serialization/Arrays"&gt;&lt;d10p1:string&gt;Neuron&lt;/d10p1:string&gt;&lt;d10p1:string&gt;Neuron.Pipelines&lt;/d10p1:string&gt;&lt;d10p1:string&gt;Neuron.Esb&lt;/d10p1:string&gt;&lt;d10p1:string&gt;System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d10p1:string&gt;&lt;d10p1:string&gt;System.Core, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d10p1:string&gt;&lt;d10p1:string&gt;System.Xml, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d10p1:string&gt;&lt;d10p1:string&gt;System.Xml.Linq, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d10p1:string&gt;&lt;d10p1:string&gt;System.Data, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d10p1:string&gt;&lt;d10p1:string&gt;System.Data.DataSetExtensions, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d10p1:string&gt;&lt;d10p1:string&gt;System.Runtime.Serialization, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d10p1:string&gt;&lt;d10p1:string&gt;System.ServiceModel, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d10p1:string&gt;&lt;/ReferencedAssemblies&gt;&lt;TypeName&gt;Type6f01709dad2402bb4b6571118ee560&lt;/TypeName&gt;&lt;/ESBMessagePipelineStep&gt;&lt;ESBMessagePipelineStep i:type="ForEachPipelineStepOfESBMessagexAPWb1W4"&gt;&lt;Bindings xmlns:d10p1="http://schemas.datacontract.org/2004/07/Neuron.ComponentModel" /&gt;&lt;BreakPoint&gt;Disable&lt;/BreakPoint&gt;&lt;Disable&gt;false&lt;/Disable&gt;&lt;Id&gt;77f06085-4192-4198-ac1e-aa5f86e5b604&lt;/Id&gt;&lt;Name&gt;Loop Through Material Lots&lt;/Name&gt;&lt;Uniquename&gt;3495cdf6-f026-4c42-99de-ca5f79f1f9de&lt;/Uniquename&gt;&lt;Children&gt;&lt;ESBMessagePipelineStep i:type="d6p1:EsbMessageCSharpCodePipelineStep"&gt;&lt;Bindings xmlns:d12p1="http://schemas.datacontract.org/2004/07/Neuron.ComponentModel" /&gt;&lt;BreakPoint&gt;Disable&lt;/BreakPoint&gt;&lt;Disable&gt;false&lt;/Disable&gt;&lt;Id&gt;1d4788a8-4db6-4571-aa16-1f5ed066fdad&lt;/Id&gt;&lt;Name&gt;Init Vars&lt;/Name&gt;&lt;Uniquename&gt;9b20866d-009c-401f-97fc-b0686580dc7d&lt;/Uniquename&gt;&lt;BreakPointLines xmlns:d12p1="http://schemas.microsoft.com/2003/10/Serialization/Arrays" /&gt;&lt;Code&gt;// Initialize Loop Properties
context.Properties ["PlantID"] = "";
context.Properties ["MaterialID"] = "";
context.Properties ["MaterialLotID"] = "";
context.Properties ["InspectionLotID"] = "";
context.Properties ["TestTemplateID"] = "";
context.Properties ["TestTemplateDescription"] = "";
context.Properties ["TestTemplateType"] = "";
context.Properties ["TestTemplateVersion"] = "";

context.Properties ["FacilityUID"] = "";
context.Properties ["PlantCodeUID"] = "";
context.Properties ["MaterialMasterUID"] = "";
context.Properties ["NeoMaterialType"] = "";
context.Properties ["MaterialLotUID"] =  "";
context.Properties ["LabHistoryUID"] = "";
context.Properties ["LabSampleHistoryUID"] = "";
context.Properties ["LabTestHistoryUID"] = "";
context.Properties ["LabResultHistoryUID"] = "";
context.Properties ["LocalServiceURI"] = "";

context.Properties ["NeoPLMLabHistories"] = "";

//Load the Lab History
var labHistory = (System.Xml.XmlNode)context.Properties["NeoPLMLabHistory"];

//Plant
foreach(System.Xml.XmlNode node in labHistory.ChildNodes) { if(node.Name == "PlantID") { context.Properties["PlantID"] = node.InnerText; break; } }

// MaterialID
foreach(System.Xml.XmlNode node in labHistory.ChildNodes) {	if(node.Name == "MaterialID") {	context.Properties["MaterialID"] = node.InnerText; break;}}

//Material Lot ID
foreach(System.Xml.XmlNode node in labHistory.ChildNodes) { if(node.Name == "MaterialLotID") { context.Properties["MaterialLotID"] = node.InnerText; break; } }

//InspectionLot ID
foreach(System.Xml.XmlNode node in labHistory.ChildNodes) { if(node.Name == "InspectionLotID") { context.Properties["InspectionLotID"] = node.InnerText; break; } }

//TestTemplateID
foreach(System.Xml.XmlNode node in labHistory.ChildNodes) { if(node.Name == "TestTemplateID") { context.Properties["TestTemplateID"] = node.InnerText; break; } }

//TestTemplateDescription
foreach(System.Xml.XmlNode node in labHistory.ChildNodes) { if(node.Name == "TestTemplateDescription") { context.Properties["TestTemplateDescription"] = node.InnerText; break; } }

//TestTemplateType
foreach(System.Xml.XmlNode node in labHistory.ChildNodes) { if(node.Name == "TestTemplateType") { context.Properties["TestTemplateType"] = node.InnerText; break; } }

//TestTemplateVersion
foreach(System.Xml.XmlNode node in labHistory.ChildNodes) { if(node.Name == "TestTemplateVersion") { context.Properties["TestTemplateVersion"] = node.InnerText; break; } }

//Load the lab histories nodelist for looping through
var labHistories = context.Data.ToXmlDocument().SelectNodes("/*[local-name()='NeoPlmLimsMaterialLot' and namespace-uri()='http://NeoPLM.LIMS.MaterialLot']/*[local-name()='NeoPLMLabHistories' and namespace-uri()='']/*[local-name()='NeoPLMLabHistory' and namespace-uri()='']");
context.Properties ["NeoPLMLabHistories"] = labHistories;
&lt;/Code&gt;&lt;ReferencedAssemblies xmlns:d12p1="http://schemas.microsoft.com/2003/10/Serialization/Arrays"&gt;&lt;d12p1:string&gt;Neuron&lt;/d12p1:string&gt;&lt;d12p1:string&gt;Neuron.Pipelines&lt;/d12p1:string&gt;&lt;d12p1:string&gt;Neuron.Esb&lt;/d12p1:string&gt;&lt;d12p1:string&gt;System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d12p1:string&gt;&lt;d12p1:string&gt;System.Core, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d12p1:string&gt;&lt;d12p1:string&gt;System.Xml, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d12p1:string&gt;&lt;d12p1:string&gt;System.Xml.Linq, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d12p1:string&gt;&lt;d12p1:string&gt;System.Data, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d12p1:string&gt;&lt;d12p1:string&gt;System.Data.DataSetExtensions, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d12p1:string&gt;&lt;d12p1:string&gt;System.Runtime.Serialization, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d12p1:string&gt;&lt;d12p1:string&gt;System.ServiceModel, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d12p1:string&gt;&lt;/ReferencedAssemblies&gt;&lt;TypeName&gt;Type71a31839f0e4065a27b5fedb808af3&lt;/TypeName&gt;&lt;/ESBMessagePipelineStep&gt;&lt;ESBMessagePipelineStep i:type="d6p1:EsbMessageCSharpCodePipelineStep"&gt;&lt;Bindings xmlns:d12p1="http://schemas.datacontract.org/2004/07/Neuron.ComponentModel" /&gt;&lt;BreakPoint&gt;Disable&lt;/BreakPoint&gt;&lt;Disable&gt;false&lt;/Disable&gt;&lt;Id&gt;8618d8d9-e63d-4058-9667-2d4018e63469&lt;/Id&gt;&lt;Name&gt;Document Transaction&lt;/Name&gt;&lt;Uniquename /&gt;&lt;BreakPointLines xmlns:d12p1="http://schemas.microsoft.com/2003/10/Serialization/Arrays" /&gt;&lt;Code&gt;context.Instance.TraceInformation ("Process LIMS Transaction - Transaction ID: " + context.Properties["TransactionID"] +  " Plant ID: " + context.Properties["PlantID"]);
context.Instance.TraceInformation ("Process LIMS Transaction - Transaction ID: " + context.Properties["TransactionID"] +  " Material ID: " + context.Properties["MaterialID"]);
context.Instance.TraceInformation ("Process LIMS Transaction - Transaction ID: " + context.Properties["TransactionID"] +  " Material Lot ID: " + context.Properties["MaterialLotID"]);
context.Instance.TraceInformation ("Process LIMS Transaction - Transaction ID: " + context.Properties["TransactionID"] +  " Inspection Lot ID: " + context.Properties["InspectionLotID"]);
context.Instance.TraceInformation ("Process LIMS Transaction - Transaction ID: " + context.Properties["TransactionID"] +  " Test Template ID: " + context.Properties["TestTemplateID"]);
context.Instance.TraceInformation ("Process LIMS Transaction - Transaction ID: " + context.Properties["TransactionID"] +  " TestTemplateDescription: " + context.Properties["TestTemplateDescription"]);
context.Instance.TraceInformation ("Process LIMS Transaction - Transaction ID: " + context.Properties["TransactionID"] +  " TestTemplateType: " + context.Properties["TestTemplateType"]);
context.Instance.TraceInformation ("Process LIMS Transaction Lot - Transaction ID: " + context.Properties["TransactionID"] +  " TestTemplateVersion: " + context.Properties["TestTemplateVersion"]);

&lt;/Code&gt;&lt;ReferencedAssemblies xmlns:d12p1="http://schemas.microsoft.com/2003/10/Serialization/Arrays"&gt;&lt;d12p1:string&gt;Neuron&lt;/d12p1:string&gt;&lt;d12p1:string&gt;Neuron.Pipelines&lt;/d12p1:string&gt;&lt;d12p1:string&gt;Neuron.Esb&lt;/d12p1:string&gt;&lt;d12p1:string&gt;System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d12p1:string&gt;&lt;d12p1:string&gt;System.Core, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d12p1:string&gt;&lt;d12p1:string&gt;System.Xml, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d12p1:string&gt;&lt;d12p1:string&gt;System.Xml.Linq, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d12p1:string&gt;&lt;d12p1:string&gt;System.Data, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d12p1:string&gt;&lt;d12p1:string&gt;System.Data.DataSetExtensions, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d12p1:string&gt;&lt;d12p1:string&gt;System.Runtime.Serialization, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d12p1:string&gt;&lt;d12p1:string&gt;System.ServiceModel, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d12p1:string&gt;&lt;d12p1:string&gt;Newtonsoft.Json, Version=8.0.0.0, Culture=neutral, PublicKeyToken=30ad4fe6b2a6aeed&lt;/d12p1:string&gt;&lt;d12p1:string&gt;Microsoft.CSharp, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a&lt;/d12p1:string&gt;&lt;/ReferencedAssemblies&gt;&lt;TypeName&gt;Type1ba610c95c14bbdb1e12dc86f8d723&lt;/TypeName&gt;&lt;/ESBMessagePipelineStep&gt;&lt;ESBMessagePipelineStep i:type="d6p1:EsbMessageCSharpCodePipelineStep"&gt;&lt;Bindings xmlns:d12p1="http://schemas.datacontract.org/2004/07/Neuron.ComponentModel" /&gt;&lt;BreakPoint&gt;Disable&lt;/BreakPoint&gt;&lt;Disable&gt;false&lt;/Disable&gt;&lt;Id&gt;2c0a92a3-53cc-4a9e-af63-a0a735a12bf2&lt;/Id&gt;&lt;Name&gt;Map To Get Facility Input&lt;/Name&gt;&lt;Uniquename /&gt;&lt;BreakPointLines xmlns:d12p1="http://schemas.microsoft.com/2003/10/Serialization/Arrays" /&gt;&lt;Code&gt;// Retrieve the response template message
string facilityRequestTemplate = context.Configuration.XmlDocs["FacilityRequest"].Xml;
	
System.Xml.XmlNode node = (System.Xml.XmlNode) context.Properties["NeoPLMLabHistory"];

string message = System.Net.WebUtility.HtmlEncode (node.OuterXml.ToString());

// Create the response message
string facilityRequest = string.Format(facilityRequestTemplate, context.Properties["TransactionID"], context.Properties["SourceSystemID"], context.Properties["PlantID"], "false", message);

//Send the trace message to document the response message.
context.Instance.TraceInformation ("Process LIMS Transaction - Message ID: " + context.Data.Header.MessageId.ToString() + " Request Message: " + facilityRequest);
	
// Set message context to the response message 	
context.Data.Text = facilityRequest;
&lt;/Code&gt;&lt;ReferencedAssemblies xmlns:d12p1="http://schemas.microsoft.com/2003/10/Serialization/Arrays"&gt;&lt;d12p1:string&gt;Neuron&lt;/d12p1:string&gt;&lt;d12p1:string&gt;Neuron.Pipelines&lt;/d12p1:string&gt;&lt;d12p1:string&gt;Neuron.Esb&lt;/d12p1:string&gt;&lt;d12p1:string&gt;System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d12p1:string&gt;&lt;d12p1:string&gt;System.Core, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d12p1:string&gt;&lt;d12p1:string&gt;System.Xml, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d12p1:string&gt;&lt;d12p1:string&gt;System.Xml.Linq, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d12p1:string&gt;&lt;d12p1:string&gt;System.Data, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d12p1:string&gt;&lt;d12p1:string&gt;System.Data.DataSetExtensions, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d12p1:string&gt;&lt;d12p1:string&gt;System.Runtime.Serialization, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d12p1:string&gt;&lt;d12p1:string&gt;System.ServiceModel, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d12p1:string&gt;&lt;d12p1:string&gt;Newtonsoft.Json, Version=8.0.0.0, Culture=neutral, PublicKeyToken=30ad4fe6b2a6aeed&lt;/d12p1:string&gt;&lt;d12p1:string&gt;Microsoft.CSharp, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a&lt;/d12p1:string&gt;&lt;/ReferencedAssemblies&gt;&lt;TypeName&gt;Type79d7eb1c9874c578f2636fbc4d8e9e&lt;/TypeName&gt;&lt;/ESBMessagePipelineStep&gt;&lt;ESBMessagePipelineStep i:type="d6p1:EsbMessagePipelineExecutionPipelineStep"&gt;&lt;Bindings xmlns:d12p1="http://schemas.datacontract.org/2004/07/Neuron.ComponentModel" /&gt;&lt;BreakPoint&gt;Disable&lt;/BreakPoint&gt;&lt;Disable&gt;false&lt;/Disable&gt;&lt;Id&gt;0aa71a39-9efd-4a8a-8d1d-c20a47e3665f&lt;/Id&gt;&lt;Name&gt;Get Facility UID&lt;/Name&gt;&lt;Uniquename&gt;1aa2c9d3-f076-4781-bd9a-4b117b302b1f&lt;/Uniquename&gt;&lt;d6p1:FileName i:nil="true" /&gt;&lt;d6p1:MaxInstances&gt;100&lt;/d6p1:MaxInstances&gt;&lt;d6p1:PipelineName&gt;Process_GetFacilityUID - New&lt;/d6p1:PipelineName&gt;&lt;d6p1:PoolTimeout&gt;PT1M&lt;/d6p1:PoolTimeout&gt;&lt;/ESBMessagePipelineStep&gt;&lt;ESBMessagePipelineStep i:type="d6p1:EsbMessageCSharpCodePipelineStep"&gt;&lt;Bindings xmlns:d12p1="http://schemas.datacontract.org/2004/07/Neuron.ComponentModel" /&gt;&lt;BreakPoint&gt;Disable&lt;/BreakPoint&gt;&lt;Disable&gt;false&lt;/Disable&gt;&lt;Id&gt;7ab5e550-3075-4d41-9f09-cbc463a577b2&lt;/Id&gt;&lt;Name&gt;Map From Get Facility Output&lt;/Name&gt;&lt;Uniquename /&gt;&lt;BreakPointLines xmlns:d12p1="http://schemas.microsoft.com/2003/10/Serialization/Arrays" /&gt;&lt;Code&gt;string facilityUID = context.Data.ToXmlDocument().SelectSingleNode("/*[local-name()='FacilityResponse' and namespace-uri()='http://NeoPLM.com/EnterpriseIntegration']/*[local-name()='FacilityUID' and namespace-uri()='http://NeoPLM.com/EnterpriseIntegration']").InnerText;

context.Properties ["FacilityUID"] = facilityUID;

context.Instance.TraceInformation ("Process LIMS Transaction - Transaction ID: " + context.Properties["TransactionID"] + " FacilityUID: " + context.Properties["FacilityUID"]);&lt;/Code&gt;&lt;ReferencedAssemblies xmlns:d12p1="http://schemas.microsoft.com/2003/10/Serialization/Arrays"&gt;&lt;d12p1:string&gt;Neuron&lt;/d12p1:string&gt;&lt;d12p1:string&gt;Neuron.Pipelines&lt;/d12p1:string&gt;&lt;d12p1:string&gt;Neuron.Esb&lt;/d12p1:string&gt;&lt;d12p1:string&gt;System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d12p1:string&gt;&lt;d12p1:string&gt;System.Core, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d12p1:string&gt;&lt;d12p1:string&gt;System.Xml, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d12p1:string&gt;&lt;d12p1:string&gt;System.Xml.Linq, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d12p1:string&gt;&lt;d12p1:string&gt;System.Data, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d12p1:string&gt;&lt;d12p1:string&gt;System.Data.DataSetExtensions, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d12p1:string&gt;&lt;d12p1:string&gt;System.Runtime.Serialization, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d12p1:string&gt;&lt;d12p1:string&gt;System.ServiceModel, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d12p1:string&gt;&lt;d12p1:string&gt;Newtonsoft.Json, Version=8.0.0.0, Culture=neutral, PublicKeyToken=30ad4fe6b2a6aeed&lt;/d12p1:string&gt;&lt;d12p1:string&gt;Microsoft.CSharp, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a&lt;/d12p1:string&gt;&lt;/ReferencedAssemblies&gt;&lt;TypeName&gt;Type60a4ef5a2374b5f8cef8adf909b712&lt;/TypeName&gt;&lt;/ESBMessagePipelineStep&gt;&lt;ESBMessagePipelineStep i:type="DecisionPipelineStepOfESBMessagexAPWb1W4"&gt;&lt;Bindings xmlns:d12p1="http://schemas.datacontract.org/2004/07/Neuron.ComponentModel" /&gt;&lt;BreakPoint&gt;Disable&lt;/BreakPoint&gt;&lt;Disable&gt;false&lt;/Disable&gt;&lt;Id&gt;937dd2ce-3983-4f23-8d38-af79bf5c3bb2&lt;/Id&gt;&lt;Name&gt;Facility?&lt;/Name&gt;&lt;Uniquename&gt;a886fc2b-784f-4295-be30-2e4ad22b5620&lt;/Uniquename&gt;&lt;Branches&gt;&lt;BranchOfESBMessagexAPWb1W4&gt;&lt;BreakPoint&gt;Disable&lt;/BreakPoint&gt;&lt;Condition i:type="CodeBranchConditionOfESBMessagexAPWb1W4"&gt;&lt;Code&gt;if (context.Data.GetProperty("NeoPLM", "LookupError").ToUpper() == "FALSE")
{
	return true;
}
else
{
	return false;
}	&lt;/Code&gt;&lt;ReferencedAssemblies xmlns:d15p1="http://schemas.microsoft.com/2003/10/Serialization/Arrays"&gt;&lt;d15p1:string&gt;Neuron&lt;/d15p1:string&gt;&lt;d15p1:string&gt;Neuron.Pipelines&lt;/d15p1:string&gt;&lt;d15p1:string&gt;Neuron.Esb&lt;/d15p1:string&gt;&lt;d15p1:string&gt;System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d15p1:string&gt;&lt;d15p1:string&gt;System.Core, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d15p1:string&gt;&lt;d15p1:string&gt;System.Xml, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d15p1:string&gt;&lt;d15p1:string&gt;System.Xml.Linq, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d15p1:string&gt;&lt;d15p1:string&gt;System.Data, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d15p1:string&gt;&lt;d15p1:string&gt;System.Runtime.Serialization, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d15p1:string&gt;&lt;d15p1:string&gt;System.ServiceModel, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d15p1:string&gt;&lt;/ReferencedAssemblies&gt;&lt;/Condition&gt;&lt;Disable&gt;false&lt;/Disable&gt;&lt;EndJoined&gt;false&lt;/EndJoined&gt;&lt;Name&gt;If&lt;/Name&gt;&lt;Steps&gt;&lt;Bindings xmlns:d15p1="http://schemas.datacontract.org/2004/07/Neuron.ComponentModel" /&gt;&lt;BreakPoint&gt;Disable&lt;/BreakPoint&gt;&lt;Disable&gt;false&lt;/Disable&gt;&lt;Id&gt;6429aa3d-48ae-4fd2-b452-a714ebeba9ef&lt;/Id&gt;&lt;Name&gt;Group&lt;/Name&gt;&lt;Uniquename /&gt;&lt;Children&gt;&lt;ESBMessagePipelineStep i:type="d6p1:EsbMessageCSharpCodePipelineStep"&gt;&lt;Bindings xmlns:d17p1="http://schemas.datacontract.org/2004/07/Neuron.ComponentModel" /&gt;&lt;BreakPoint&gt;Disable&lt;/BreakPoint&gt;&lt;Disable&gt;false&lt;/Disable&gt;&lt;Id&gt;acc75ef7-60a7-436d-9b72-f4da524c90fc&lt;/Id&gt;&lt;Name&gt;Map To Get Plant Code Input&lt;/Name&gt;&lt;Uniquename /&gt;&lt;BreakPointLines xmlns:d17p1="http://schemas.microsoft.com/2003/10/Serialization/Arrays" /&gt;&lt;Code&gt;// Retrieve the response template message
string plantCodeRequestTemplate = context.Configuration.XmlDocs["PlantCodeRequest"].Xml;
	
System.Xml.XmlNode node = (System.Xml.XmlNode) context.Properties["NeoPLMLabHistory"];

string message = System.Net.WebUtility.HtmlEncode (node.OuterXml.ToString());

// Create the response message
string plantCodeRequest = string.Format(plantCodeRequestTemplate, context.Properties["TransactionID"], context.Properties["FacilityUID"], context.Properties["PlantID"], "false", message);

//Send the trace message to document the response message.
context.Instance.TraceInformation ("Process Lab Transaction - Message ID: " + context.Data.Header.MessageId.ToString() + " Request Message: " + plantCodeRequest);
	
// Set message context to the response message 	
context.Data.Text = plantCodeRequest;&lt;/Code&gt;&lt;ReferencedAssemblies xmlns:d17p1="http://schemas.microsoft.com/2003/10/Serialization/Arrays"&gt;&lt;d17p1:string&gt;Neuron&lt;/d17p1:string&gt;&lt;d17p1:string&gt;Neuron.Pipelines&lt;/d17p1:string&gt;&lt;d17p1:string&gt;Neuron.Esb&lt;/d17p1:string&gt;&lt;d17p1:string&gt;System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d17p1:string&gt;&lt;d17p1:string&gt;System.Core, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d17p1:string&gt;&lt;d17p1:string&gt;System.Xml, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d17p1:string&gt;&lt;d17p1:string&gt;System.Xml.Linq, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d17p1:string&gt;&lt;d17p1:string&gt;System.Data, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d17p1:string&gt;&lt;d17p1:string&gt;System.Data.DataSetExtensions, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d17p1:string&gt;&lt;d17p1:string&gt;System.Runtime.Serialization, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d17p1:string&gt;&lt;d17p1:string&gt;System.ServiceModel, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d17p1:string&gt;&lt;d17p1:string&gt;Newtonsoft.Json, Version=8.0.0.0, Culture=neutral, PublicKeyToken=30ad4fe6b2a6aeed&lt;/d17p1:string&gt;&lt;d17p1:string&gt;Microsoft.CSharp, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a&lt;/d17p1:string&gt;&lt;/ReferencedAssemblies&gt;&lt;TypeName&gt;Type79d7eb1c9874c578f2636fbc4d8e9e&lt;/TypeName&gt;&lt;/ESBMessagePipelineStep&gt;&lt;ESBMessagePipelineStep i:type="d6p1:EsbMessagePipelineExecutionPipelineStep"&gt;&lt;Bindings xmlns:d17p1="http://schemas.datacontract.org/2004/07/Neuron.ComponentModel" /&gt;&lt;BreakPoint&gt;Disable&lt;/BreakPoint&gt;&lt;Disable&gt;false&lt;/Disable&gt;&lt;Id&gt;22fb4516-065c-4739-8f5f-0203030ead8b&lt;/Id&gt;&lt;Name&gt;Get Plant Code UID&lt;/Name&gt;&lt;Uniquename /&gt;&lt;d6p1:FileName i:nil="true" /&gt;&lt;d6p1:MaxInstances&gt;100&lt;/d6p1:MaxInstances&gt;&lt;d6p1:PipelineName&gt;Process_GetPlantCodeUID - New&lt;/d6p1:PipelineName&gt;&lt;d6p1:PoolTimeout&gt;PT1M&lt;/d6p1:PoolTimeout&gt;&lt;/ESBMessagePipelineStep&gt;&lt;ESBMessagePipelineStep i:type="d6p1:EsbMessageCSharpCodePipelineStep"&gt;&lt;Bindings xmlns:d17p1="http://schemas.datacontract.org/2004/07/Neuron.ComponentModel" /&gt;&lt;BreakPoint&gt;Disable&lt;/BreakPoint&gt;&lt;Disable&gt;false&lt;/Disable&gt;&lt;Id&gt;7b0e22e8-080d-4f49-af5b-2cb3320dd4ef&lt;/Id&gt;&lt;Name&gt;Map From Get Plant Code Output&lt;/Name&gt;&lt;Uniquename /&gt;&lt;BreakPointLines xmlns:d17p1="http://schemas.microsoft.com/2003/10/Serialization/Arrays" /&gt;&lt;Code&gt;string plantCodeUID = context.Data.ToXmlDocument().SelectSingleNode("/*[local-name()='PlantCodeResponse' and namespace-uri()='http://NeoPLM.com/EnterpriseIntegration']/*[local-name()='NeoPLMPlantCodeUID' and namespace-uri()='http://NeoPLM.com/EnterpriseIntegration']").InnerText;

context.Properties ["PlantCodeUID"] = plantCodeUID;

context.Instance.TraceInformation ("Process Lab Transactions - Transaction ID: " + context.Properties["TransactionID"] + " PlantCodeUID: " + context.Properties["PlantCodeUID"]);&lt;/Code&gt;&lt;ReferencedAssemblies xmlns:d17p1="http://schemas.microsoft.com/2003/10/Serialization/Arrays"&gt;&lt;d17p1:string&gt;Neuron&lt;/d17p1:string&gt;&lt;d17p1:string&gt;Neuron.Pipelines&lt;/d17p1:string&gt;&lt;d17p1:string&gt;Neuron.Esb&lt;/d17p1:string&gt;&lt;d17p1:string&gt;System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d17p1:string&gt;&lt;d17p1:string&gt;System.Core, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d17p1:string&gt;&lt;d17p1:string&gt;System.Xml, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d17p1:string&gt;&lt;d17p1:string&gt;System.Xml.Linq, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d17p1:string&gt;&lt;d17p1:string&gt;System.Data, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d17p1:string&gt;&lt;d17p1:string&gt;System.Data.DataSetExtensions, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d17p1:string&gt;&lt;d17p1:string&gt;System.Runtime.Serialization, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d17p1:string&gt;&lt;d17p1:string&gt;System.ServiceModel, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d17p1:string&gt;&lt;d17p1:string&gt;Newtonsoft.Json, Version=8.0.0.0, Culture=neutral, PublicKeyToken=30ad4fe6b2a6aeed&lt;/d17p1:string&gt;&lt;d17p1:string&gt;Microsoft.CSharp, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a&lt;/d17p1:string&gt;&lt;/ReferencedAssemblies&gt;&lt;TypeName&gt;Type60a4ef5a2374b5f8cef8adf909b712&lt;/TypeName&gt;&lt;/ESBMessagePipelineStep&gt;&lt;ESBMessagePipelineStep i:type="DecisionPipelineStepOfESBMessagexAPWb1W4"&gt;&lt;Bindings xmlns:d17p1="http://schemas.datacontract.org/2004/07/Neuron.ComponentModel" /&gt;&lt;BreakPoint&gt;Disable&lt;/BreakPoint&gt;&lt;Disable&gt;false&lt;/Disable&gt;&lt;Id&gt;3481bfa7-7bd2-44b7-9104-e4fb20252400&lt;/Id&gt;&lt;Name&gt;Plant Code?&lt;/Name&gt;&lt;Uniquename&gt;f3eb3047-222e-4e33-b980-c2b22d4a2499&lt;/Uniquename&gt;&lt;Branches&gt;&lt;BranchOfESBMessagexAPWb1W4&gt;&lt;BreakPoint&gt;Disable&lt;/BreakPoint&gt;&lt;Condition i:type="CodeBranchConditionOfESBMessagexAPWb1W4"&gt;&lt;Code&gt;if (context.Data.GetProperty("NeoPLM", "LookupError").ToUpper() == "FALSE")
{
	return true;
}
else
{
	return false;
}	&lt;/Code&gt;&lt;ReferencedAssemblies xmlns:d20p1="http://schemas.microsoft.com/2003/10/Serialization/Arrays"&gt;&lt;d20p1:string&gt;Neuron&lt;/d20p1:string&gt;&lt;d20p1:string&gt;Neuron.Pipelines&lt;/d20p1:string&gt;&lt;d20p1:string&gt;Neuron.Esb&lt;/d20p1:string&gt;&lt;d20p1:string&gt;System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d20p1:string&gt;&lt;d20p1:string&gt;System.Core, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d20p1:string&gt;&lt;d20p1:string&gt;System.Xml, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d20p1:string&gt;&lt;d20p1:string&gt;System.Xml.Linq, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d20p1:string&gt;&lt;d20p1:string&gt;System.Data, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d20p1:string&gt;&lt;d20p1:string&gt;System.Runtime.Serialization, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d20p1:string&gt;&lt;d20p1:string&gt;System.ServiceModel, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d20p1:string&gt;&lt;/ReferencedAssemblies&gt;&lt;/Condition&gt;&lt;Disable&gt;false&lt;/Disable&gt;&lt;EndJoined&gt;false&lt;/EndJoined&gt;&lt;Name&gt;If&lt;/Name&gt;&lt;Steps&gt;&lt;Bindings xmlns:d20p1="http://schemas.datacontract.org/2004/07/Neuron.ComponentModel" /&gt;&lt;BreakPoint&gt;Disable&lt;/BreakPoint&gt;&lt;Disable&gt;false&lt;/Disable&gt;&lt;Id&gt;b74dc646-7c01-4a19-af0e-f8f97df97e57&lt;/Id&gt;&lt;Name&gt;Group&lt;/Name&gt;&lt;Uniquename /&gt;&lt;Children&gt;&lt;ESBMessagePipelineStep i:type="d6p1:EsbMessageCSharpCodePipelineStep"&gt;&lt;Bindings xmlns:d22p1="http://schemas.datacontract.org/2004/07/Neuron.ComponentModel" /&gt;&lt;BreakPoint&gt;Disable&lt;/BreakPoint&gt;&lt;Disable&gt;false&lt;/Disable&gt;&lt;Id&gt;add7c401-b6b5-4cc1-a4a9-26a3992d727e&lt;/Id&gt;&lt;Name&gt;Map To Material Master Lookup&lt;/Name&gt;&lt;Uniquename /&gt;&lt;BreakPointLines xmlns:d22p1="http://schemas.microsoft.com/2003/10/Serialization/Arrays" /&gt;&lt;Code&gt;// Retrieve the response template message
string materialItemRequestTemplate = context.Configuration.XmlDocs["MaterialItemRequest"].Xml;
	
System.Xml.XmlNode node = (System.Xml.XmlNode) context.Properties["NeoPLMLabHistory"];

string message = System.Net.WebUtility.HtmlEncode (node.OuterXml.ToString());

// Create the request message
string materialItemRequest = string.Format(materialItemRequestTemplate, context.Properties["TransactionID"], context.Properties["SourceSystemID"], context.Properties["PlantID"], context.Properties["MaterialID"], "false", message);

//Send the trace message to document the request message.
context.Instance.TraceInformation ("Process LIMS Transaction - Message ID: " + context.Data.Header.MessageId.ToString() + " Request Message: " + materialItemRequest);
	
// Set message context to the request message 	
context.Data.Text = materialItemRequest;&lt;/Code&gt;&lt;ReferencedAssemblies xmlns:d22p1="http://schemas.microsoft.com/2003/10/Serialization/Arrays"&gt;&lt;d22p1:string&gt;Neuron&lt;/d22p1:string&gt;&lt;d22p1:string&gt;Neuron.Pipelines&lt;/d22p1:string&gt;&lt;d22p1:string&gt;Neuron.Esb&lt;/d22p1:string&gt;&lt;d22p1:string&gt;System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d22p1:string&gt;&lt;d22p1:string&gt;System.Core, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d22p1:string&gt;&lt;d22p1:string&gt;System.Xml, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d22p1:string&gt;&lt;d22p1:string&gt;System.Xml.Linq, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d22p1:string&gt;&lt;d22p1:string&gt;System.Data, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d22p1:string&gt;&lt;d22p1:string&gt;System.Data.DataSetExtensions, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d22p1:string&gt;&lt;d22p1:string&gt;System.Runtime.Serialization, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d22p1:string&gt;&lt;d22p1:string&gt;System.ServiceModel, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d22p1:string&gt;&lt;d22p1:string&gt;Newtonsoft.Json, Version=8.0.0.0, Culture=neutral, PublicKeyToken=30ad4fe6b2a6aeed&lt;/d22p1:string&gt;&lt;d22p1:string&gt;Microsoft.CSharp, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a&lt;/d22p1:string&gt;&lt;/ReferencedAssemblies&gt;&lt;TypeName&gt;Type0a68a61720e421b88e6aa66a38d207&lt;/TypeName&gt;&lt;/ESBMessagePipelineStep&gt;&lt;ESBMessagePipelineStep i:type="d6p1:EsbMessagePipelineExecutionPipelineStep"&gt;&lt;Bindings xmlns:d22p1="http://schemas.datacontract.org/2004/07/Neuron.ComponentModel" /&gt;&lt;BreakPoint&gt;Disable&lt;/BreakPoint&gt;&lt;Disable&gt;false&lt;/Disable&gt;&lt;Id&gt;5330ad62-cc75-4680-b622-350373fdb472&lt;/Id&gt;&lt;Name&gt;Get Material Master UID&lt;/Name&gt;&lt;Uniquename&gt;942733cd-564f-4dff-b112-8719f0352a70&lt;/Uniquename&gt;&lt;d6p1:FileName i:nil="true" /&gt;&lt;d6p1:MaxInstances&gt;100&lt;/d6p1:MaxInstances&gt;&lt;d6p1:PipelineName&gt;Process_GetMaterialMasterUID_Or_ConsumableUID - New&lt;/d6p1:PipelineName&gt;&lt;d6p1:PoolTimeout&gt;PT1M&lt;/d6p1:PoolTimeout&gt;&lt;/ESBMessagePipelineStep&gt;&lt;ESBMessagePipelineStep i:type="d6p1:EsbMessageCSharpCodePipelineStep"&gt;&lt;Bindings xmlns:d22p1="http://schemas.datacontract.org/2004/07/Neuron.ComponentModel" /&gt;&lt;BreakPoint&gt;Disable&lt;/BreakPoint&gt;&lt;Disable&gt;false&lt;/Disable&gt;&lt;Id&gt;16019a93-8471-4351-900e-30618fb50ec8&lt;/Id&gt;&lt;Name&gt;Map From Material Master Lookup&lt;/Name&gt;&lt;Uniquename /&gt;&lt;BreakPointLines xmlns:d22p1="http://schemas.microsoft.com/2003/10/Serialization/Arrays" /&gt;&lt;Code&gt;string materialMasterUID = context.Data.ToXmlDocument().SelectSingleNode("/*[local-name()='MaterialMasterResponse' and namespace-uri()='http://NeoPLM.com/EnterpriseIntegration']/*[local-name()='NeoPLMMaterialMasterUID' and namespace-uri()='http://NeoPLM.com/EnterpriseIntegration']").InnerText;

context.Properties ["MaterialMasterUID"] = materialMasterUID;

context.Instance.TraceInformation ("Process LIMS Transaction - Transaction ID: " + context.Properties["TransactionID"] + " MaterialUID: " + context.Properties["MaterialMasterUID"]);

string neoMaterialMasterType = context.Data.ToXmlDocument().SelectSingleNode("/*[local-name()='MaterialMasterResponse' and namespace-uri()='http://NeoPLM.com/EnterpriseIntegration']/*[local-name()='NeoPLMMaterialMasterType' and namespace-uri()='http://NeoPLM.com/EnterpriseIntegration']").InnerText;

context.Properties ["NeoMaterialType"] = neoMaterialMasterType;

context.Instance.TraceInformation ("Process LIMS Transaction - Transaction ID: " + context.Properties["TransactionID"] + " Neo Material Type: " + context.Properties["NeoMaterialType"]);&lt;/Code&gt;&lt;ReferencedAssemblies xmlns:d22p1="http://schemas.microsoft.com/2003/10/Serialization/Arrays"&gt;&lt;d22p1:string&gt;Neuron&lt;/d22p1:string&gt;&lt;d22p1:string&gt;Neuron.Pipelines&lt;/d22p1:string&gt;&lt;d22p1:string&gt;Neuron.Esb&lt;/d22p1:string&gt;&lt;d22p1:string&gt;System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d22p1:string&gt;&lt;d22p1:string&gt;System.Core, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d22p1:string&gt;&lt;d22p1:string&gt;System.Xml, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d22p1:string&gt;&lt;d22p1:string&gt;System.Xml.Linq, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d22p1:string&gt;&lt;d22p1:string&gt;System.Data, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d22p1:string&gt;&lt;d22p1:string&gt;System.Data.DataSetExtensions, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d22p1:string&gt;&lt;d22p1:string&gt;System.Runtime.Serialization, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d22p1:string&gt;&lt;d22p1:string&gt;System.ServiceModel, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d22p1:string&gt;&lt;d22p1:string&gt;Newtonsoft.Json, Version=8.0.0.0, Culture=neutral, PublicKeyToken=30ad4fe6b2a6aeed&lt;/d22p1:string&gt;&lt;d22p1:string&gt;Microsoft.CSharp, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a&lt;/d22p1:string&gt;&lt;/ReferencedAssemblies&gt;&lt;TypeName&gt;Typeda1bf57007c4a17a370b211bc065b2&lt;/TypeName&gt;&lt;/ESBMessagePipelineStep&gt;&lt;ESBMessagePipelineStep i:type="DecisionPipelineStepOfESBMessagexAPWb1W4"&gt;&lt;Bindings xmlns:d22p1="http://schemas.datacontract.org/2004/07/Neuron.ComponentModel" /&gt;&lt;BreakPoint&gt;Disable&lt;/BreakPoint&gt;&lt;Disable&gt;false&lt;/Disable&gt;&lt;Id&gt;23742211-d222-4b51-8bcd-d81d48bfaadc&lt;/Id&gt;&lt;Name&gt;Material Master?&lt;/Name&gt;&lt;Uniquename&gt;70da4c5d-9fa3-4716-88df-b58d32f5c57b&lt;/Uniquename&gt;&lt;Branches&gt;&lt;BranchOfESBMessagexAPWb1W4&gt;&lt;BreakPoint&gt;Disable&lt;/BreakPoint&gt;&lt;Condition i:type="CodeBranchConditionOfESBMessagexAPWb1W4"&gt;&lt;Code&gt;if (context.Data.GetProperty("NeoPLM", "LookupError").ToUpper() == "FALSE")
{
	return true;
}
else
{
	return false;
}	&lt;/Code&gt;&lt;ReferencedAssemblies xmlns:d25p1="http://schemas.microsoft.com/2003/10/Serialization/Arrays"&gt;&lt;d25p1:string&gt;Neuron&lt;/d25p1:string&gt;&lt;d25p1:string&gt;Neuron.Pipelines&lt;/d25p1:string&gt;&lt;d25p1:string&gt;Neuron.Esb&lt;/d25p1:string&gt;&lt;d25p1:string&gt;System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d25p1:string&gt;&lt;d25p1:string&gt;System.Core, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d25p1:string&gt;&lt;d25p1:string&gt;System.Xml, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d25p1:string&gt;&lt;d25p1:string&gt;System.Xml.Linq, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d25p1:string&gt;&lt;d25p1:string&gt;System.Data, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d25p1:string&gt;&lt;d25p1:string&gt;System.Runtime.Serialization, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d25p1:string&gt;&lt;d25p1:string&gt;System.ServiceModel, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d25p1:string&gt;&lt;/ReferencedAssemblies&gt;&lt;/Condition&gt;&lt;Disable&gt;false&lt;/Disable&gt;&lt;EndJoined&gt;false&lt;/EndJoined&gt;&lt;Name&gt;If&lt;/Name&gt;&lt;Steps&gt;&lt;Bindings xmlns:d25p1="http://schemas.datacontract.org/2004/07/Neuron.ComponentModel" /&gt;&lt;BreakPoint&gt;Disable&lt;/BreakPoint&gt;&lt;Disable&gt;false&lt;/Disable&gt;&lt;Id&gt;4275771a-0d82-4d84-a61e-1252dd4868d6&lt;/Id&gt;&lt;Name&gt;Group&lt;/Name&gt;&lt;Uniquename /&gt;&lt;Children&gt;&lt;ESBMessagePipelineStep i:type="d6p1:EsbMessageCSharpCodePipelineStep"&gt;&lt;Bindings xmlns:d27p1="http://schemas.datacontract.org/2004/07/Neuron.ComponentModel" /&gt;&lt;BreakPoint&gt;Disable&lt;/BreakPoint&gt;&lt;Disable&gt;false&lt;/Disable&gt;&lt;Id&gt;de14e455-76ba-40d1-acd9-1105aa0219ef&lt;/Id&gt;&lt;Name&gt;Map To Local Service URI&lt;/Name&gt;&lt;Uniquename /&gt;&lt;BreakPointLines xmlns:d27p1="http://schemas.microsoft.com/2003/10/Serialization/Arrays" /&gt;&lt;Code&gt;// Retrieve the response template message
string localServiceURIRequestTemplate = context.Configuration.XmlDocs["LocalServiceURIRequest"].Xml;
	
System.Xml.XmlNode node = (System.Xml.XmlNode) context.Properties["NeoPLMLabHistory"];

string message = System.Net.WebUtility.HtmlEncode (node.OuterXml.ToString());

// Create the request message
string localServiceURIRequest = string.Format(localServiceURIRequestTemplate, context.Properties["TransactionID"], context.Properties["FacilityUID"], message);

//Send the trace message to document the request message.
context.Instance.TraceInformation ("Process Lab Transaction - Message ID: " + context.Data.Header.MessageId.ToString() + " Request Message: " + localServiceURIRequest);
	
// Set message context to the request message 	
context.Data.Text = localServiceURIRequest;&lt;/Code&gt;&lt;ReferencedAssemblies xmlns:d27p1="http://schemas.microsoft.com/2003/10/Serialization/Arrays"&gt;&lt;d27p1:string&gt;Neuron&lt;/d27p1:string&gt;&lt;d27p1:string&gt;Neuron.Pipelines&lt;/d27p1:string&gt;&lt;d27p1:string&gt;Neuron.Esb&lt;/d27p1:string&gt;&lt;d27p1:string&gt;System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d27p1:string&gt;&lt;d27p1:string&gt;System.Core, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d27p1:string&gt;&lt;d27p1:string&gt;System.Xml, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d27p1:string&gt;&lt;d27p1:string&gt;System.Xml.Linq, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d27p1:string&gt;&lt;d27p1:string&gt;System.Data, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d27p1:string&gt;&lt;d27p1:string&gt;System.Data.DataSetExtensions, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d27p1:string&gt;&lt;d27p1:string&gt;System.Runtime.Serialization, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d27p1:string&gt;&lt;d27p1:string&gt;System.ServiceModel, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d27p1:string&gt;&lt;d27p1:string&gt;Newtonsoft.Json, Version=8.0.0.0, Culture=neutral, PublicKeyToken=30ad4fe6b2a6aeed&lt;/d27p1:string&gt;&lt;d27p1:string&gt;Microsoft.CSharp, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a&lt;/d27p1:string&gt;&lt;/ReferencedAssemblies&gt;&lt;TypeName&gt;Typee6709c0639547b19d45c41aa259d27&lt;/TypeName&gt;&lt;/ESBMessagePipelineStep&gt;&lt;ESBMessagePipelineStep i:type="d6p1:EsbMessagePipelineExecutionPipelineStep"&gt;&lt;Bindings xmlns:d27p1="http://schemas.datacontract.org/2004/07/Neuron.ComponentModel" /&gt;&lt;BreakPoint&gt;Disable&lt;/BreakPoint&gt;&lt;Disable&gt;false&lt;/Disable&gt;&lt;Id&gt;ab2613a6-3d06-4e5c-855e-e96924016a0f&lt;/Id&gt;&lt;Name&gt;Get Local URI&lt;/Name&gt;&lt;Uniquename /&gt;&lt;d6p1:FileName i:nil="true" /&gt;&lt;d6p1:MaxInstances&gt;100&lt;/d6p1:MaxInstances&gt;&lt;d6p1:PipelineName&gt;Process_GetLocalServiceURI - New&lt;/d6p1:PipelineName&gt;&lt;d6p1:PoolTimeout&gt;PT1M&lt;/d6p1:PoolTimeout&gt;&lt;/ESBMessagePipelineStep&gt;&lt;ESBMessagePipelineStep i:type="d6p1:EsbMessageCSharpCodePipelineStep"&gt;&lt;Bindings xmlns:d27p1="http://schemas.datacontract.org/2004/07/Neuron.ComponentModel" /&gt;&lt;BreakPoint&gt;Disable&lt;/BreakPoint&gt;&lt;Disable&gt;false&lt;/Disable&gt;&lt;Id&gt;dff67858-54b4-40d8-b13a-cf5facaa012f&lt;/Id&gt;&lt;Name&gt;Map From Local Service URI&lt;/Name&gt;&lt;Uniquename /&gt;&lt;BreakPointLines xmlns:d27p1="http://schemas.microsoft.com/2003/10/Serialization/Arrays" /&gt;&lt;Code&gt;string localServiceURI = context.Data.ToXmlDocument().SelectSingleNode("/*[local-name()='LocalServiceURIResponse' and namespace-uri()='http://NeoPLM.com/EnterpriseIntegration']/*[local-name()='LocalServiceURI' and namespace-uri()='http://NeoPLM.com/EnterpriseIntegration']").InnerText;

context.Properties ["LocalServiceURI"] = localServiceURI;

context.Instance.TraceInformation ("Process Lab Transaction - Transaction ID: " + context.Properties["TransactionID"] + " LocalServiceURI: " + context.Properties["LocalServiceURI"]);&lt;/Code&gt;&lt;ReferencedAssemblies xmlns:d27p1="http://schemas.microsoft.com/2003/10/Serialization/Arrays"&gt;&lt;d27p1:string&gt;Neuron&lt;/d27p1:string&gt;&lt;d27p1:string&gt;Neuron.Pipelines&lt;/d27p1:string&gt;&lt;d27p1:string&gt;Neuron.Esb&lt;/d27p1:string&gt;&lt;d27p1:string&gt;System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d27p1:string&gt;&lt;d27p1:string&gt;System.Core, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d27p1:string&gt;&lt;d27p1:string&gt;System.Xml, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d27p1:string&gt;&lt;d27p1:string&gt;System.Xml.Linq, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d27p1:string&gt;&lt;d27p1:string&gt;System.Data, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d27p1:string&gt;&lt;d27p1:string&gt;System.Data.DataSetExtensions, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d27p1:string&gt;&lt;d27p1:string&gt;System.Runtime.Serialization, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d27p1:string&gt;&lt;d27p1:string&gt;System.ServiceModel, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d27p1:string&gt;&lt;d27p1:string&gt;Newtonsoft.Json, Version=8.0.0.0, Culture=neutral, PublicKeyToken=30ad4fe6b2a6aeed&lt;/d27p1:string&gt;&lt;d27p1:string&gt;Microsoft.CSharp, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a&lt;/d27p1:string&gt;&lt;/ReferencedAssemblies&gt;&lt;TypeName&gt;Typea1b60ddd5f04bb6961d10262d34d84&lt;/TypeName&gt;&lt;/ESBMessagePipelineStep&gt;&lt;ESBMessagePipelineStep i:type="DecisionPipelineStepOfESBMessagexAPWb1W4"&gt;&lt;Bindings xmlns:d27p1="http://schemas.datacontract.org/2004/07/Neuron.ComponentModel" /&gt;&lt;BreakPoint&gt;Disable&lt;/BreakPoint&gt;&lt;Disable&gt;false&lt;/Disable&gt;&lt;Id&gt;e5df381e-b861-4654-af91-cd285d01a656&lt;/Id&gt;&lt;Name&gt;Local URI?&lt;/Name&gt;&lt;Uniquename /&gt;&lt;Branches&gt;&lt;BranchOfESBMessagexAPWb1W4&gt;&lt;BreakPoint&gt;Disable&lt;/BreakPoint&gt;&lt;Condition i:type="CodeBranchConditionOfESBMessagexAPWb1W4"&gt;&lt;Code&gt;if (context.Data.GetProperty("NeoPLM", "LookupError").ToUpper() == "FALSE")
{
	return true;
}
else
{
	return false;
}	&lt;/Code&gt;&lt;ReferencedAssemblies xmlns:d30p1="http://schemas.microsoft.com/2003/10/Serialization/Arrays"&gt;&lt;d30p1:string&gt;Neuron&lt;/d30p1:string&gt;&lt;d30p1:string&gt;Neuron.Pipelines&lt;/d30p1:string&gt;&lt;d30p1:string&gt;Neuron.Esb&lt;/d30p1:string&gt;&lt;d30p1:string&gt;System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d30p1:string&gt;&lt;d30p1:string&gt;System.Core, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d30p1:string&gt;&lt;d30p1:string&gt;System.Xml, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d30p1:string&gt;&lt;d30p1:string&gt;System.Xml.Linq, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d30p1:string&gt;&lt;d30p1:string&gt;System.Data, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d30p1:string&gt;&lt;d30p1:string&gt;System.Runtime.Serialization, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d30p1:string&gt;&lt;d30p1:string&gt;System.ServiceModel, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d30p1:string&gt;&lt;/ReferencedAssemblies&gt;&lt;/Condition&gt;&lt;Disable&gt;false&lt;/Disable&gt;&lt;EndJoined&gt;false&lt;/EndJoined&gt;&lt;Name&gt;If&lt;/Name&gt;&lt;Steps&gt;&lt;Bindings xmlns:d30p1="http://schemas.datacontract.org/2004/07/Neuron.ComponentModel" /&gt;&lt;BreakPoint&gt;Disable&lt;/BreakPoint&gt;&lt;Disable&gt;false&lt;/Disable&gt;&lt;Id&gt;ec913962-c61f-44fb-9bf1-cfd400aa9f03&lt;/Id&gt;&lt;Name&gt;Group&lt;/Name&gt;&lt;Uniquename /&gt;&lt;Children&gt;&lt;ESBMessagePipelineStep i:type="d6p1:EsbMessageCSharpCodePipelineStep"&gt;&lt;Bindings xmlns:d32p1="http://schemas.datacontract.org/2004/07/Neuron.ComponentModel" /&gt;&lt;BreakPoint&gt;Disable&lt;/BreakPoint&gt;&lt;Disable&gt;false&lt;/Disable&gt;&lt;Id&gt;d7067bac-2d72-49bf-b7e8-d5b8a36f8691&lt;/Id&gt;&lt;Name&gt;Map To Material Lot Save&lt;/Name&gt;&lt;Uniquename /&gt;&lt;BreakPointLines xmlns:d32p1="http://schemas.microsoft.com/2003/10/Serialization/Arrays" /&gt;&lt;Code&gt;// Retrieve the response template message
string materialLotRequestTemplate = context.Configuration.XmlDocs["MaterialLotSave"].Xml;

// This is a placeholder material Lot.  These properties are set to the default values below.
string externalStatus = "";
string externalStatusDescription = "";
string lotStatus = "20";
string potency = "100";
string potencyLabel = "";
string potencyUnits = System.Guid.Empty.ToString();
string supplierID = "";
string supplierName = "";
string supplierLotID = "";
string lastModified = System.DateTime.UtcNow.ToString("yyyy-MM-ddTHH:mm:ssZ");
string sourceLastModified = System.DateTime.UtcNow.ToString("yyyy-MM-ddTHH:mm:ssZ");

// Create the request message
string materialLotRequest = string.Format(materialLotRequestTemplate, "Create", context.Properties["LocalServiceURI"], context.Properties["MaterialLotID"], context.Properties["FacilityUID"], context.Properties["PlantCodeUID"], context.Properties["MaterialMasterUID"], context.Properties["NeoMaterialType"], externalStatus, externalStatusDescription, lotStatus, potency, potencyLabel, potencyUnits, supplierID, supplierName, supplierLotID, lastModified, sourceLastModified );

//Send the trace message to document the request message.
context.Instance.TraceInformation ("Process Lab Transaction - Message ID: " + context.Data.Header.MessageId.ToString() + " Request Message: " + materialLotRequest);
	
// Set message context to the request message 	
context.Data.Text = materialLotRequest;&lt;/Code&gt;&lt;ReferencedAssemblies xmlns:d32p1="http://schemas.microsoft.com/2003/10/Serialization/Arrays"&gt;&lt;d32p1:string&gt;Neuron&lt;/d32p1:string&gt;&lt;d32p1:string&gt;Neuron.Pipelines&lt;/d32p1:string&gt;&lt;d32p1:string&gt;Neuron.Esb&lt;/d32p1:string&gt;&lt;d32p1:string&gt;System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d32p1:string&gt;&lt;d32p1:string&gt;System.Core, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d32p1:string&gt;&lt;d32p1:string&gt;System.Xml, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d32p1:string&gt;&lt;d32p1:string&gt;System.Xml.Linq, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d32p1:string&gt;&lt;d32p1:string&gt;System.Data, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d32p1:string&gt;&lt;d32p1:string&gt;System.Data.DataSetExtensions, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d32p1:string&gt;&lt;d32p1:string&gt;System.Runtime.Serialization, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d32p1:string&gt;&lt;d32p1:string&gt;System.ServiceModel, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d32p1:string&gt;&lt;d32p1:string&gt;Newtonsoft.Json, Version=8.0.0.0, Culture=neutral, PublicKeyToken=30ad4fe6b2a6aeed&lt;/d32p1:string&gt;&lt;d32p1:string&gt;Microsoft.CSharp, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a&lt;/d32p1:string&gt;&lt;/ReferencedAssemblies&gt;&lt;TypeName&gt;Type7cd5810834d4b378303d3cc679cdfa&lt;/TypeName&gt;&lt;/ESBMessagePipelineStep&gt;&lt;ESBMessagePipelineStep i:type="d6p1:EsbMessageTraceMessagePipelineStep"&gt;&lt;Bindings xmlns:d32p1="http://schemas.datacontract.org/2004/07/Neuron.ComponentModel" /&gt;&lt;BreakPoint&gt;Disable&lt;/BreakPoint&gt;&lt;Disable&gt;false&lt;/Disable&gt;&lt;Id&gt;59005f0f-1f11-45fb-a6c5-9df5842376da&lt;/Id&gt;&lt;Name&gt;TraceMessage&lt;/Name&gt;&lt;Uniquename /&gt;&lt;/ESBMessagePipelineStep&gt;&lt;ESBMessagePipelineStep i:type="d6p1:EsbMessagePipelineExecutionPipelineStep"&gt;&lt;Bindings xmlns:d32p1="http://schemas.datacontract.org/2004/07/Neuron.ComponentModel" /&gt;&lt;BreakPoint&gt;Disable&lt;/BreakPoint&gt;&lt;Disable&gt;false&lt;/Disable&gt;&lt;Id&gt;77b331a3-2985-493a-b47b-4a5dfd93c723&lt;/Id&gt;&lt;Name&gt;Create Material Lot if Required&lt;/Name&gt;&lt;Uniquename&gt;66593041-eed0-44af-b806-b1903296bee5&lt;/Uniquename&gt;&lt;d6p1:FileName i:nil="true" /&gt;&lt;d6p1:MaxInstances&gt;100&lt;/d6p1:MaxInstances&gt;&lt;d6p1:PipelineName&gt;Process_CreateUpdateMaterialLot&lt;/d6p1:PipelineName&gt;&lt;d6p1:PoolTimeout&gt;PT1M&lt;/d6p1:PoolTimeout&gt;&lt;/ESBMessagePipelineStep&gt;&lt;ESBMessagePipelineStep i:type="d6p1:EsbMessageCSharpCodePipelineStep"&gt;&lt;Bindings xmlns:d32p1="http://schemas.datacontract.org/2004/07/Neuron.ComponentModel" /&gt;&lt;BreakPoint&gt;Disable&lt;/BreakPoint&gt;&lt;Disable&gt;false&lt;/Disable&gt;&lt;Id&gt;e996ac0d-738d-42db-a76e-383a3df6042a&lt;/Id&gt;&lt;Name&gt;Map From Material Lot Save&lt;/Name&gt;&lt;Uniquename /&gt;&lt;BreakPointLines xmlns:d32p1="http://schemas.microsoft.com/2003/10/Serialization/Arrays" /&gt;&lt;Code&gt;string materialLotUID = context.Data.GetProperty ("NeoPLM", "MaterialLotUID");

context.Properties ["MaterialLotUID"] = materialLotUID;

context.Instance.TraceInformation ("Process Lab Transaction - Transaction ID: " + context.Properties["TransactionID"] + " MaterialLotUID: " + context.Properties["MaterialLotUID"]);&lt;/Code&gt;&lt;ReferencedAssemblies xmlns:d32p1="http://schemas.microsoft.com/2003/10/Serialization/Arrays"&gt;&lt;d32p1:string&gt;Neuron&lt;/d32p1:string&gt;&lt;d32p1:string&gt;Neuron.Pipelines&lt;/d32p1:string&gt;&lt;d32p1:string&gt;Neuron.Esb&lt;/d32p1:string&gt;&lt;d32p1:string&gt;System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d32p1:string&gt;&lt;d32p1:string&gt;System.Core, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d32p1:string&gt;&lt;d32p1:string&gt;System.Xml, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d32p1:string&gt;&lt;d32p1:string&gt;System.Xml.Linq, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d32p1:string&gt;&lt;d32p1:string&gt;System.Data, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d32p1:string&gt;&lt;d32p1:string&gt;System.Data.DataSetExtensions, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d32p1:string&gt;&lt;d32p1:string&gt;System.Runtime.Serialization, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d32p1:string&gt;&lt;d32p1:string&gt;System.ServiceModel, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d32p1:string&gt;&lt;d32p1:string&gt;Newtonsoft.Json, Version=8.0.0.0, Culture=neutral, PublicKeyToken=30ad4fe6b2a6aeed&lt;/d32p1:string&gt;&lt;d32p1:string&gt;Microsoft.CSharp, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a&lt;/d32p1:string&gt;&lt;/ReferencedAssemblies&gt;&lt;TypeName&gt;Type4652367cab44b28914bbc87cf93e44&lt;/TypeName&gt;&lt;/ESBMessagePipelineStep&gt;&lt;ESBMessagePipelineStep i:type="d6p1:EsbMessageCSharpCodePipelineStep"&gt;&lt;Bindings xmlns:d32p1="http://schemas.datacontract.org/2004/07/Neuron.ComponentModel" /&gt;&lt;BreakPoint&gt;Disable&lt;/BreakPoint&gt;&lt;Disable&gt;false&lt;/Disable&gt;&lt;Id&gt;5c401374-2686-4e98-85d2-26915da1db43&lt;/Id&gt;&lt;Name&gt;Map To Create Lab History&lt;/Name&gt;&lt;Uniquename /&gt;&lt;BreakPointLines xmlns:d32p1="http://schemas.microsoft.com/2003/10/Serialization/Arrays" /&gt;&lt;Code&gt;// Retrieve the response template message
string labHistoryRequestTemplate = context.Configuration.XmlDocs["LabHistorySaveRequest"].Xml;

string sourceRecordUniqueID = context.Properties["PlantID"] + "-" + context.Properties["MaterialID"] + "-" + context.Properties ["MaterialLotID"] + "-" + context.Properties["TestTemplateID"]; 
string lastModified = System.DateTime.UtcNow.ToString("yyyy-MM-ddTHH:mm:ssZ");
 
string testTemplateDescription = System.Net.WebUtility.HtmlEncode (context.Properties["TestTemplateDescription"].ToString());
string testTemplateID = System.Net.WebUtility.HtmlEncode (context.Properties["TestTemplateID"].ToString());

// Create the request message
string labHistoryRequest = string.Format(labHistoryRequestTemplate, "Create", 
	                                     context.Properties["LocalServiceURI"], sourceRecordUniqueID, 
	                                     context.Properties["MaterialLotUID"], testTemplateID, 
	                                     context.Properties["TestTemplateVersion"], testTemplateDescription, 
                                         context.Properties["TestTemplateType"], "",
	                                     lastModified);

//Send the trace message to document the request message.
context.Instance.TraceInformation ("Process Lab Transaction - Message ID: " + context.Data.Header.MessageId.ToString() + " Request Message: " + labHistoryRequest);
	
// Set message context to the request message 	
context.Data.Text = labHistoryRequest;&lt;/Code&gt;&lt;ReferencedAssemblies xmlns:d32p1="http://schemas.microsoft.com/2003/10/Serialization/Arrays"&gt;&lt;d32p1:string&gt;Neuron&lt;/d32p1:string&gt;&lt;d32p1:string&gt;Neuron.Pipelines&lt;/d32p1:string&gt;&lt;d32p1:string&gt;Neuron.Esb&lt;/d32p1:string&gt;&lt;d32p1:string&gt;System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d32p1:string&gt;&lt;d32p1:string&gt;System.Core, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d32p1:string&gt;&lt;d32p1:string&gt;System.Xml, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d32p1:string&gt;&lt;d32p1:string&gt;System.Xml.Linq, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d32p1:string&gt;&lt;d32p1:string&gt;System.Data, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d32p1:string&gt;&lt;d32p1:string&gt;System.Data.DataSetExtensions, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d32p1:string&gt;&lt;d32p1:string&gt;System.Runtime.Serialization, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d32p1:string&gt;&lt;d32p1:string&gt;System.ServiceModel, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d32p1:string&gt;&lt;d32p1:string&gt;Newtonsoft.Json, Version=8.0.0.0, Culture=neutral, PublicKeyToken=30ad4fe6b2a6aeed&lt;/d32p1:string&gt;&lt;d32p1:string&gt;Microsoft.CSharp, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a&lt;/d32p1:string&gt;&lt;/ReferencedAssemblies&gt;&lt;TypeName&gt;Type7cf0773e62e40f49551d4083c788b1&lt;/TypeName&gt;&lt;/ESBMessagePipelineStep&gt;&lt;ESBMessagePipelineStep i:type="d6p1:EsbMessagePipelineExecutionPipelineStep"&gt;&lt;Bindings xmlns:d32p1="http://schemas.datacontract.org/2004/07/Neuron.ComponentModel" /&gt;&lt;BreakPoint&gt;Disable&lt;/BreakPoint&gt;&lt;Disable&gt;false&lt;/Disable&gt;&lt;Id&gt;9dbf1c8f-8731-44c2-b190-07f20550ccba&lt;/Id&gt;&lt;Name&gt;Lab History&lt;/Name&gt;&lt;Uniquename /&gt;&lt;d6p1:FileName i:nil="true" /&gt;&lt;d6p1:MaxInstances&gt;100&lt;/d6p1:MaxInstances&gt;&lt;d6p1:PipelineName&gt;Process_CreateUpdateLabHistory&lt;/d6p1:PipelineName&gt;&lt;d6p1:PoolTimeout&gt;PT1M&lt;/d6p1:PoolTimeout&gt;&lt;/ESBMessagePipelineStep&gt;&lt;ESBMessagePipelineStep i:type="d6p1:EsbMessageCSharpCodePipelineStep"&gt;&lt;Bindings xmlns:d32p1="http://schemas.datacontract.org/2004/07/Neuron.ComponentModel" /&gt;&lt;BreakPoint&gt;Disable&lt;/BreakPoint&gt;&lt;Disable&gt;false&lt;/Disable&gt;&lt;Id&gt;da8dae02-d88d-456b-a6d9-f80f8620b614&lt;/Id&gt;&lt;Name&gt;Map From Create Lab History&lt;/Name&gt;&lt;Uniquename /&gt;&lt;BreakPointLines xmlns:d32p1="http://schemas.microsoft.com/2003/10/Serialization/Arrays" /&gt;&lt;Code&gt;string labHistoryUID = context.Data.GetProperty ("NeoPLM", "LabHistoryUID");

context.Properties ["LabHistoryUID"] = labHistoryUID;

context.Instance.TraceInformation ("Process Lab Transaction - Transaction ID: " + context.Properties["TransactionID"] + " LabHistoryUID: " + context.Properties["LabHistoryUID"]);&lt;/Code&gt;&lt;ReferencedAssemblies xmlns:d32p1="http://schemas.microsoft.com/2003/10/Serialization/Arrays"&gt;&lt;d32p1:string&gt;Neuron&lt;/d32p1:string&gt;&lt;d32p1:string&gt;Neuron.Pipelines&lt;/d32p1:string&gt;&lt;d32p1:string&gt;Neuron.Esb&lt;/d32p1:string&gt;&lt;d32p1:string&gt;System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d32p1:string&gt;&lt;d32p1:string&gt;System.Core, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d32p1:string&gt;&lt;d32p1:string&gt;System.Xml, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d32p1:string&gt;&lt;d32p1:string&gt;System.Xml.Linq, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d32p1:string&gt;&lt;d32p1:string&gt;System.Data, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d32p1:string&gt;&lt;d32p1:string&gt;System.Data.DataSetExtensions, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d32p1:string&gt;&lt;d32p1:string&gt;System.Runtime.Serialization, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d32p1:string&gt;&lt;d32p1:string&gt;System.ServiceModel, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d32p1:string&gt;&lt;d32p1:string&gt;Newtonsoft.Json, Version=8.0.0.0, Culture=neutral, PublicKeyToken=30ad4fe6b2a6aeed&lt;/d32p1:string&gt;&lt;d32p1:string&gt;Microsoft.CSharp, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a&lt;/d32p1:string&gt;&lt;/ReferencedAssemblies&gt;&lt;TypeName&gt;Type531f907b35a4e8ebb1eafbcfdb9665&lt;/TypeName&gt;&lt;/ESBMessagePipelineStep&gt;&lt;ESBMessagePipelineStep i:type="d6p1:EsbMessageCSharpCodePipelineStep"&gt;&lt;Bindings xmlns:d32p1="http://schemas.datacontract.org/2004/07/Neuron.ComponentModel" /&gt;&lt;BreakPoint&gt;Disable&lt;/BreakPoint&gt;&lt;Disable&gt;false&lt;/Disable&gt;&lt;Id&gt;d6c09eed-07fa-4dff-bd55-4b4f732c6c0f&lt;/Id&gt;&lt;Name&gt;Load Lab Sample Histories&lt;/Name&gt;&lt;Uniquename /&gt;&lt;BreakPointLines xmlns:d32p1="http://schemas.microsoft.com/2003/10/Serialization/Arrays" /&gt;&lt;Code&gt;
var labHistory = (System.Xml.XmlNode)context.Properties["NeoPLMLabHistory"];

foreach(System.Xml.XmlNode xNode in labHistory.ChildNodes)
{	
	if(xNode.Name == "LabSampleHistories")
	{
		context.Properties["LabSampleHistories"] = xNode;
		var labSampleHistories = (System.Xml.XmlNode)context.Properties["LabSampleHistories"];
		context.Instance.TraceInformation("Lab Sample Histories Count: " + labSampleHistories.ChildNodes.Count);
	}
}&lt;/Code&gt;&lt;ReferencedAssemblies xmlns:d32p1="http://schemas.microsoft.com/2003/10/Serialization/Arrays"&gt;&lt;d32p1:string&gt;Neuron&lt;/d32p1:string&gt;&lt;d32p1:string&gt;Neuron.Pipelines&lt;/d32p1:string&gt;&lt;d32p1:string&gt;Neuron.Esb&lt;/d32p1:string&gt;&lt;d32p1:string&gt;System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d32p1:string&gt;&lt;d32p1:string&gt;System.Core, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d32p1:string&gt;&lt;d32p1:string&gt;System.Xml, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d32p1:string&gt;&lt;d32p1:string&gt;System.Xml.Linq, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d32p1:string&gt;&lt;d32p1:string&gt;System.Data, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d32p1:string&gt;&lt;d32p1:string&gt;System.Data.DataSetExtensions, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d32p1:string&gt;&lt;d32p1:string&gt;System.Runtime.Serialization, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d32p1:string&gt;&lt;d32p1:string&gt;System.ServiceModel, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d32p1:string&gt;&lt;/ReferencedAssemblies&gt;&lt;TypeName&gt;Type68e810b86e54eb19783912c91b2732&lt;/TypeName&gt;&lt;/ESBMessagePipelineStep&gt;&lt;ESBMessagePipelineStep i:type="ForEachPipelineStepOfESBMessagexAPWb1W4"&gt;&lt;Bindings xmlns:d32p1="http://schemas.datacontract.org/2004/07/Neuron.ComponentModel" /&gt;&lt;BreakPoint&gt;Disable&lt;/BreakPoint&gt;&lt;Disable&gt;false&lt;/Disable&gt;&lt;Id&gt;3544fb15-3fb4-49c0-99ac-d9f6b55e44a1&lt;/Id&gt;&lt;Name&gt;Lab Sample History&lt;/Name&gt;&lt;Uniquename /&gt;&lt;Children&gt;&lt;ESBMessagePipelineStep i:type="d6p1:EsbMessageCSharpCodePipelineStep"&gt;&lt;Bindings xmlns:d34p1="http://schemas.datacontract.org/2004/07/Neuron.ComponentModel" /&gt;&lt;BreakPoint&gt;Disable&lt;/BreakPoint&gt;&lt;Disable&gt;false&lt;/Disable&gt;&lt;Id&gt;77a1de30-0bff-44b4-883d-e8139e6c2397&lt;/Id&gt;&lt;Name&gt;Map To Lab Sample History&lt;/Name&gt;&lt;Uniquename /&gt;&lt;BreakPointLines xmlns:d34p1="http://schemas.microsoft.com/2003/10/Serialization/Arrays" /&gt;&lt;Code&gt;// Retrieve the response template message
string labSampleHistoryRequestTemplate = context.Configuration.XmlDocs["LabSampleHistorySaveRequest"].Xml;

var labSampleHistory = (System.Xml.XmlNode)context.Properties["LabSampleHistory"];
var sampleId = "";
foreach(System.Xml.XmlNode node in labSampleHistory.ChildNodes) { if(node.Name == "SampleID") { sampleId = node.InnerText; break; } }
var controlPointId = "";
foreach(System.Xml.XmlNode node in labSampleHistory.ChildNodes) { if(node.Name == "ControlPointID") { controlPointId = node.InnerText; break; } }
var controlPointDescription = "";
foreach(System.Xml.XmlNode node in labSampleHistory.ChildNodes) { if(node.Name == "ControlPointDescription") { controlPointDescription = node.InnerText; break; } }

controlPointDescription = System.Net.WebUtility.HtmlEncode (controlPointDescription);
sampleId = System.Net.WebUtility.HtmlEncode (sampleId);
controlPointId = System.Net.WebUtility.HtmlEncode (controlPointId);
 
// Create the request message
string labSampleHistoryRequest = string.Format(labSampleHistoryRequestTemplate, "Create", 
	                                     context.Properties["LocalServiceURI"],  
	                                     context.Properties["LabHistoryUID"], sampleId, 
	                                     sampleId, controlPointId, 
                                         controlPointDescription, "");

//Send the trace message to document the request message.
context.Instance.TraceInformation ("Process Lab Transaction - Message ID: " + context.Data.Header.MessageId.ToString() + " Request Message: " + labSampleHistoryRequest);
	
// Set message context to the request message 	
context.Data.Text = labSampleHistoryRequest;&lt;/Code&gt;&lt;ReferencedAssemblies xmlns:d34p1="http://schemas.microsoft.com/2003/10/Serialization/Arrays"&gt;&lt;d34p1:string&gt;Neuron&lt;/d34p1:string&gt;&lt;d34p1:string&gt;Neuron.Pipelines&lt;/d34p1:string&gt;&lt;d34p1:string&gt;Neuron.Esb&lt;/d34p1:string&gt;&lt;d34p1:string&gt;System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d34p1:string&gt;&lt;d34p1:string&gt;System.Core, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d34p1:string&gt;&lt;d34p1:string&gt;System.Xml, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d34p1:string&gt;&lt;d34p1:string&gt;System.Xml.Linq, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d34p1:string&gt;&lt;d34p1:string&gt;System.Data, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d34p1:string&gt;&lt;d34p1:string&gt;System.Data.DataSetExtensions, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d34p1:string&gt;&lt;d34p1:string&gt;System.Runtime.Serialization, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d34p1:string&gt;&lt;d34p1:string&gt;System.ServiceModel, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d34p1:string&gt;&lt;d34p1:string&gt;Newtonsoft.Json, Version=8.0.0.0, Culture=neutral, PublicKeyToken=30ad4fe6b2a6aeed&lt;/d34p1:string&gt;&lt;d34p1:string&gt;Microsoft.CSharp, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a&lt;/d34p1:string&gt;&lt;/ReferencedAssemblies&gt;&lt;TypeName&gt;Type36d4cabbda542b29eb9d7dc9a42ba1&lt;/TypeName&gt;&lt;/ESBMessagePipelineStep&gt;&lt;ESBMessagePipelineStep i:type="d6p1:EsbMessagePipelineExecutionPipelineStep"&gt;&lt;Bindings xmlns:d34p1="http://schemas.datacontract.org/2004/07/Neuron.ComponentModel" /&gt;&lt;BreakPoint&gt;Disable&lt;/BreakPoint&gt;&lt;Disable&gt;false&lt;/Disable&gt;&lt;Id&gt;3581134e-e9e9-42b6-b4ae-98a2ce9cccd1&lt;/Id&gt;&lt;Name&gt;Lab Sample History&lt;/Name&gt;&lt;Uniquename /&gt;&lt;d6p1:FileName i:nil="true" /&gt;&lt;d6p1:MaxInstances&gt;100&lt;/d6p1:MaxInstances&gt;&lt;d6p1:PipelineName&gt;Process_CreateUpdateLabSampleHistory&lt;/d6p1:PipelineName&gt;&lt;d6p1:PoolTimeout&gt;PT1M&lt;/d6p1:PoolTimeout&gt;&lt;/ESBMessagePipelineStep&gt;&lt;ESBMessagePipelineStep i:type="d6p1:EsbMessageCSharpCodePipelineStep"&gt;&lt;Bindings xmlns:d34p1="http://schemas.datacontract.org/2004/07/Neuron.ComponentModel" /&gt;&lt;BreakPoint&gt;Disable&lt;/BreakPoint&gt;&lt;Disable&gt;false&lt;/Disable&gt;&lt;Id&gt;ca105596-7388-4f78-bcf3-116bacaf9b20&lt;/Id&gt;&lt;Name&gt;Map From Lab Sample History&lt;/Name&gt;&lt;Uniquename /&gt;&lt;BreakPointLines xmlns:d34p1="http://schemas.microsoft.com/2003/10/Serialization/Arrays" /&gt;&lt;Code&gt;string labSampleHistoryUID = context.Data.GetProperty ("NeoPLM", "LabSampleHistoryUID");

context.Properties ["LabSampleHistoryUID"] = labSampleHistoryUID;

context.Instance.TraceInformation ("Process Lab Transaction - Transaction ID: " + context.Properties["TransactionID"] + " LabSampleHistoryUID: " + context.Properties["LabSampleHistoryUID"]);&lt;/Code&gt;&lt;ReferencedAssemblies xmlns:d34p1="http://schemas.microsoft.com/2003/10/Serialization/Arrays"&gt;&lt;d34p1:string&gt;Neuron&lt;/d34p1:string&gt;&lt;d34p1:string&gt;Neuron.Pipelines&lt;/d34p1:string&gt;&lt;d34p1:string&gt;Neuron.Esb&lt;/d34p1:string&gt;&lt;d34p1:string&gt;System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d34p1:string&gt;&lt;d34p1:string&gt;System.Core, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d34p1:string&gt;&lt;d34p1:string&gt;System.Xml, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d34p1:string&gt;&lt;d34p1:string&gt;System.Xml.Linq, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d34p1:string&gt;&lt;d34p1:string&gt;System.Data, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d34p1:string&gt;&lt;d34p1:string&gt;System.Data.DataSetExtensions, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d34p1:string&gt;&lt;d34p1:string&gt;System.Runtime.Serialization, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d34p1:string&gt;&lt;d34p1:string&gt;System.ServiceModel, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d34p1:string&gt;&lt;d34p1:string&gt;Newtonsoft.Json, Version=8.0.0.0, Culture=neutral, PublicKeyToken=30ad4fe6b2a6aeed&lt;/d34p1:string&gt;&lt;d34p1:string&gt;Microsoft.CSharp, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a&lt;/d34p1:string&gt;&lt;/ReferencedAssemblies&gt;&lt;TypeName&gt;Typee194c1186e6497bab9be79777d33d8&lt;/TypeName&gt;&lt;/ESBMessagePipelineStep&gt;&lt;ESBMessagePipelineStep i:type="d6p1:EsbMessageCSharpCodePipelineStep"&gt;&lt;Bindings xmlns:d34p1="http://schemas.datacontract.org/2004/07/Neuron.ComponentModel" /&gt;&lt;BreakPoint&gt;Disable&lt;/BreakPoint&gt;&lt;Disable&gt;false&lt;/Disable&gt;&lt;Id&gt;30a1f79c-90a1-44d9-becf-3c42c24c806e&lt;/Id&gt;&lt;Name&gt;Load Lab Test History&lt;/Name&gt;&lt;Uniquename /&gt;&lt;BreakPointLines xmlns:d34p1="http://schemas.microsoft.com/2003/10/Serialization/Arrays" /&gt;&lt;Code&gt;
var labSampleHistory = (System.Xml.XmlNode)context.Properties["LabSampleHistory"];

foreach(System.Xml.XmlNode xNode in labSampleHistory.ChildNodes)
{	
	if(xNode.Name == "LabTestHistories")
	{
		context.Properties["LabTestHistories"] = xNode;
		var labTestHistories = (System.Xml.XmlNode)context.Properties["LabTestHistories"];
		context.Instance.TraceInformation("Lab Sample Histories Count: " + labTestHistories.ChildNodes.Count);
	}
}&lt;/Code&gt;&lt;ReferencedAssemblies xmlns:d34p1="http://schemas.microsoft.com/2003/10/Serialization/Arrays"&gt;&lt;d34p1:string&gt;Neuron&lt;/d34p1:string&gt;&lt;d34p1:string&gt;Neuron.Pipelines&lt;/d34p1:string&gt;&lt;d34p1:string&gt;Neuron.Esb&lt;/d34p1:string&gt;&lt;d34p1:string&gt;System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d34p1:string&gt;&lt;d34p1:string&gt;System.Core, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d34p1:string&gt;&lt;d34p1:string&gt;System.Xml, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d34p1:string&gt;&lt;d34p1:string&gt;System.Xml.Linq, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d34p1:string&gt;&lt;d34p1:string&gt;System.Data, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d34p1:string&gt;&lt;d34p1:string&gt;System.Data.DataSetExtensions, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d34p1:string&gt;&lt;d34p1:string&gt;System.Runtime.Serialization, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d34p1:string&gt;&lt;d34p1:string&gt;System.ServiceModel, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d34p1:string&gt;&lt;d34p1:string&gt;Newtonsoft.Json, Version=8.0.0.0, Culture=neutral, PublicKeyToken=30ad4fe6b2a6aeed&lt;/d34p1:string&gt;&lt;d34p1:string&gt;Microsoft.CSharp, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a&lt;/d34p1:string&gt;&lt;/ReferencedAssemblies&gt;&lt;TypeName&gt;Type9206b1e92ba4cff8551ed27a72fd30&lt;/TypeName&gt;&lt;/ESBMessagePipelineStep&gt;&lt;ESBMessagePipelineStep i:type="ForEachPipelineStepOfESBMessagexAPWb1W4"&gt;&lt;Bindings xmlns:d34p1="http://schemas.datacontract.org/2004/07/Neuron.ComponentModel" /&gt;&lt;BreakPoint&gt;Disable&lt;/BreakPoint&gt;&lt;Disable&gt;false&lt;/Disable&gt;&lt;Id&gt;60c61490-9b56-47b5-89ee-893284cfe039&lt;/Id&gt;&lt;Name&gt;Lab Test History&lt;/Name&gt;&lt;Uniquename /&gt;&lt;Children&gt;&lt;ESBMessagePipelineStep i:type="d6p1:EsbMessageCSharpCodePipelineStep"&gt;&lt;Bindings xmlns:d36p1="http://schemas.datacontract.org/2004/07/Neuron.ComponentModel" /&gt;&lt;BreakPoint&gt;Disable&lt;/BreakPoint&gt;&lt;Disable&gt;false&lt;/Disable&gt;&lt;Id&gt;e0c962ba-1487-484b-b06f-c4fd4e8b73ec&lt;/Id&gt;&lt;Name&gt;Map To Lab Test History&lt;/Name&gt;&lt;Uniquename /&gt;&lt;BreakPointLines xmlns:d36p1="http://schemas.microsoft.com/2003/10/Serialization/Arrays" /&gt;&lt;Code&gt;// Retrieve the response template message
string labTestHistoryRequestTemplate = context.Configuration.XmlDocs["LabTestHistorySaveRequest"].Xml;

var labTestHistory = (System.Xml.XmlNode)context.Properties["LabTestHistory"];

var testId = "";
foreach(System.Xml.XmlNode node in labTestHistory.ChildNodes) { if(node.Name == "TestID") { testId = node.InnerText; break; } }

var testDescription = "";
foreach(System.Xml.XmlNode node in labTestHistory.ChildNodes) { if(node.Name == "TestDescription") { testDescription = node.InnerText; break; } }

var testMethodId = "";
foreach(System.Xml.XmlNode node in labTestHistory.ChildNodes) { if(node.Name == "TestMethodID") { testMethodId = node.InnerText; break; } }

var testMethodVersion = "";
foreach(System.Xml.XmlNode node in labTestHistory.ChildNodes) { if(node.Name == "TestMethodVersion") { testMethodVersion = node.InnerText; break; } }

var testMethodDescription = "";
foreach(System.Xml.XmlNode node in labTestHistory.ChildNodes) { if(node.Name == "TestMethodDescription") { testMethodDescription = node.InnerText; break; } }

var testIsOptional = "";
foreach(System.Xml.XmlNode node in labTestHistory.ChildNodes) { if(node.Name == "TestIsOptional") { testIsOptional = node.InnerText; break; } }

//Business Rule!
if(testIsOptional.Trim().Length == 0) { testIsOptional = "false"; }

var testStatus = "";
foreach(System.Xml.XmlNode node in labTestHistory.ChildNodes) { if(node.Name == "TestResultStatus") { testStatus = node.InnerText; break; } }

testId = System.Net.WebUtility.HtmlEncode (testId);
testDescription = System.Net.WebUtility.HtmlEncode (testDescription);
testMethodId = System.Net.WebUtility.HtmlEncode (testMethodId);
testMethodDescription = System.Net.WebUtility.HtmlEncode (testMethodDescription);
 
// Create the request message
string labTestHistoryRequest = string.Format(labTestHistoryRequestTemplate, "Create/Update", 
	                                     context.Properties["LocalServiceURI"],  
	                                     context.Properties["LabSampleHistoryUID"], testId, 
	                                     testId, testDescription, 
                                         testMethodId, testMethodVersion, testMethodDescription,
	                                     testIsOptional, testStatus, "");

//Send the trace message to document the request message.
context.Instance.TraceInformation ("Process Lab Transaction - Message ID: " + context.Data.Header.MessageId.ToString() + " Request Message: " + labTestHistoryRequest);
	
// Set message context to the request message 	
context.Data.Text = labTestHistoryRequest;&lt;/Code&gt;&lt;ReferencedAssemblies xmlns:d36p1="http://schemas.microsoft.com/2003/10/Serialization/Arrays"&gt;&lt;d36p1:string&gt;Neuron&lt;/d36p1:string&gt;&lt;d36p1:string&gt;Neuron.Pipelines&lt;/d36p1:string&gt;&lt;d36p1:string&gt;Neuron.Esb&lt;/d36p1:string&gt;&lt;d36p1:string&gt;System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d36p1:string&gt;&lt;d36p1:string&gt;System.Core, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d36p1:string&gt;&lt;d36p1:string&gt;System.Xml, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d36p1:string&gt;&lt;d36p1:string&gt;System.Xml.Linq, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d36p1:string&gt;&lt;d36p1:string&gt;System.Data, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d36p1:string&gt;&lt;d36p1:string&gt;System.Data.DataSetExtensions, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d36p1:string&gt;&lt;d36p1:string&gt;System.Runtime.Serialization, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d36p1:string&gt;&lt;d36p1:string&gt;System.ServiceModel, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d36p1:string&gt;&lt;d36p1:string&gt;Newtonsoft.Json, Version=8.0.0.0, Culture=neutral, PublicKeyToken=30ad4fe6b2a6aeed&lt;/d36p1:string&gt;&lt;d36p1:string&gt;Microsoft.CSharp, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a&lt;/d36p1:string&gt;&lt;/ReferencedAssemblies&gt;&lt;TypeName&gt;Type36d4cabbda542b29eb9d7dc9a42ba1&lt;/TypeName&gt;&lt;/ESBMessagePipelineStep&gt;&lt;ESBMessagePipelineStep i:type="d6p1:EsbMessagePipelineExecutionPipelineStep"&gt;&lt;Bindings xmlns:d36p1="http://schemas.datacontract.org/2004/07/Neuron.ComponentModel" /&gt;&lt;BreakPoint&gt;Disable&lt;/BreakPoint&gt;&lt;Disable&gt;false&lt;/Disable&gt;&lt;Id&gt;6cadd258-a711-432c-8313-0bc94571b2e9&lt;/Id&gt;&lt;Name&gt;Lab Test History&lt;/Name&gt;&lt;Uniquename /&gt;&lt;d6p1:FileName i:nil="true" /&gt;&lt;d6p1:MaxInstances&gt;100&lt;/d6p1:MaxInstances&gt;&lt;d6p1:PipelineName&gt;Process_CreateUpdateLabTestHistory&lt;/d6p1:PipelineName&gt;&lt;d6p1:PoolTimeout&gt;PT1M&lt;/d6p1:PoolTimeout&gt;&lt;/ESBMessagePipelineStep&gt;&lt;ESBMessagePipelineStep i:type="d6p1:EsbMessageCSharpCodePipelineStep"&gt;&lt;Bindings xmlns:d36p1="http://schemas.datacontract.org/2004/07/Neuron.ComponentModel" /&gt;&lt;BreakPoint&gt;Disable&lt;/BreakPoint&gt;&lt;Disable&gt;false&lt;/Disable&gt;&lt;Id&gt;d8b626be-baac-49a7-b3f3-cd7de790b3e3&lt;/Id&gt;&lt;Name&gt;Map From Lab Test History&lt;/Name&gt;&lt;Uniquename /&gt;&lt;BreakPointLines xmlns:d36p1="http://schemas.microsoft.com/2003/10/Serialization/Arrays" /&gt;&lt;Code&gt;string labTestHistoryUID = context.Data.GetProperty ("NeoPLM", "LabTestHistoryUID");

context.Properties ["LabTestHistoryUID"] = labTestHistoryUID;

context.Instance.TraceInformation ("Process Lab Transaction - Transaction ID: " + context.Properties["TransactionID"] + " LabTestHistoryUID: " + context.Properties["LabTestHistoryUID"]);&lt;/Code&gt;&lt;ReferencedAssemblies xmlns:d36p1="http://schemas.microsoft.com/2003/10/Serialization/Arrays"&gt;&lt;d36p1:string&gt;Neuron&lt;/d36p1:string&gt;&lt;d36p1:string&gt;Neuron.Pipelines&lt;/d36p1:string&gt;&lt;d36p1:string&gt;Neuron.Esb&lt;/d36p1:string&gt;&lt;d36p1:string&gt;System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d36p1:string&gt;&lt;d36p1:string&gt;System.Core, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d36p1:string&gt;&lt;d36p1:string&gt;System.Xml, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d36p1:string&gt;&lt;d36p1:string&gt;System.Xml.Linq, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d36p1:string&gt;&lt;d36p1:string&gt;System.Data, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d36p1:string&gt;&lt;d36p1:string&gt;System.Data.DataSetExtensions, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d36p1:string&gt;&lt;d36p1:string&gt;System.Runtime.Serialization, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d36p1:string&gt;&lt;d36p1:string&gt;System.ServiceModel, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d36p1:string&gt;&lt;d36p1:string&gt;Newtonsoft.Json, Version=8.0.0.0, Culture=neutral, PublicKeyToken=30ad4fe6b2a6aeed&lt;/d36p1:string&gt;&lt;d36p1:string&gt;Microsoft.CSharp, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a&lt;/d36p1:string&gt;&lt;/ReferencedAssemblies&gt;&lt;TypeName&gt;Typee194c1186e6497bab9be79777d33d8&lt;/TypeName&gt;&lt;/ESBMessagePipelineStep&gt;&lt;ESBMessagePipelineStep i:type="d6p1:EsbMessageCSharpCodePipelineStep"&gt;&lt;Bindings xmlns:d36p1="http://schemas.datacontract.org/2004/07/Neuron.ComponentModel" /&gt;&lt;BreakPoint&gt;Disable&lt;/BreakPoint&gt;&lt;Disable&gt;false&lt;/Disable&gt;&lt;Id&gt;b5a30596-6381-4cb4-a6f1-20927a4b2801&lt;/Id&gt;&lt;Name&gt;Load Lab Result History&lt;/Name&gt;&lt;Uniquename /&gt;&lt;BreakPointLines xmlns:d36p1="http://schemas.microsoft.com/2003/10/Serialization/Arrays" /&gt;&lt;Code&gt;
var labTestHistory = (System.Xml.XmlNode)context.Properties["LabTestHistory"];

foreach(System.Xml.XmlNode xNode in labTestHistory.ChildNodes)
{	
	if(xNode.Name == "LabResultHistories")
	{
		context.Properties["LabResultHistories"] = xNode;
		var labResultHistories = (System.Xml.XmlNode)context.Properties["LabResultHistories"];
		context.Instance.TraceInformation("Lab Results Histories Count: " + labResultHistories.ChildNodes.Count);
	}
}&lt;/Code&gt;&lt;ReferencedAssemblies xmlns:d36p1="http://schemas.microsoft.com/2003/10/Serialization/Arrays"&gt;&lt;d36p1:string&gt;Neuron&lt;/d36p1:string&gt;&lt;d36p1:string&gt;Neuron.Pipelines&lt;/d36p1:string&gt;&lt;d36p1:string&gt;Neuron.Esb&lt;/d36p1:string&gt;&lt;d36p1:string&gt;System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d36p1:string&gt;&lt;d36p1:string&gt;System.Core, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d36p1:string&gt;&lt;d36p1:string&gt;System.Xml, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d36p1:string&gt;&lt;d36p1:string&gt;System.Xml.Linq, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d36p1:string&gt;&lt;d36p1:string&gt;System.Data, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d36p1:string&gt;&lt;d36p1:string&gt;System.Data.DataSetExtensions, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d36p1:string&gt;&lt;d36p1:string&gt;System.Runtime.Serialization, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d36p1:string&gt;&lt;d36p1:string&gt;System.ServiceModel, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d36p1:string&gt;&lt;d36p1:string&gt;Newtonsoft.Json, Version=8.0.0.0, Culture=neutral, PublicKeyToken=30ad4fe6b2a6aeed&lt;/d36p1:string&gt;&lt;d36p1:string&gt;Microsoft.CSharp, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a&lt;/d36p1:string&gt;&lt;/ReferencedAssemblies&gt;&lt;TypeName&gt;Type9206b1e92ba4cff8551ed27a72fd30&lt;/TypeName&gt;&lt;/ESBMessagePipelineStep&gt;&lt;ESBMessagePipelineStep i:type="ForEachPipelineStepOfESBMessagexAPWb1W4"&gt;&lt;Bindings xmlns:d36p1="http://schemas.datacontract.org/2004/07/Neuron.ComponentModel" /&gt;&lt;BreakPoint&gt;Disable&lt;/BreakPoint&gt;&lt;Disable&gt;false&lt;/Disable&gt;&lt;Id&gt;d95eb26a-0d2e-4dc1-a438-c2501ff7e904&lt;/Id&gt;&lt;Name&gt;Lab Result History&lt;/Name&gt;&lt;Uniquename /&gt;&lt;Children&gt;&lt;ESBMessagePipelineStep i:type="d6p1:EsbMessageCSharpCodePipelineStep"&gt;&lt;Bindings xmlns:d38p1="http://schemas.datacontract.org/2004/07/Neuron.ComponentModel" /&gt;&lt;BreakPoint&gt;Disable&lt;/BreakPoint&gt;&lt;Disable&gt;false&lt;/Disable&gt;&lt;Id&gt;e006c383-5cd7-4c14-84f6-42651887cde8&lt;/Id&gt;&lt;Name&gt;Map To Lab Result History&lt;/Name&gt;&lt;Uniquename /&gt;&lt;BreakPointLines xmlns:d38p1="http://schemas.microsoft.com/2003/10/Serialization/Arrays" /&gt;&lt;Code&gt;// Retrieve the response template message
string labResultHistoryRequestTemplate = context.Configuration.XmlDocs["LabResultHistorySaveRequest"].Xml;

var labResultHistory = (System.Xml.XmlNode)context.Properties["LabResultHistory"];

var testResultId = "";
foreach(System.Xml.XmlNode node in labResultHistory.ChildNodes) { if(node.Name == "TestResultID") { testResultId = node.InnerText; break; } }

var testResultDescription = "";
foreach(System.Xml.XmlNode node in labResultHistory.ChildNodes) { if(node.Name == "TestResultDescription") { testResultDescription = node.InnerText; break; } }

var testResultStatus = "";
foreach(System.Xml.XmlNode node in labResultHistory.ChildNodes) { if(node.Name == "TestResultStatus") { testResultStatus = node.InnerText; break; } }

var enteredResult = "";
foreach(System.Xml.XmlNode node in labResultHistory.ChildNodes) { if(node.Name == "EnteredResult") { enteredResult = node.InnerText; break; } }
enteredResult = System.Net.WebUtility.HtmlEncode (enteredResult);

var displayResult = "";
foreach(System.Xml.XmlNode node in labResultHistory.ChildNodes) { if(node.Name == "DisplayResult") { displayResult = node.InnerText; break; } }
displayResult = System.Net.WebUtility.HtmlEncode (displayResult);

var testResultEngineeringUnitLabel = "";
foreach(System.Xml.XmlNode node in labResultHistory.ChildNodes) { if(node.Name == "EnteredResultUOM") { testResultEngineeringUnitLabel = node.InnerText; break; } }

var expectedResult = "";
foreach(System.Xml.XmlNode node in labResultHistory.ChildNodes) { if(node.Name == "ExpectedResult") { expectedResult = node.InnerText; break; } }
expectedResult = System.Net.WebUtility.HtmlEncode (expectedResult);

var testResultInstanceNumber = "";
foreach(System.Xml.XmlNode node in labResultHistory.ChildNodes) { if(node.Name == "TestResultInstanceNumber") { testResultInstanceNumber = node.InnerText; break; } }

var isFinalResult = "";
foreach(System.Xml.XmlNode node in labResultHistory.ChildNodes) { if(node.Name == "IsFinalResult") { isFinalResult = node.InnerText; break; } }

var resultDateTime = "";
foreach(System.Xml.XmlNode node in labResultHistory.ChildNodes)
{
	if(node.Name == "ResultDateTime")
	{
		System.DateTime dt;
		if(System.DateTime.TryParse(node.InnerText, out dt))
		{
			if(dt.Kind != System.DateTimeKind.Unspecified)
			{
				resultDateTime = dt.ToUniversalTime().ToString("yyyy-MM-ddTHH:mm:ssZ");		
			}
			else
			{
				resultDateTime = System.DateTime.UtcNow.ToString ("yyyy-MM-ddTHH:mm:ssZ");
			}
		}
	} 
}

testResultId = System.Net.WebUtility.HtmlEncode (testResultId);
testResultDescription = System.Net.WebUtility.HtmlEncode (testResultDescription);

// Create the request message
string labResultHistoryRequest = string.Format(labResultHistoryRequestTemplate, "Create/Update", 
	                                     context.Properties["LocalServiceURI"],  
	                                     context.Properties["LabTestHistoryUID"], testResultId, 
	                                     testResultId, testResultDescription, 
                                         testResultStatus, enteredResult, displayResult, testResultEngineeringUnitLabel, 
	                                     expectedResult, testResultInstanceNumber, isFinalResult, resultDateTime, "");

//Send the trace message to document the request message.
context.Instance.TraceInformation ("Process Lab Transaction - Message ID: " + context.Data.Header.MessageId.ToString() + " Request Message: " + labResultHistoryRequest);
	
// Set message context to the request message 	
context.Data.Text = labResultHistoryRequest;&lt;/Code&gt;&lt;ReferencedAssemblies xmlns:d38p1="http://schemas.microsoft.com/2003/10/Serialization/Arrays"&gt;&lt;d38p1:string&gt;Neuron&lt;/d38p1:string&gt;&lt;d38p1:string&gt;Neuron.Pipelines&lt;/d38p1:string&gt;&lt;d38p1:string&gt;Neuron.Esb&lt;/d38p1:string&gt;&lt;d38p1:string&gt;System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d38p1:string&gt;&lt;d38p1:string&gt;System.Core, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d38p1:string&gt;&lt;d38p1:string&gt;System.Xml, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d38p1:string&gt;&lt;d38p1:string&gt;System.Xml.Linq, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d38p1:string&gt;&lt;d38p1:string&gt;System.Data, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d38p1:string&gt;&lt;d38p1:string&gt;System.Data.DataSetExtensions, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d38p1:string&gt;&lt;d38p1:string&gt;System.Runtime.Serialization, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d38p1:string&gt;&lt;d38p1:string&gt;System.ServiceModel, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d38p1:string&gt;&lt;d38p1:string&gt;Newtonsoft.Json, Version=8.0.0.0, Culture=neutral, PublicKeyToken=30ad4fe6b2a6aeed&lt;/d38p1:string&gt;&lt;d38p1:string&gt;Microsoft.CSharp, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a&lt;/d38p1:string&gt;&lt;/ReferencedAssemblies&gt;&lt;TypeName&gt;Type36d4cabbda542b29eb9d7dc9a42ba1&lt;/TypeName&gt;&lt;/ESBMessagePipelineStep&gt;&lt;ESBMessagePipelineStep i:type="d6p1:EsbMessagePipelineExecutionPipelineStep"&gt;&lt;Bindings xmlns:d38p1="http://schemas.datacontract.org/2004/07/Neuron.ComponentModel" /&gt;&lt;BreakPoint&gt;Disable&lt;/BreakPoint&gt;&lt;Disable&gt;false&lt;/Disable&gt;&lt;Id&gt;c63e677a-3699-4a5f-943e-8c8b2c5f7821&lt;/Id&gt;&lt;Name&gt;Lab Result History&lt;/Name&gt;&lt;Uniquename /&gt;&lt;d6p1:FileName i:nil="true" /&gt;&lt;d6p1:MaxInstances&gt;100&lt;/d6p1:MaxInstances&gt;&lt;d6p1:PipelineName&gt;Process_CreateUpdateLabResultHistory&lt;/d6p1:PipelineName&gt;&lt;d6p1:PoolTimeout&gt;PT1M&lt;/d6p1:PoolTimeout&gt;&lt;/ESBMessagePipelineStep&gt;&lt;ESBMessagePipelineStep i:type="d6p1:EsbMessageCSharpCodePipelineStep"&gt;&lt;Bindings xmlns:d38p1="http://schemas.datacontract.org/2004/07/Neuron.ComponentModel" /&gt;&lt;BreakPoint&gt;Disable&lt;/BreakPoint&gt;&lt;Disable&gt;false&lt;/Disable&gt;&lt;Id&gt;35096591-73f7-4b12-87d5-ddab24c45422&lt;/Id&gt;&lt;Name&gt;Map From Lab Result History&lt;/Name&gt;&lt;Uniquename /&gt;&lt;BreakPointLines xmlns:d38p1="http://schemas.microsoft.com/2003/10/Serialization/Arrays" /&gt;&lt;Code&gt;string labResultHistoryUID = context.Data.GetProperty ("NeoPLM", "LabResultHistoryUID");

context.Properties ["LabResultHistoryUID"] = labResultHistoryUID;

context.Instance.TraceInformation ("Process Lab Transaction - Transaction ID: " + context.Properties["TransactionID"] + " LabResultHistoryUID: " + context.Properties["LabResultHistoryUID"]);&lt;/Code&gt;&lt;ReferencedAssemblies xmlns:d38p1="http://schemas.microsoft.com/2003/10/Serialization/Arrays"&gt;&lt;d38p1:string&gt;Neuron&lt;/d38p1:string&gt;&lt;d38p1:string&gt;Neuron.Pipelines&lt;/d38p1:string&gt;&lt;d38p1:string&gt;Neuron.Esb&lt;/d38p1:string&gt;&lt;d38p1:string&gt;System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d38p1:string&gt;&lt;d38p1:string&gt;System.Core, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d38p1:string&gt;&lt;d38p1:string&gt;System.Xml, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d38p1:string&gt;&lt;d38p1:string&gt;System.Xml.Linq, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d38p1:string&gt;&lt;d38p1:string&gt;System.Data, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d38p1:string&gt;&lt;d38p1:string&gt;System.Data.DataSetExtensions, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d38p1:string&gt;&lt;d38p1:string&gt;System.Runtime.Serialization, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d38p1:string&gt;&lt;d38p1:string&gt;System.ServiceModel, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d38p1:string&gt;&lt;d38p1:string&gt;Newtonsoft.Json, Version=8.0.0.0, Culture=neutral, PublicKeyToken=30ad4fe6b2a6aeed&lt;/d38p1:string&gt;&lt;d38p1:string&gt;Microsoft.CSharp, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a&lt;/d38p1:string&gt;&lt;/ReferencedAssemblies&gt;&lt;TypeName&gt;Typee194c1186e6497bab9be79777d33d8&lt;/TypeName&gt;&lt;/ESBMessagePipelineStep&gt;&lt;/Children&gt;&lt;CollectionPropertyName&gt;LabResultHistories&lt;/CollectionPropertyName&gt;&lt;ItemPropertyName&gt;LabResultHistory&lt;/ItemPropertyName&gt;&lt;TurnOffTrackExecution&gt;false&lt;/TurnOffTrackExecution&gt;&lt;/ESBMessagePipelineStep&gt;&lt;/Children&gt;&lt;CollectionPropertyName&gt;LabTestHistories&lt;/CollectionPropertyName&gt;&lt;ItemPropertyName&gt;LabTestHistory&lt;/ItemPropertyName&gt;&lt;TurnOffTrackExecution&gt;false&lt;/TurnOffTrackExecution&gt;&lt;/ESBMessagePipelineStep&gt;&lt;/Children&gt;&lt;CollectionPropertyName&gt;LabSampleHistories&lt;/CollectionPropertyName&gt;&lt;ItemPropertyName&gt;LabSampleHistory&lt;/ItemPropertyName&gt;&lt;TurnOffTrackExecution&gt;false&lt;/TurnOffTrackExecution&gt;&lt;/ESBMessagePipelineStep&gt;&lt;/Children&gt;&lt;/Steps&gt;&lt;/BranchOfESBMessagexAPWb1W4&gt;&lt;BranchOfESBMessagexAPWb1W4&gt;&lt;BreakPoint&gt;Disable&lt;/BreakPoint&gt;&lt;Condition i:type="AlwaysBranchConditionOfESBMessagexAPWb1W4" /&gt;&lt;Disable&gt;false&lt;/Disable&gt;&lt;EndJoined&gt;false&lt;/EndJoined&gt;&lt;Name&gt;Else&lt;/Name&gt;&lt;Steps&gt;&lt;Bindings xmlns:d30p1="http://schemas.datacontract.org/2004/07/Neuron.ComponentModel" /&gt;&lt;BreakPoint&gt;Disable&lt;/BreakPoint&gt;&lt;Disable&gt;false&lt;/Disable&gt;&lt;Id&gt;641a60cf-0cf6-4eb3-a4a5-0f0f18e59f49&lt;/Id&gt;&lt;Name&gt;Group&lt;/Name&gt;&lt;Uniquename /&gt;&lt;Children&gt;&lt;ESBMessagePipelineStep i:type="d6p1:EsbMessageCSharpCodePipelineStep"&gt;&lt;Bindings xmlns:d32p1="http://schemas.datacontract.org/2004/07/Neuron.ComponentModel" /&gt;&lt;BreakPoint&gt;Disable&lt;/BreakPoint&gt;&lt;Disable&gt;false&lt;/Disable&gt;&lt;Id&gt;ee277357-2052-4b7d-85c6-da33f0fde496&lt;/Id&gt;&lt;Name&gt;Internal Tracing - ERP Local Service URI&lt;/Name&gt;&lt;Uniquename /&gt;&lt;BreakPointLines xmlns:d32p1="http://schemas.microsoft.com/2003/10/Serialization/Arrays" /&gt;&lt;Code&gt;context.Instance.TraceInformation ("Source System / Plant Code couldn't resolve to a valid Neo Local Service URI.");&lt;/Code&gt;&lt;ReferencedAssemblies xmlns:d32p1="http://schemas.microsoft.com/2003/10/Serialization/Arrays"&gt;&lt;d32p1:string&gt;Neuron&lt;/d32p1:string&gt;&lt;d32p1:string&gt;Neuron.Pipelines&lt;/d32p1:string&gt;&lt;d32p1:string&gt;Neuron.Esb&lt;/d32p1:string&gt;&lt;d32p1:string&gt;System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d32p1:string&gt;&lt;d32p1:string&gt;System.Core, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d32p1:string&gt;&lt;d32p1:string&gt;System.Xml, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d32p1:string&gt;&lt;d32p1:string&gt;System.Xml.Linq, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d32p1:string&gt;&lt;d32p1:string&gt;System.Data, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d32p1:string&gt;&lt;d32p1:string&gt;System.Data.DataSetExtensions, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d32p1:string&gt;&lt;d32p1:string&gt;System.Runtime.Serialization, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d32p1:string&gt;&lt;d32p1:string&gt;System.ServiceModel, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d32p1:string&gt;&lt;d32p1:string&gt;Newtonsoft.Json, Version=8.0.0.0, Culture=neutral, PublicKeyToken=30ad4fe6b2a6aeed&lt;/d32p1:string&gt;&lt;d32p1:string&gt;Microsoft.CSharp, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a&lt;/d32p1:string&gt;&lt;/ReferencedAssemblies&gt;&lt;TypeName&gt;Type8116962f77a4b0aaf7edfc5654be6c&lt;/TypeName&gt;&lt;/ESBMessagePipelineStep&gt;&lt;/Children&gt;&lt;/Steps&gt;&lt;/BranchOfESBMessagexAPWb1W4&gt;&lt;/Branches&gt;&lt;/ESBMessagePipelineStep&gt;&lt;/Children&gt;&lt;/Steps&gt;&lt;/BranchOfESBMessagexAPWb1W4&gt;&lt;BranchOfESBMessagexAPWb1W4&gt;&lt;BreakPoint&gt;Disable&lt;/BreakPoint&gt;&lt;Condition i:type="AlwaysBranchConditionOfESBMessagexAPWb1W4" /&gt;&lt;Disable&gt;false&lt;/Disable&gt;&lt;EndJoined&gt;false&lt;/EndJoined&gt;&lt;Name&gt;Else&lt;/Name&gt;&lt;Steps&gt;&lt;Bindings xmlns:d25p1="http://schemas.datacontract.org/2004/07/Neuron.ComponentModel" /&gt;&lt;BreakPoint&gt;Disable&lt;/BreakPoint&gt;&lt;Disable&gt;false&lt;/Disable&gt;&lt;Id&gt;0d8ca594-6d59-4fc9-a68a-3dcc258adbae&lt;/Id&gt;&lt;Name&gt;Group&lt;/Name&gt;&lt;Uniquename /&gt;&lt;Children&gt;&lt;ESBMessagePipelineStep i:type="d6p1:EsbMessageCSharpCodePipelineStep"&gt;&lt;Bindings xmlns:d27p1="http://schemas.datacontract.org/2004/07/Neuron.ComponentModel" /&gt;&lt;BreakPoint&gt;Disable&lt;/BreakPoint&gt;&lt;Disable&gt;false&lt;/Disable&gt;&lt;Id&gt;97ee610a-57e6-433d-81f5-82b782a795ae&lt;/Id&gt;&lt;Name&gt;Internal Tracing - ERP Local Service URI&lt;/Name&gt;&lt;Uniquename /&gt;&lt;BreakPointLines xmlns:d27p1="http://schemas.microsoft.com/2003/10/Serialization/Arrays" /&gt;&lt;Code&gt;context.Instance.TraceInformation ("Source System / Plant Code / Material ID couldn't resolve to a valid Neo Material Master.");&lt;/Code&gt;&lt;ReferencedAssemblies xmlns:d27p1="http://schemas.microsoft.com/2003/10/Serialization/Arrays"&gt;&lt;d27p1:string&gt;Neuron&lt;/d27p1:string&gt;&lt;d27p1:string&gt;Neuron.Pipelines&lt;/d27p1:string&gt;&lt;d27p1:string&gt;Neuron.Esb&lt;/d27p1:string&gt;&lt;d27p1:string&gt;System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d27p1:string&gt;&lt;d27p1:string&gt;System.Core, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d27p1:string&gt;&lt;d27p1:string&gt;System.Xml, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d27p1:string&gt;&lt;d27p1:string&gt;System.Xml.Linq, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d27p1:string&gt;&lt;d27p1:string&gt;System.Data, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d27p1:string&gt;&lt;d27p1:string&gt;System.Data.DataSetExtensions, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d27p1:string&gt;&lt;d27p1:string&gt;System.Runtime.Serialization, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d27p1:string&gt;&lt;d27p1:string&gt;System.ServiceModel, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d27p1:string&gt;&lt;d27p1:string&gt;Newtonsoft.Json, Version=8.0.0.0, Culture=neutral, PublicKeyToken=30ad4fe6b2a6aeed&lt;/d27p1:string&gt;&lt;d27p1:string&gt;Microsoft.CSharp, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a&lt;/d27p1:string&gt;&lt;/ReferencedAssemblies&gt;&lt;TypeName&gt;Type8116962f77a4b0aaf7edfc5654be6c&lt;/TypeName&gt;&lt;/ESBMessagePipelineStep&gt;&lt;/Children&gt;&lt;/Steps&gt;&lt;/BranchOfESBMessagexAPWb1W4&gt;&lt;/Branches&gt;&lt;/ESBMessagePipelineStep&gt;&lt;/Children&gt;&lt;/Steps&gt;&lt;/BranchOfESBMessagexAPWb1W4&gt;&lt;BranchOfESBMessagexAPWb1W4&gt;&lt;BreakPoint&gt;Disable&lt;/BreakPoint&gt;&lt;Condition i:type="AlwaysBranchConditionOfESBMessagexAPWb1W4" /&gt;&lt;Disable&gt;false&lt;/Disable&gt;&lt;EndJoined&gt;false&lt;/EndJoined&gt;&lt;Name&gt;Else&lt;/Name&gt;&lt;Steps&gt;&lt;Bindings xmlns:d20p1="http://schemas.datacontract.org/2004/07/Neuron.ComponentModel" /&gt;&lt;BreakPoint&gt;Disable&lt;/BreakPoint&gt;&lt;Disable&gt;false&lt;/Disable&gt;&lt;Id&gt;be4de4a4-7731-4bb4-9291-bea359a7228a&lt;/Id&gt;&lt;Name&gt;Group&lt;/Name&gt;&lt;Uniquename /&gt;&lt;Children&gt;&lt;ESBMessagePipelineStep i:type="d6p1:EsbMessageCSharpCodePipelineStep"&gt;&lt;Bindings xmlns:d22p1="http://schemas.datacontract.org/2004/07/Neuron.ComponentModel" /&gt;&lt;BreakPoint&gt;Disable&lt;/BreakPoint&gt;&lt;Disable&gt;false&lt;/Disable&gt;&lt;Id&gt;fb77bbc0-3963-47ff-bf38-f781475547fd&lt;/Id&gt;&lt;Name&gt;Internal Tracing - ERP Plant&lt;/Name&gt;&lt;Uniquename /&gt;&lt;BreakPointLines xmlns:d22p1="http://schemas.microsoft.com/2003/10/Serialization/Arrays" /&gt;&lt;Code&gt;context.Instance.TraceInformation ("Source System / Plant Code couldn't resolve to a valid Neo ERP Plant.");&lt;/Code&gt;&lt;ReferencedAssemblies xmlns:d22p1="http://schemas.microsoft.com/2003/10/Serialization/Arrays"&gt;&lt;d22p1:string&gt;Neuron&lt;/d22p1:string&gt;&lt;d22p1:string&gt;Neuron.Pipelines&lt;/d22p1:string&gt;&lt;d22p1:string&gt;Neuron.Esb&lt;/d22p1:string&gt;&lt;d22p1:string&gt;System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d22p1:string&gt;&lt;d22p1:string&gt;System.Core, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d22p1:string&gt;&lt;d22p1:string&gt;System.Xml, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d22p1:string&gt;&lt;d22p1:string&gt;System.Xml.Linq, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d22p1:string&gt;&lt;d22p1:string&gt;System.Data, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d22p1:string&gt;&lt;d22p1:string&gt;System.Data.DataSetExtensions, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d22p1:string&gt;&lt;d22p1:string&gt;System.Runtime.Serialization, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d22p1:string&gt;&lt;d22p1:string&gt;System.ServiceModel, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d22p1:string&gt;&lt;d22p1:string&gt;Newtonsoft.Json, Version=8.0.0.0, Culture=neutral, PublicKeyToken=30ad4fe6b2a6aeed&lt;/d22p1:string&gt;&lt;d22p1:string&gt;Microsoft.CSharp, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a&lt;/d22p1:string&gt;&lt;/ReferencedAssemblies&gt;&lt;TypeName&gt;Type8116962f77a4b0aaf7edfc5654be6c&lt;/TypeName&gt;&lt;/ESBMessagePipelineStep&gt;&lt;/Children&gt;&lt;/Steps&gt;&lt;/BranchOfESBMessagexAPWb1W4&gt;&lt;/Branches&gt;&lt;/ESBMessagePipelineStep&gt;&lt;/Children&gt;&lt;/Steps&gt;&lt;/BranchOfESBMessagexAPWb1W4&gt;&lt;BranchOfESBMessagexAPWb1W4&gt;&lt;BreakPoint&gt;Disable&lt;/BreakPoint&gt;&lt;Condition i:type="AlwaysBranchConditionOfESBMessagexAPWb1W4" /&gt;&lt;Disable&gt;false&lt;/Disable&gt;&lt;EndJoined&gt;false&lt;/EndJoined&gt;&lt;Name&gt;Else&lt;/Name&gt;&lt;Steps&gt;&lt;Bindings xmlns:d15p1="http://schemas.datacontract.org/2004/07/Neuron.ComponentModel" /&gt;&lt;BreakPoint&gt;Disable&lt;/BreakPoint&gt;&lt;Disable&gt;false&lt;/Disable&gt;&lt;Id&gt;a77afb0c-c45e-4a86-b855-b976a7b22890&lt;/Id&gt;&lt;Name&gt;Group&lt;/Name&gt;&lt;Uniquename /&gt;&lt;Children&gt;&lt;ESBMessagePipelineStep i:type="d6p1:EsbMessageCSharpCodePipelineStep"&gt;&lt;Bindings xmlns:d17p1="http://schemas.datacontract.org/2004/07/Neuron.ComponentModel" /&gt;&lt;BreakPoint&gt;Disable&lt;/BreakPoint&gt;&lt;Disable&gt;false&lt;/Disable&gt;&lt;Id&gt;498502a0-ccef-422f-b39f-1516bd68d8df&lt;/Id&gt;&lt;Name&gt;Internal Tracing - Facility&lt;/Name&gt;&lt;Uniquename /&gt;&lt;BreakPointLines xmlns:d17p1="http://schemas.microsoft.com/2003/10/Serialization/Arrays" /&gt;&lt;Code&gt;context.Instance.TraceInformation ("Source System / Plant Code couldn't resolve to a valid Neo Facility.");&lt;/Code&gt;&lt;ReferencedAssemblies xmlns:d17p1="http://schemas.microsoft.com/2003/10/Serialization/Arrays"&gt;&lt;d17p1:string&gt;Neuron&lt;/d17p1:string&gt;&lt;d17p1:string&gt;Neuron.Pipelines&lt;/d17p1:string&gt;&lt;d17p1:string&gt;Neuron.Esb&lt;/d17p1:string&gt;&lt;d17p1:string&gt;System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d17p1:string&gt;&lt;d17p1:string&gt;System.Core, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d17p1:string&gt;&lt;d17p1:string&gt;System.Xml, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d17p1:string&gt;&lt;d17p1:string&gt;System.Xml.Linq, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d17p1:string&gt;&lt;d17p1:string&gt;System.Data, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d17p1:string&gt;&lt;d17p1:string&gt;System.Data.DataSetExtensions, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d17p1:string&gt;&lt;d17p1:string&gt;System.Runtime.Serialization, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d17p1:string&gt;&lt;d17p1:string&gt;System.ServiceModel, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d17p1:string&gt;&lt;d17p1:string&gt;Newtonsoft.Json, Version=8.0.0.0, Culture=neutral, PublicKeyToken=30ad4fe6b2a6aeed&lt;/d17p1:string&gt;&lt;d17p1:string&gt;Microsoft.CSharp, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a&lt;/d17p1:string&gt;&lt;/ReferencedAssemblies&gt;&lt;TypeName&gt;Type8116962f77a4b0aaf7edfc5654be6c&lt;/TypeName&gt;&lt;/ESBMessagePipelineStep&gt;&lt;/Children&gt;&lt;/Steps&gt;&lt;/BranchOfESBMessagexAPWb1W4&gt;&lt;/Branches&gt;&lt;/ESBMessagePipelineStep&gt;&lt;/Children&gt;&lt;CollectionPropertyName&gt;NeoPLMLabHistories&lt;/CollectionPropertyName&gt;&lt;ItemPropertyName&gt;NeoPLMLabHistory&lt;/ItemPropertyName&gt;&lt;TurnOffTrackExecution&gt;false&lt;/TurnOffTrackExecution&gt;&lt;/ESBMessagePipelineStep&gt;&lt;/Children&gt;&lt;/OnValid&gt;&lt;Properties xmlns:d7p1="http://schemas.microsoft.com/2003/10/Serialization/Arrays" /&gt;&lt;Schemas xmlns:d7p1="http://schemas.microsoft.com/2003/10/Serialization/Arrays" /&gt;&lt;ValidationFlags&gt;ReportValidationWarnings&lt;/ValidationFlags&gt;&lt;d6p1:SchemaLocation i:nil="true" /&gt;&lt;d6p1:SchemaNames&gt;Guid;NeoPlmLimsMaterialLot&lt;/d6p1:SchemaNames&gt;&lt;/ESBMessagePipelineStep&gt;&lt;/Children&gt;&lt;/Try&gt;&lt;/ESBMessagePipelineStep&gt;&lt;ESBMessagePipelineStep i:type="CancelPipelineStepOfESBMessagexAPWb1W4"&gt;&lt;Bindings xmlns:d4p1="http://schemas.datacontract.org/2004/07/Neuron.ComponentModel" /&gt;&lt;BreakPoint&gt;Disable&lt;/BreakPoint&gt;&lt;Disable&gt;false&lt;/Disable&gt;&lt;Id&gt;2bc9d204-7a2a-469a-89bd-9eace07112e9&lt;/Id&gt;&lt;Name&gt;Cancel&lt;/Name&gt;&lt;Uniquename /&gt;&lt;/ESBMessagePipelineStep&gt;&lt;/Steps&gt;&lt;/ESBMessagePipeline&gt;</PipelineBlob>
  <IsProcessFlow>false</IsProcessFlow>
</ESBMessagePipelineStorage>