<?xml version="1.0"?>
<ESBMessagePipelineStorage xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
  <Id>72c2e216-4388-4701-9892-23d8331f82fa</Id>
  <Version>f5fb978d-63c5-447c-a428-a97f7c70fd0b</Version>
  <BusinessFlows />
  <Description />
  <Name>Enrich_ERP_MaterialLot_ORIG</Name>
  <IsSystemObject>false</IsSystemObject>
  <IsPrivate>false</IsPrivate>
  <Category>General</Category>
  <IsEncrypted>true</IsEncrypted>
  <Path>Main Processes</Path>
  <PipelineBlob>&lt;ESBMessagePipeline xmlns:i="http://www.w3.org/2001/XMLSchema-instance" xmlns="http://schemas.neuronesb.com/pipelines/"&gt;&lt;Category&gt;General&lt;/Category&gt;&lt;Description i:nil="true" /&gt;&lt;GlobalProperties xmlns:d2p1="http://schemas.microsoft.com/2003/10/Serialization/Arrays" /&gt;&lt;Name&gt;Enrich_ERP_MaterialLot_ORIG&lt;/Name&gt;&lt;Properties xmlns:d2p1="http://schemas.microsoft.com/2003/10/Serialization/Arrays" /&gt;&lt;ReferencedAssemblies xmlns:d2p1="http://schemas.microsoft.com/2003/10/Serialization/Arrays" i:nil="true" /&gt;&lt;Steps&gt;&lt;ESBMessagePipelineStep xmlns:d3p1="http://schemas.neuronesb.com/pipelines/esb/" i:type="d3p1:EsbMessageCSharpCodePipelineStep"&gt;&lt;Bindings xmlns:d4p1="http://schemas.datacontract.org/2004/07/Neuron.ComponentModel" /&gt;&lt;BreakPoint&gt;Disable&lt;/BreakPoint&gt;&lt;Disable&gt;false&lt;/Disable&gt;&lt;Id&gt;361f4353-becd-4784-942a-b80c21a5edf4&lt;/Id&gt;&lt;Name&gt;Comments&lt;/Name&gt;&lt;Uniquename&gt;cfca813c-1a6c-4e87-b332-580b8dafb9f5&lt;/Uniquename&gt;&lt;BreakPointLines xmlns:d4p1="http://schemas.microsoft.com/2003/10/Serialization/Arrays" /&gt;&lt;Code&gt;//CREATED : 2/10/2016
//AUTHOR  : Michael Figura
//VERSION : 1.0
//PURPOSE : To enrich a Neo PLM ERP Material Lot XML message with the GUID
//and unique ID values required to do inserts and updates to Material Lots,
//as well as any Material Lots they might reference.

//-----------------------------OVERVIEW------------------------------------
//This code follows a basic enrichment pattern with error handling for
//both business level exceptions (bad data), and system exceptions.

//A series of lookups are performed using input parameter values contained
//in the source input XML file. Each time a REST call is made to a backend
//system, the code will output a trace of the values used for that call, 
//as well as the values returned. This trace code only runs if the debug
//environment variable is set to "True". The Dev deployment group should
//always be set to true. It is up to the QA team to decide if it is false
//during their testing process. It is always false in production.

//When errors occur they can be of type 1 (System Error) or type 2 (Business Error)
// Type 1 errors cause the entire processing to halt and retries are performed.
// Type 2 errors cause an email to be sent, but processing on the remaining records continues

//---------------------------TRACE FORMAT----------------------------------
//The trace message will illustrate the following format:

//Input Source System ID: Europe2
//Input Plant ID: BEP7
//Enriched Facility UID: 583e37ac-a220-4871-b1af-3db62c98948b
//Enriched Plant Code UID: 481r2rac-b447-8945-c7t5-4ghr22787yg4
//Input Material ID: 12345
//Enriched Material Master UID: b25ff6da-253c-40f9-b0ab-09524b1dae78

//..and so on until the end of the process.

//Tracing will occur for any and all exceptions, whether they be business
//or system level. You may also reference the NeoErrors database for a 
//quick glance at results, rather than sifting through the entire trace
//log. But the Error DB only populates if Debug is set to True.

context.Properties.Add ("PipelineException", "");&lt;/Code&gt;&lt;ReferencedAssemblies xmlns:d4p1="http://schemas.microsoft.com/2003/10/Serialization/Arrays"&gt;&lt;d4p1:string&gt;Neuron&lt;/d4p1:string&gt;&lt;d4p1:string&gt;Neuron.Pipelines&lt;/d4p1:string&gt;&lt;d4p1:string&gt;Neuron.Esb&lt;/d4p1:string&gt;&lt;d4p1:string&gt;System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d4p1:string&gt;&lt;d4p1:string&gt;System.Core, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d4p1:string&gt;&lt;d4p1:string&gt;System.Xml, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d4p1:string&gt;&lt;d4p1:string&gt;System.Xml.Linq, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d4p1:string&gt;&lt;d4p1:string&gt;System.Data, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d4p1:string&gt;&lt;d4p1:string&gt;System.Data.DataSetExtensions, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d4p1:string&gt;&lt;d4p1:string&gt;System.Runtime.Serialization, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d4p1:string&gt;&lt;d4p1:string&gt;System.ServiceModel, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d4p1:string&gt;&lt;/ReferencedAssemblies&gt;&lt;TypeName&gt;Type9eff8e6442b4ab7aeebe70c8a7a794&lt;/TypeName&gt;&lt;/ESBMessagePipelineStep&gt;&lt;ESBMessagePipelineStep xmlns:d3p1="http://schemas.neuronesb.com/pipelines/esb/" i:type="d3p1:EsbMessageCSharpCodePipelineStep"&gt;&lt;Bindings xmlns:d4p1="http://schemas.datacontract.org/2004/07/Neuron.ComponentModel" /&gt;&lt;BreakPoint&gt;Disable&lt;/BreakPoint&gt;&lt;Disable&gt;false&lt;/Disable&gt;&lt;Id&gt;dfb83f5a-339a-457b-880e-cece7913fcd3&lt;/Id&gt;&lt;Name&gt;Check for Retry&lt;/Name&gt;&lt;Uniquename /&gt;&lt;BreakPointLines xmlns:d4p1="http://schemas.microsoft.com/2003/10/Serialization/Arrays" /&gt;&lt;Code&gt;//Check for retry. If it is a retry, sleep for 30 seconds
if (context.State.ContainsKey("RetryMessageID"))
{
        if (context.Data.Header.MessageId == (string)context.State["RetryMessageID"])
        {
               System.Threading.Thread.Sleep(30000);
        }
        else
        {
               context.State["RetryMessageID"] = context.Data.Header.MessageId;
        }
}
else
{
        context.State.Add("RetryMessageID", context.Data.Header.MessageId);
}
&lt;/Code&gt;&lt;ReferencedAssemblies xmlns:d4p1="http://schemas.microsoft.com/2003/10/Serialization/Arrays"&gt;&lt;d4p1:string&gt;Neuron&lt;/d4p1:string&gt;&lt;d4p1:string&gt;Neuron.Pipelines&lt;/d4p1:string&gt;&lt;d4p1:string&gt;Neuron.Esb&lt;/d4p1:string&gt;&lt;d4p1:string&gt;System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d4p1:string&gt;&lt;d4p1:string&gt;System.Core, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d4p1:string&gt;&lt;d4p1:string&gt;System.Xml, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d4p1:string&gt;&lt;d4p1:string&gt;System.Xml.Linq, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d4p1:string&gt;&lt;d4p1:string&gt;System.Data, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d4p1:string&gt;&lt;d4p1:string&gt;System.Data.DataSetExtensions, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d4p1:string&gt;&lt;d4p1:string&gt;System.Runtime.Serialization, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d4p1:string&gt;&lt;d4p1:string&gt;System.ServiceModel, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d4p1:string&gt;&lt;/ReferencedAssemblies&gt;&lt;TypeName&gt;Typed8bece0294d4e8999bd5fa3c6a733e&lt;/TypeName&gt;&lt;/ESBMessagePipelineStep&gt;&lt;ESBMessagePipelineStep xmlns:d3p1="http://schemas.neuronesb.com/pipelines/esb/" i:type="d3p1:EsbMessageCSharpCodePipelineStep"&gt;&lt;Bindings xmlns:d4p1="http://schemas.datacontract.org/2004/07/Neuron.ComponentModel" /&gt;&lt;BreakPoint&gt;Disable&lt;/BreakPoint&gt;&lt;Disable&gt;false&lt;/Disable&gt;&lt;Id&gt;355af3ed-c96a-4622-88e2-ae36978873ed&lt;/Id&gt;&lt;Name&gt;Define Global Variables&lt;/Name&gt;&lt;Uniquename /&gt;&lt;BreakPointLines xmlns:d4p1="http://schemas.microsoft.com/2003/10/Serialization/Arrays" /&gt;&lt;Code&gt;//Save original message in case we need it later
context.Properties.Add ("OrigMsg", context.Data.Clone(true));

//Init and load transaction values
context.Properties.Add ("ProcessTitle", "ERP Material Lot Enrichment");
context.Properties.Add ("OriginalMessageID", context.Data.Header.MessageId);

context.Properties.Add ("SoapAction", "");

// Create Message Header Properties

context.Properties.Add ("SourceSystemID", "");
context.Properties.Add ("TransactionID", "");
context.Properties.Add ("MaterialLots", "");

// Create Message Header Lookup Properties

// Create Message Body Properties
context.Properties.Add ("PlantID", "");
context.Properties.Add ("MaterialID", "");
context.Properties.Add ("MaterialLotID", "");
context.Properties.Add ("StatusID", "");
context.Properties.Add ("StatusDescription", "");
context.Properties.Add ("EngineeringUnitID", "");
context.Properties.Add ("Potency", "");
context.Properties.Add ("SupplierID", "");
context.Properties.Add ("SupplierName", "");
context.Properties.Add ("SupplierLotID", "");
context.Properties.Add ("LastUpdateDateTime", "");
context.Properties.Add ("ReferencedLots", "");

// Create Message Body Lookup Properties

context.Properties.Add ("FacilityUID", "");
context.Properties.Add ("PlantCodeUID", "");
context.Properties.Add ("MaterialMasterUID", "");
context.Properties.Add ("NeoMaterialType", "");
context.Properties.Add ("MaterialLotUID", "");
context.Properties.Add ("StatusUID", "");
context.Properties.Add ("EngineeringUnitUID", "");
context.Properties.Add ("LocalServiceURI", "");

// Create Reference Lot Properties

context.Properties.Add ("ReferencedLotSourceSystemID", "");
context.Properties.Add ("ReferencedLotPlantID", "");
context.Properties.Add ("ReferencedLotMaterialID", "");
context.Properties.Add ("ReferencedLotMaterialLotID", "");

// Create Reference Lot Lookup Properties

context.Properties.Add ("ReferencedLotFacilityUID", "");
context.Properties.Add ("ReferencedLotPlantCodeUID", "");
context.Properties.Add ("ReferencedLotMaterialUID", "");
context.Properties.Add ("ReferencedLotNeoMaterialType", "");
context.Properties.Add ("ReferencedLotMaterialLotUID", "");
context.Properties.Add ("ReferencedLotLocalServiceURI", "");
context.Properties.Add ("ReferencedLotMaterialLotAncestorUID", "");
&lt;/Code&gt;&lt;ReferencedAssemblies xmlns:d4p1="http://schemas.microsoft.com/2003/10/Serialization/Arrays"&gt;&lt;d4p1:string&gt;Neuron&lt;/d4p1:string&gt;&lt;d4p1:string&gt;Neuron.Pipelines&lt;/d4p1:string&gt;&lt;d4p1:string&gt;Neuron.Esb&lt;/d4p1:string&gt;&lt;d4p1:string&gt;System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d4p1:string&gt;&lt;d4p1:string&gt;System.Core, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d4p1:string&gt;&lt;d4p1:string&gt;System.Xml, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d4p1:string&gt;&lt;d4p1:string&gt;System.Xml.Linq, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d4p1:string&gt;&lt;d4p1:string&gt;System.Data, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d4p1:string&gt;&lt;d4p1:string&gt;System.Data.DataSetExtensions, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d4p1:string&gt;&lt;d4p1:string&gt;System.Runtime.Serialization, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d4p1:string&gt;&lt;d4p1:string&gt;System.ServiceModel, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d4p1:string&gt;&lt;d4p1:string&gt;Newtonsoft.Json, Version=8.0.0.0, Culture=neutral, PublicKeyToken=30ad4fe6b2a6aeed&lt;/d4p1:string&gt;&lt;d4p1:string&gt;Microsoft.CSharp, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a&lt;/d4p1:string&gt;&lt;/ReferencedAssemblies&gt;&lt;TypeName&gt;Typecddaa3b18514a60aed21b6bec94448&lt;/TypeName&gt;&lt;/ESBMessagePipelineStep&gt;&lt;ESBMessagePipelineStep xmlns:d3p1="http://schemas.neuronesb.com/pipelines/esb/" i:type="d3p1:EsbMessageSchemaValidationPipelineStep"&gt;&lt;Bindings xmlns:d4p1="http://schemas.datacontract.org/2004/07/Neuron.ComponentModel" /&gt;&lt;BreakPoint&gt;Disable&lt;/BreakPoint&gt;&lt;Disable&gt;false&lt;/Disable&gt;&lt;Id&gt;46864f74-e850-4ce7-b705-9fd5f9ac8873&lt;/Id&gt;&lt;Name&gt;Validate Schema&lt;/Name&gt;&lt;Uniquename /&gt;&lt;OnInvalid&gt;&lt;Bindings xmlns:d5p1="http://schemas.datacontract.org/2004/07/Neuron.ComponentModel" /&gt;&lt;BreakPoint&gt;Disable&lt;/BreakPoint&gt;&lt;Disable&gt;false&lt;/Disable&gt;&lt;Id&gt;bfaf5984-4ef5-4e30-992f-3de20c2951c1&lt;/Id&gt;&lt;Name&gt;Group&lt;/Name&gt;&lt;Uniquename /&gt;&lt;Children&gt;&lt;ESBMessagePipelineStep i:type="d3p1:EsbMessageCSharpCodePipelineStep"&gt;&lt;Bindings xmlns:d7p1="http://schemas.datacontract.org/2004/07/Neuron.ComponentModel" /&gt;&lt;BreakPoint&gt;Disable&lt;/BreakPoint&gt;&lt;Disable&gt;false&lt;/Disable&gt;&lt;Id&gt;4bb15bca-0a32-4877-894d-31293454eedf&lt;/Id&gt;&lt;Name&gt;Trace the Available Information on the Exception&lt;/Name&gt;&lt;Uniquename /&gt;&lt;BreakPointLines xmlns:d7p1="http://schemas.microsoft.com/2003/10/Serialization/Arrays" /&gt;&lt;Code&gt;//get the current exception
Exception ex = (Exception)context.Properties["CurrentException"];

string msg = "Validation Exception: ";
if(ex.InnerException != null)
{
	msg += ex.InnerException.Message;
}
else
{
	msg += ex.Message;
}

//trace to designer window
context.Instance.TraceError(msg);&lt;/Code&gt;&lt;ReferencedAssemblies xmlns:d7p1="http://schemas.microsoft.com/2003/10/Serialization/Arrays"&gt;&lt;d7p1:string&gt;Neuron&lt;/d7p1:string&gt;&lt;d7p1:string&gt;Neuron.Pipelines&lt;/d7p1:string&gt;&lt;d7p1:string&gt;Neuron.Esb&lt;/d7p1:string&gt;&lt;d7p1:string&gt;System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d7p1:string&gt;&lt;d7p1:string&gt;System.Core, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d7p1:string&gt;&lt;d7p1:string&gt;System.Xml, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d7p1:string&gt;&lt;d7p1:string&gt;System.Xml.Linq, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d7p1:string&gt;&lt;d7p1:string&gt;System.Data, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d7p1:string&gt;&lt;d7p1:string&gt;System.Data.DataSetExtensions, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d7p1:string&gt;&lt;d7p1:string&gt;System.Runtime.Serialization, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d7p1:string&gt;&lt;d7p1:string&gt;System.ServiceModel, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d7p1:string&gt;&lt;d7p1:string&gt;Newtonsoft.Json, Version=8.0.0.0, Culture=neutral, PublicKeyToken=30ad4fe6b2a6aeed&lt;/d7p1:string&gt;&lt;d7p1:string&gt;Microsoft.CSharp, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a&lt;/d7p1:string&gt;&lt;/ReferencedAssemblies&gt;&lt;TypeName&gt;Type704279b027f4124a01e147e3dd82da&lt;/TypeName&gt;&lt;/ESBMessagePipelineStep&gt;&lt;ESBMessagePipelineStep i:type="d3p1:EsbMessageCSharpCodePipelineStep"&gt;&lt;Bindings xmlns:d7p1="http://schemas.datacontract.org/2004/07/Neuron.ComponentModel" /&gt;&lt;BreakPoint&gt;Disable&lt;/BreakPoint&gt;&lt;Disable&gt;false&lt;/Disable&gt;&lt;Id&gt;cab4e82d-4932-4bf2-a314-a634167016ba&lt;/Id&gt;&lt;Name&gt;Create Invalid Schema Error&lt;/Name&gt;&lt;Uniquename /&gt;&lt;BreakPointLines xmlns:d7p1="http://schemas.microsoft.com/2003/10/Serialization/Arrays" /&gt;&lt;Code&gt;//get the current exception
Exception ex = (Exception)context.Properties["CurrentException"];

string msg = "Validation Exception: ";
if(ex.InnerException != null)
{
	msg += ex.InnerException.Message;
}
else
{
	msg += ex.Message;
}

//trace to designer window
context.Instance.TraceError(msg);

string errorMessage = System.Net.WebUtility.HtmlEncode (msg);

// Get the data together to send the Business Error Message
string endpointAddress = context.Data.Header.To;
string eSBAction = context.Data.Header.Action;
string eSBTopic = context.Data.Header.Topic;
string sourceSystemID = ""; 
string plantID = "";
string transactionID = context.Properties["OriginalMessageID"].ToString();
string messageDate = context.Data.Header.Created.ToString("yyyy-MM-ddTHH:mm:ssZ");
string errorCode = "1000";
string originalMessage = System.Net.WebUtility.HtmlEncode (context.Properties ["OrigMsg"].ToString());

// Get the business error template
string errorTemplate = context.Configuration.XmlDocs["ESB Invalid Schema Error Message"].Xml;

string eSBErrorMessage = string.Format(errorTemplate, endpointAddress, eSBAction, eSBTopic, sourceSystemID, plantID, transactionID, messageDate, errorCode, errorMessage, originalMessage);

context.Instance.TraceInformation ("System Error: " + eSBErrorMessage);

context.Data.Text = eSBErrorMessage;
&lt;/Code&gt;&lt;ReferencedAssemblies xmlns:d7p1="http://schemas.microsoft.com/2003/10/Serialization/Arrays"&gt;&lt;d7p1:string&gt;Neuron&lt;/d7p1:string&gt;&lt;d7p1:string&gt;Neuron.Pipelines&lt;/d7p1:string&gt;&lt;d7p1:string&gt;Neuron.Esb&lt;/d7p1:string&gt;&lt;d7p1:string&gt;System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d7p1:string&gt;&lt;d7p1:string&gt;System.Core, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d7p1:string&gt;&lt;d7p1:string&gt;System.Xml, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d7p1:string&gt;&lt;d7p1:string&gt;System.Xml.Linq, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d7p1:string&gt;&lt;d7p1:string&gt;System.Data, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d7p1:string&gt;&lt;d7p1:string&gt;System.Data.DataSetExtensions, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d7p1:string&gt;&lt;d7p1:string&gt;System.Runtime.Serialization, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d7p1:string&gt;&lt;d7p1:string&gt;System.ServiceModel, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d7p1:string&gt;&lt;d7p1:string&gt;Newtonsoft.Json, Version=8.0.0.0, Culture=neutral, PublicKeyToken=30ad4fe6b2a6aeed&lt;/d7p1:string&gt;&lt;d7p1:string&gt;Microsoft.CSharp, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a&lt;/d7p1:string&gt;&lt;/ReferencedAssemblies&gt;&lt;TypeName&gt;Type11624a5a2154ce58811e380fbf8048&lt;/TypeName&gt;&lt;/ESBMessagePipelineStep&gt;&lt;ESBMessagePipelineStep i:type="d3p1:EsbMessagePublishPipelineStep"&gt;&lt;Bindings xmlns:d7p1="http://schemas.datacontract.org/2004/07/Neuron.ComponentModel" /&gt;&lt;BreakPoint&gt;Disable&lt;/BreakPoint&gt;&lt;Disable&gt;false&lt;/Disable&gt;&lt;Id&gt;b1845fbc-2b43-4644-b206-8bae693ea244&lt;/Id&gt;&lt;Name&gt;Publish&lt;/Name&gt;&lt;Uniquename /&gt;&lt;d3p1:Semantic&gt;Multicast&lt;/d3p1:Semantic&gt;&lt;d3p1:Timeout&gt;0&lt;/d3p1:Timeout&gt;&lt;d3p1:TopicSelector i:type="d3p1:ESBMessageConstTopicSelector"&gt;&lt;d3p1:Topic&gt;ESBError&lt;/d3p1:Topic&gt;&lt;/d3p1:TopicSelector&gt;&lt;/ESBMessagePipelineStep&gt;&lt;ESBMessagePipelineStep i:type="CancelPipelineStepOfESBMessagexAPWb1W4"&gt;&lt;Bindings xmlns:d7p1="http://schemas.datacontract.org/2004/07/Neuron.ComponentModel" /&gt;&lt;BreakPoint&gt;Disable&lt;/BreakPoint&gt;&lt;Disable&gt;false&lt;/Disable&gt;&lt;Id&gt;33a81977-2157-494d-8553-fc0d8e7ec7b6&lt;/Id&gt;&lt;Name&gt;Cancel&lt;/Name&gt;&lt;Uniquename /&gt;&lt;/ESBMessagePipelineStep&gt;&lt;/Children&gt;&lt;/OnInvalid&gt;&lt;OnValid&gt;&lt;Bindings xmlns:d5p1="http://schemas.datacontract.org/2004/07/Neuron.ComponentModel" /&gt;&lt;BreakPoint&gt;Disable&lt;/BreakPoint&gt;&lt;Disable&gt;false&lt;/Disable&gt;&lt;Id&gt;09db1569-9229-48d5-b4bb-b70f83a535c5&lt;/Id&gt;&lt;Name&gt;Group&lt;/Name&gt;&lt;Uniquename /&gt;&lt;Children&gt;&lt;ESBMessagePipelineStep i:type="ExceptionPipelineStepOfESBMessagexAPWb1W4"&gt;&lt;Bindings xmlns:d7p1="http://schemas.datacontract.org/2004/07/Neuron.ComponentModel" /&gt;&lt;BreakPoint&gt;Disable&lt;/BreakPoint&gt;&lt;Disable&gt;false&lt;/Disable&gt;&lt;Id&gt;d8b00917-1c17-4137-9d9d-645c38a01963&lt;/Id&gt;&lt;Name&gt;Exception&lt;/Name&gt;&lt;Uniquename /&gt;&lt;Catch&gt;&lt;Bindings xmlns:d8p1="http://schemas.datacontract.org/2004/07/Neuron.ComponentModel" /&gt;&lt;BreakPoint&gt;Disable&lt;/BreakPoint&gt;&lt;Disable&gt;false&lt;/Disable&gt;&lt;Id&gt;57f42abc-c8d8-411b-b2ac-3c8ab54bdcec&lt;/Id&gt;&lt;Name&gt;Group&lt;/Name&gt;&lt;Uniquename /&gt;&lt;Children&gt;&lt;ESBMessagePipelineStep i:type="d3p1:EsbMessagePipelineExecutionPipelineStep"&gt;&lt;Bindings xmlns:d10p1="http://schemas.datacontract.org/2004/07/Neuron.ComponentModel" /&gt;&lt;BreakPoint&gt;Disable&lt;/BreakPoint&gt;&lt;Disable&gt;false&lt;/Disable&gt;&lt;Id&gt;3dfa9342-b72c-42e6-8091-ad8dc015ad4b&lt;/Id&gt;&lt;Name&gt;Exception Handler&lt;/Name&gt;&lt;Uniquename /&gt;&lt;d3p1:FileName i:nil="true" /&gt;&lt;d3p1:MaxInstances&gt;100&lt;/d3p1:MaxInstances&gt;&lt;d3p1:PipelineName&gt;Exception Handler&lt;/d3p1:PipelineName&gt;&lt;d3p1:PoolTimeout&gt;PT1M&lt;/d3p1:PoolTimeout&gt;&lt;/ESBMessagePipelineStep&gt;&lt;/Children&gt;&lt;/Catch&gt;&lt;Finally&gt;&lt;Bindings xmlns:d8p1="http://schemas.datacontract.org/2004/07/Neuron.ComponentModel" /&gt;&lt;BreakPoint&gt;Disable&lt;/BreakPoint&gt;&lt;Disable&gt;false&lt;/Disable&gt;&lt;Id&gt;5adcd623-871a-4cdb-83b2-b499329b391f&lt;/Id&gt;&lt;Name&gt;Group&lt;/Name&gt;&lt;Uniquename /&gt;&lt;Children /&gt;&lt;/Finally&gt;&lt;Try&gt;&lt;Bindings xmlns:d8p1="http://schemas.datacontract.org/2004/07/Neuron.ComponentModel" /&gt;&lt;BreakPoint&gt;Disable&lt;/BreakPoint&gt;&lt;Disable&gt;false&lt;/Disable&gt;&lt;Id&gt;6bad0ad6-b71b-466d-94ff-cb5868f43821&lt;/Id&gt;&lt;Name&gt;Group&lt;/Name&gt;&lt;Uniquename /&gt;&lt;Children&gt;&lt;ESBMessagePipelineStep i:type="d3p1:EsbMessageCSharpCodePipelineStep"&gt;&lt;Bindings xmlns:d10p1="http://schemas.datacontract.org/2004/07/Neuron.ComponentModel" /&gt;&lt;BreakPoint&gt;Disable&lt;/BreakPoint&gt;&lt;Disable&gt;false&lt;/Disable&gt;&lt;Id&gt;a229761f-1ae1-4930-b1c8-1d7106a9e01b&lt;/Id&gt;&lt;Name&gt;Read Message Header Variables&lt;/Name&gt;&lt;Uniquename&gt;0b4e561f-1671-4a2f-985a-be75a8f0f140&lt;/Uniquename&gt;&lt;BreakPointLines xmlns:d10p1="http://schemas.microsoft.com/2003/10/Serialization/Arrays" /&gt;&lt;Code&gt;if(context.Data.Header.Action.Length &amp;gt; 0)
	{ context.Properties["SoapAction"] = context.Data.Header.Action; }

// Load the material lots nodelist for looping through
var materialLots = context.Data.ToXmlDocument().SelectNodes("/*[local-name()='NeoPlmErpMaterialLot' and namespace-uri()='http://NeoPLM.ERP.MaterialLot']/*[local-name()='MaterialLots' and namespace-uri()='']/*[local-name()='MaterialLot' and namespace-uri()='']");
context.Properties ["MaterialLots"] = materialLots;

// Source System ID 
var sourceSystemId = context.Data.ToXmlDocument().SelectSingleNode("/*[local-name()='NeoPlmErpMaterialLot' and namespace-uri()='http://NeoPLM.ERP.MaterialLot']/*[local-name()='SourceSystemID' and namespace-uri()='']").InnerText;
context.Properties ["SourceSystemID"] = sourceSystemId;
	
// Transaction ID
var transactionID = context.Data.ToXmlDocument().SelectSingleNode("/*[local-name()='NeoPlmErpMaterialLot' and namespace-uri()='http://NeoPLM.ERP.MaterialLot']/*[local-name()='TransactionID' and namespace-uri()='']").InnerText;
context.Properties ["TransactionID"] = transactionID;

// Begin tracing
context.Instance.TraceInformation("Process Material Lot Transaction ID: " + context.Properties["TransactionID"] + "Material Lots Count: " + materialLots.Count.ToString());
&lt;/Code&gt;&lt;ReferencedAssemblies xmlns:d10p1="http://schemas.microsoft.com/2003/10/Serialization/Arrays"&gt;&lt;d10p1:string&gt;Neuron&lt;/d10p1:string&gt;&lt;d10p1:string&gt;Neuron.Pipelines&lt;/d10p1:string&gt;&lt;d10p1:string&gt;Neuron.Esb&lt;/d10p1:string&gt;&lt;d10p1:string&gt;System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d10p1:string&gt;&lt;d10p1:string&gt;System.Core, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d10p1:string&gt;&lt;d10p1:string&gt;System.Xml, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d10p1:string&gt;&lt;d10p1:string&gt;System.Xml.Linq, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d10p1:string&gt;&lt;d10p1:string&gt;System.Data, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d10p1:string&gt;&lt;d10p1:string&gt;System.Data.DataSetExtensions, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d10p1:string&gt;&lt;d10p1:string&gt;System.Runtime.Serialization, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d10p1:string&gt;&lt;d10p1:string&gt;System.ServiceModel, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d10p1:string&gt;&lt;/ReferencedAssemblies&gt;&lt;TypeName&gt;Type6f01709dad2402bb4b6571118ee560&lt;/TypeName&gt;&lt;/ESBMessagePipelineStep&gt;&lt;ESBMessagePipelineStep i:type="ForEachPipelineStepOfESBMessagexAPWb1W4"&gt;&lt;Bindings xmlns:d10p1="http://schemas.datacontract.org/2004/07/Neuron.ComponentModel" /&gt;&lt;BreakPoint&gt;Disable&lt;/BreakPoint&gt;&lt;Disable&gt;false&lt;/Disable&gt;&lt;Id&gt;e42e5f9a-d35e-48a6-9878-87fe12c36059&lt;/Id&gt;&lt;Name&gt;Loop Through Material Lots&lt;/Name&gt;&lt;Uniquename&gt;3495cdf6-f026-4c42-99de-ca5f79f1f9de&lt;/Uniquename&gt;&lt;Children&gt;&lt;ESBMessagePipelineStep i:type="d3p1:EsbMessageCSharpCodePipelineStep"&gt;&lt;Bindings xmlns:d12p1="http://schemas.datacontract.org/2004/07/Neuron.ComponentModel" /&gt;&lt;BreakPoint&gt;Disable&lt;/BreakPoint&gt;&lt;Disable&gt;false&lt;/Disable&gt;&lt;Id&gt;f3299b25-2d89-4fc5-92c4-a413c2b40c52&lt;/Id&gt;&lt;Name&gt;Read Message Body&lt;/Name&gt;&lt;Uniquename&gt;9b20866d-009c-401f-97fc-b0686580dc7d&lt;/Uniquename&gt;&lt;BreakPointLines xmlns:d12p1="http://schemas.microsoft.com/2003/10/Serialization/Arrays" /&gt;&lt;Code&gt;// Initialize the Transaction Properties to empty values

context.Properties ["PlantID"] = "";
context.Properties ["MaterialID"] = "";
context.Properties ["MaterialLotID"] = "";
context.Properties ["StatusID"] = "";
context.Properties ["StatusDescription"] = "";
context.Properties ["EngineeringUnitID"] = "";
context.Properties ["Potency"] = "";
context.Properties ["SupplierID"] = "";
context.Properties ["SupplierName"] = "";
context.Properties ["SupplierLotID"] = "";
context.Properties ["LastUpdateDateTime"] = "";
context.Properties ["ReferencedLots"] = "";

context.Properties ["FacilityUID"] = "";
context.Properties ["PlantCodeUID"] = "";
context.Properties ["MaterialMasterUID"] = "";
context.Properties ["MaterialLotUID"] = "";
context.Properties ["StatusUID"] = "";
context.Properties ["EngineeringUnitUID"] = "";

//Load the Material Lot
var materialLot = (System.Xml.XmlNode)context.Properties["MaterialLot"];

// Plant ID
foreach(System.Xml.XmlNode node in materialLot.ChildNodes) { if(node.Name == "PlantID") { context.Properties["PlantID"] = node.InnerText; break; } }


//Material ID
foreach(System.Xml.XmlNode node in materialLot.ChildNodes) { if (node.Name == "MaterialID") { context.Properties["MaterialID"] = node.InnerText; break; } }


//Material Lot ID
foreach(System.Xml.XmlNode node in materialLot.ChildNodes) { if(node.Name == "MaterialLotID") { context.Properties["MaterialLotID"] = node.InnerText; break; } }

//Status ID
foreach(System.Xml.XmlNode node in materialLot.ChildNodes) { if(node.Name == "StatusCode") { context.Properties["StatusID"] = node.InnerText; break; } }

//Status Description
foreach(System.Xml.XmlNode node in materialLot.ChildNodes) { if(node.Name == "StatusDescription") { context.Properties["StatusDescription"] = node.InnerText; break; } }

//Engineering Unit ID
foreach(System.Xml.XmlNode node in materialLot.ChildNodes) { if(node.Name == "PotencyUOM") { context.Properties["EngineeringUnitID"] = node.InnerText; break; } }

//Potency
foreach(System.Xml.XmlNode node in materialLot.ChildNodes) { if (node.Name == "Potency") {context.Properties["Potency"] = node.InnerText; break; } }

// Supplier ID
foreach(System.Xml.XmlNode node in materialLot.ChildNodes) { if(node.Name == "SupplierID") { context.Properties["SupplierID"] = node.InnerText; break;  } }

// Supplier Name
foreach(System.Xml.XmlNode node in materialLot.ChildNodes) { if(node.Name == "SupplierName") { context.Properties["SupplierName"] = node.InnerText; break;  } }

// Supplier Lot ID
foreach(System.Xml.XmlNode node in materialLot.ChildNodes) { if(node.Name == "SupplierLotID") { context.Properties["SupplierLotID"] = node.InnerText; break;  } }

// Last Updated Date Time
foreach(System.Xml.XmlNode node in materialLot.ChildNodes) { if (node.Name == "LastUpdateDateTime") { context.Properties["LastUpdateDateTime"] = node.InnerText; break;  } }

// Referenced Lots
foreach(System.Xml.XmlNode xNode in materialLot.ChildNodes) { if(xNode.Name == "ReferencedLots") { context.Properties["ReferencedLots"] = xNode; break; } }

//********************************Business Rule!! - Potency and Engineering Unit
if(context.Properties["Potency"].ToString().Length == 0 &amp;amp;&amp;amp; context.Properties["EngineeringUnitID"].ToString().Length == 0)
{
	context.Properties["Potency"] = "100";
	context.Properties["EngineeringUnitID"] = "P1";

}
else if (context.Properties["Potency"].ToString().Length == 0 &amp;amp;&amp;amp; context.Properties["EngineeringUnitID"].ToString().Length != 0)
{
	context.Properties["Potency"] = "100";	
}
else if (context.Properties["Potency"].ToString().Length != 0 &amp;amp;&amp;amp; context.Properties["EngineeringUnitID"].ToString().Length == 0)
	context.Properties["EngineeringUnitID"] = "P1";
&lt;/Code&gt;&lt;ReferencedAssemblies xmlns:d12p1="http://schemas.microsoft.com/2003/10/Serialization/Arrays"&gt;&lt;d12p1:string&gt;Neuron&lt;/d12p1:string&gt;&lt;d12p1:string&gt;Neuron.Pipelines&lt;/d12p1:string&gt;&lt;d12p1:string&gt;Neuron.Esb&lt;/d12p1:string&gt;&lt;d12p1:string&gt;System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d12p1:string&gt;&lt;d12p1:string&gt;System.Core, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d12p1:string&gt;&lt;d12p1:string&gt;System.Xml, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d12p1:string&gt;&lt;d12p1:string&gt;System.Xml.Linq, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d12p1:string&gt;&lt;d12p1:string&gt;System.Data, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d12p1:string&gt;&lt;d12p1:string&gt;System.Data.DataSetExtensions, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d12p1:string&gt;&lt;d12p1:string&gt;System.Runtime.Serialization, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d12p1:string&gt;&lt;d12p1:string&gt;System.ServiceModel, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d12p1:string&gt;&lt;/ReferencedAssemblies&gt;&lt;TypeName&gt;Type71a31839f0e4065a27b5fedb808af3&lt;/TypeName&gt;&lt;/ESBMessagePipelineStep&gt;&lt;ESBMessagePipelineStep i:type="d3p1:EsbMessageCSharpCodePipelineStep"&gt;&lt;Bindings xmlns:d12p1="http://schemas.datacontract.org/2004/07/Neuron.ComponentModel" /&gt;&lt;BreakPoint&gt;Disable&lt;/BreakPoint&gt;&lt;Disable&gt;false&lt;/Disable&gt;&lt;Id&gt;97242fd3-e800-486a-9b0b-244680d393b5&lt;/Id&gt;&lt;Name&gt;Trace Transaction Values&lt;/Name&gt;&lt;Uniquename /&gt;&lt;BreakPointLines xmlns:d12p1="http://schemas.microsoft.com/2003/10/Serialization/Arrays" /&gt;&lt;Code&gt;context.Instance.TraceInformation ("Process Material Lot - Transaction ID: " + context.Properties["TransactionID"] +  " Plant ID: " + context.Properties["PlantID"]);
context.Instance.TraceInformation ("Process Material Lot - Transaction ID: " + context.Properties["TransactionID"] +  " Material ID: " + context.Properties["MaterialID"]);
context.Instance.TraceInformation ("Process Material Lot - Transaction ID: " + context.Properties["TransactionID"] +  " Material Lot ID: " + context.Properties["MaterialLotID"]);
context.Instance.TraceInformation ("Process Material Lot - Transaction ID: " + context.Properties["TransactionID"] +  " Status ID: " + context.Properties["StatusID"]);
context.Instance.TraceInformation ("Process Material Lot - Transaction ID: " + context.Properties["TransactionID"] +  " Status Description: " + context.Properties["StatusDescription"]);
context.Instance.TraceInformation ("Process Material Lot - Transaction ID: " + context.Properties["TransactionID"] +  " Potency UOM: " + context.Properties["EngineeringUnitID"]);
context.Instance.TraceInformation ("Process Material Lot - Transaction ID: " + context.Properties["TransactionID"] +  " Potency: " + context.Properties["Potency"]);
context.Instance.TraceInformation ("Process Material Lot - Transaction ID: " + context.Properties["TransactionID"] +  " SupplierID: " + context.Properties["SupplierID"]);
context.Instance.TraceInformation ("Process Material Lot - Transaction ID: " + context.Properties["TransactionID"] +  " SupplierName: " + context.Properties["SupplierName"]);
context.Instance.TraceInformation ("Process Material Lot - Transaction ID: " + context.Properties["TransactionID"] +  " LastUpdateDateTime: " + context.Properties["LastUpdateDateTime"]);

if (context.Properties["ReferencedLots"].ToString() != "")
{
	System.Xml.XmlNode referencedLots = (System.Xml.XmlNode) context.Properties["ReferencedLots"];

	context.Instance.TraceInformation ("Process Material Lot - Transaction ID: " + context.Properties["TransactionID"] +  " Referenced Lots: " + referencedLots.OuterXml.ToString());
	context.Instance.TraceInformation ("Process Material Lot - Transaction ID: " + context.Properties["TransactionID"] +  " Referenced Lots Count: " + referencedLots.ChildNodes.Count);
}
else
{
	context.Instance.TraceInformation ("Process Material LotProcess Material Lot - Transaction ID: " + context.Properties["TransactionID"] + " There are no Referenced Lot on this transaction.");
}&lt;/Code&gt;&lt;ReferencedAssemblies xmlns:d12p1="http://schemas.microsoft.com/2003/10/Serialization/Arrays"&gt;&lt;d12p1:string&gt;Neuron&lt;/d12p1:string&gt;&lt;d12p1:string&gt;Neuron.Pipelines&lt;/d12p1:string&gt;&lt;d12p1:string&gt;Neuron.Esb&lt;/d12p1:string&gt;&lt;d12p1:string&gt;System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d12p1:string&gt;&lt;d12p1:string&gt;System.Core, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d12p1:string&gt;&lt;d12p1:string&gt;System.Xml, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d12p1:string&gt;&lt;d12p1:string&gt;System.Xml.Linq, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d12p1:string&gt;&lt;d12p1:string&gt;System.Data, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d12p1:string&gt;&lt;d12p1:string&gt;System.Data.DataSetExtensions, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d12p1:string&gt;&lt;d12p1:string&gt;System.Runtime.Serialization, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d12p1:string&gt;&lt;d12p1:string&gt;System.ServiceModel, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d12p1:string&gt;&lt;d12p1:string&gt;Newtonsoft.Json, Version=8.0.0.0, Culture=neutral, PublicKeyToken=30ad4fe6b2a6aeed&lt;/d12p1:string&gt;&lt;d12p1:string&gt;Microsoft.CSharp, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a&lt;/d12p1:string&gt;&lt;/ReferencedAssemblies&gt;&lt;TypeName&gt;Typead44a7581894525b364db79bf01c57&lt;/TypeName&gt;&lt;/ESBMessagePipelineStep&gt;&lt;ESBMessagePipelineStep i:type="d3p1:EsbMessageCSharpCodePipelineStep"&gt;&lt;Bindings xmlns:d12p1="http://schemas.datacontract.org/2004/07/Neuron.ComponentModel" /&gt;&lt;BreakPoint&gt;Disable&lt;/BreakPoint&gt;&lt;Disable&gt;false&lt;/Disable&gt;&lt;Id&gt;a11216e9-4923-48e3-a647-415906737d4f&lt;/Id&gt;&lt;Name&gt;Map To Validate Transaction Date&lt;/Name&gt;&lt;Uniquename /&gt;&lt;BreakPointLines xmlns:d12p1="http://schemas.microsoft.com/2003/10/Serialization/Arrays" /&gt;&lt;Code&gt;// Retrieve the response template message
string dateTimeValidationRequestTemplate = context.Configuration.XmlDocs["DateTimeValidationRequest"].Xml;
	
System.Xml.XmlNode node = (System.Xml.XmlNode) context.Properties["MaterialLot"];

string message = System.Net.WebUtility.HtmlEncode (node.OuterXml.ToString());

// Create the response message
string dateTimeValidationRequest = string.Format(dateTimeValidationRequestTemplate, context.Properties["TransactionID"], context.Properties["SourceSystemID"], context.Properties["PlantID"], "LastUpdateTime: ", context.Properties["LastUpdateDateTime"].ToString(), message);

//Send the trace message to document the response message.
context.Instance.TraceInformation ("Process Material Lot - Message ID: " + context.Data.Header.MessageId.ToString() + " Request Message: " + dateTimeValidationRequest);
	
// Set message context to the response message 	
context.Data.Text = dateTimeValidationRequest;&lt;/Code&gt;&lt;ReferencedAssemblies xmlns:d12p1="http://schemas.microsoft.com/2003/10/Serialization/Arrays"&gt;&lt;d12p1:string&gt;Neuron&lt;/d12p1:string&gt;&lt;d12p1:string&gt;Neuron.Pipelines&lt;/d12p1:string&gt;&lt;d12p1:string&gt;Neuron.Esb&lt;/d12p1:string&gt;&lt;d12p1:string&gt;System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d12p1:string&gt;&lt;d12p1:string&gt;System.Core, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d12p1:string&gt;&lt;d12p1:string&gt;System.Xml, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d12p1:string&gt;&lt;d12p1:string&gt;System.Xml.Linq, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d12p1:string&gt;&lt;d12p1:string&gt;System.Data, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d12p1:string&gt;&lt;d12p1:string&gt;System.Data.DataSetExtensions, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d12p1:string&gt;&lt;d12p1:string&gt;System.Runtime.Serialization, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d12p1:string&gt;&lt;d12p1:string&gt;System.ServiceModel, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d12p1:string&gt;&lt;d12p1:string&gt;Newtonsoft.Json, Version=8.0.0.0, Culture=neutral, PublicKeyToken=30ad4fe6b2a6aeed&lt;/d12p1:string&gt;&lt;d12p1:string&gt;Microsoft.CSharp, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a&lt;/d12p1:string&gt;&lt;/ReferencedAssemblies&gt;&lt;TypeName&gt;Type4b642b7ca46479aba4f600ef55b41f&lt;/TypeName&gt;&lt;/ESBMessagePipelineStep&gt;&lt;ESBMessagePipelineStep i:type="d3p1:EsbMessagePipelineExecutionPipelineStep"&gt;&lt;Bindings xmlns:d12p1="http://schemas.datacontract.org/2004/07/Neuron.ComponentModel" /&gt;&lt;BreakPoint&gt;Disable&lt;/BreakPoint&gt;&lt;Disable&gt;false&lt;/Disable&gt;&lt;Id&gt;d9ce1b97-001b-477c-a4f5-cbd689792f45&lt;/Id&gt;&lt;Name&gt;Validate Date&lt;/Name&gt;&lt;Uniquename /&gt;&lt;d3p1:FileName i:nil="true" /&gt;&lt;d3p1:MaxInstances&gt;100&lt;/d3p1:MaxInstances&gt;&lt;d3p1:PipelineName&gt;Validate Date Time Format&lt;/d3p1:PipelineName&gt;&lt;d3p1:PoolTimeout&gt;PT1M&lt;/d3p1:PoolTimeout&gt;&lt;/ESBMessagePipelineStep&gt;&lt;ESBMessagePipelineStep i:type="DecisionPipelineStepOfESBMessagexAPWb1W4"&gt;&lt;Bindings xmlns:d12p1="http://schemas.datacontract.org/2004/07/Neuron.ComponentModel" /&gt;&lt;BreakPoint&gt;Disable&lt;/BreakPoint&gt;&lt;Disable&gt;false&lt;/Disable&gt;&lt;Id&gt;32da49ec-b45f-41ce-b641-f10ec82566a8&lt;/Id&gt;&lt;Name&gt;Decision&lt;/Name&gt;&lt;Uniquename /&gt;&lt;Branches&gt;&lt;BranchOfESBMessagexAPWb1W4&gt;&lt;BreakPoint&gt;Disable&lt;/BreakPoint&gt;&lt;Condition i:type="CodeBranchConditionOfESBMessagexAPWb1W4"&gt;&lt;Code&gt;if (context.Data.GetProperty("Neo", "DateTimeValid").ToUpper() == "TRUE")
	return true;
else
	return false;&lt;/Code&gt;&lt;ReferencedAssemblies xmlns:d15p1="http://schemas.microsoft.com/2003/10/Serialization/Arrays"&gt;&lt;d15p1:string&gt;Neuron&lt;/d15p1:string&gt;&lt;d15p1:string&gt;Neuron.Pipelines&lt;/d15p1:string&gt;&lt;d15p1:string&gt;Neuron.Esb&lt;/d15p1:string&gt;&lt;d15p1:string&gt;System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d15p1:string&gt;&lt;d15p1:string&gt;System.Core, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d15p1:string&gt;&lt;d15p1:string&gt;System.Xml, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d15p1:string&gt;&lt;d15p1:string&gt;System.Xml.Linq, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d15p1:string&gt;&lt;d15p1:string&gt;System.Data, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d15p1:string&gt;&lt;d15p1:string&gt;System.Data.DataSetExtensions, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d15p1:string&gt;&lt;d15p1:string&gt;System.Runtime.Serialization, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d15p1:string&gt;&lt;d15p1:string&gt;System.ServiceModel, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d15p1:string&gt;&lt;d15p1:string&gt;Newtonsoft.Json, Version=8.0.0.0, Culture=neutral, PublicKeyToken=30ad4fe6b2a6aeed&lt;/d15p1:string&gt;&lt;d15p1:string&gt;Microsoft.CSharp, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a&lt;/d15p1:string&gt;&lt;/ReferencedAssemblies&gt;&lt;/Condition&gt;&lt;Disable&gt;false&lt;/Disable&gt;&lt;EndJoined&gt;false&lt;/EndJoined&gt;&lt;Name&gt;If&lt;/Name&gt;&lt;Steps&gt;&lt;Bindings xmlns:d15p1="http://schemas.datacontract.org/2004/07/Neuron.ComponentModel" /&gt;&lt;BreakPoint&gt;Disable&lt;/BreakPoint&gt;&lt;Disable&gt;false&lt;/Disable&gt;&lt;Id&gt;eca97647-ab68-43c9-aaf0-e9442738b6fb&lt;/Id&gt;&lt;Name&gt;Group&lt;/Name&gt;&lt;Uniquename /&gt;&lt;Children&gt;&lt;ESBMessagePipelineStep i:type="d3p1:EsbMessageCSharpCodePipelineStep"&gt;&lt;Bindings xmlns:d17p1="http://schemas.datacontract.org/2004/07/Neuron.ComponentModel" /&gt;&lt;BreakPoint&gt;Disable&lt;/BreakPoint&gt;&lt;Disable&gt;false&lt;/Disable&gt;&lt;Id&gt;1bd0a38d-f769-40f6-979e-0c24ad014629&lt;/Id&gt;&lt;Name&gt;Map to Material Master Composite&lt;/Name&gt;&lt;Uniquename /&gt;&lt;BreakPointLines xmlns:d17p1="http://schemas.microsoft.com/2003/10/Serialization/Arrays" /&gt;&lt;Code&gt;// Retrieve the response template message
string materialMasterRequestTemplate = context.Configuration.XmlDocs["MasterMasterCompositeRequest"].Xml;

System.Xml.XmlNode node = (System.Xml.XmlNode) context.Properties["MaterialLot"];

string message = System.Net.WebUtility.HtmlEncode (node.OuterXml.ToString());

// Create the response message
string materialMasterRequest = string.Format(materialMasterRequestTemplate, context.Properties["TransactionID"], context.Properties["SourceSystemID"], context.Properties["PlantID"], context.Properties["MaterialID"], "false", message);

//Send the trace message to document the response message.
context.Instance.TraceInformation ("Process Material Lot - Message ID: " + context.Data.Header.MessageId.ToString() + " Request Message: " + materialMasterRequest);
	
// Set message context to the response message 	
context.Data.Text = materialMasterRequest;&lt;/Code&gt;&lt;ReferencedAssemblies xmlns:d17p1="http://schemas.microsoft.com/2003/10/Serialization/Arrays"&gt;&lt;d17p1:string&gt;Neuron&lt;/d17p1:string&gt;&lt;d17p1:string&gt;Neuron.Pipelines&lt;/d17p1:string&gt;&lt;d17p1:string&gt;Neuron.Esb&lt;/d17p1:string&gt;&lt;d17p1:string&gt;System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d17p1:string&gt;&lt;d17p1:string&gt;System.Core, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d17p1:string&gt;&lt;d17p1:string&gt;System.Xml, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d17p1:string&gt;&lt;d17p1:string&gt;System.Xml.Linq, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d17p1:string&gt;&lt;d17p1:string&gt;System.Data, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d17p1:string&gt;&lt;d17p1:string&gt;System.Data.DataSetExtensions, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d17p1:string&gt;&lt;d17p1:string&gt;System.Runtime.Serialization, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d17p1:string&gt;&lt;d17p1:string&gt;System.ServiceModel, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d17p1:string&gt;&lt;d17p1:string&gt;Newtonsoft.Json, Version=8.0.0.0, Culture=neutral, PublicKeyToken=30ad4fe6b2a6aeed&lt;/d17p1:string&gt;&lt;d17p1:string&gt;Microsoft.CSharp, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a&lt;/d17p1:string&gt;&lt;/ReferencedAssemblies&gt;&lt;TypeName&gt;Type37101cfe448494cb0125c813a04945&lt;/TypeName&gt;&lt;/ESBMessagePipelineStep&gt;&lt;ESBMessagePipelineStep i:type="d3p1:EsbMessagePipelineExecutionPipelineStep"&gt;&lt;Bindings xmlns:d17p1="http://schemas.datacontract.org/2004/07/Neuron.ComponentModel" /&gt;&lt;BreakPoint&gt;Disable&lt;/BreakPoint&gt;&lt;Disable&gt;false&lt;/Disable&gt;&lt;Id&gt;26580985-b910-413c-a42c-7c7f54f32eff&lt;/Id&gt;&lt;Name&gt;Material Master Composite&lt;/Name&gt;&lt;Uniquename /&gt;&lt;d3p1:FileName i:nil="true" /&gt;&lt;d3p1:MaxInstances&gt;100&lt;/d3p1:MaxInstances&gt;&lt;d3p1:PipelineName&gt;Process_GetMaterialMasterComposite&lt;/d3p1:PipelineName&gt;&lt;d3p1:PoolTimeout&gt;PT1M&lt;/d3p1:PoolTimeout&gt;&lt;/ESBMessagePipelineStep&gt;&lt;ESBMessagePipelineStep i:type="d3p1:EsbMessageCSharpCodePipelineStep"&gt;&lt;Bindings xmlns:d17p1="http://schemas.datacontract.org/2004/07/Neuron.ComponentModel" /&gt;&lt;BreakPoint&gt;Disable&lt;/BreakPoint&gt;&lt;Disable&gt;false&lt;/Disable&gt;&lt;Id&gt;13e223e5-40d6-4939-ae2b-01e860f5b9d1&lt;/Id&gt;&lt;Name&gt;Map From Material Master Composite&lt;/Name&gt;&lt;Uniquename /&gt;&lt;BreakPointLines xmlns:d17p1="http://schemas.microsoft.com/2003/10/Serialization/Arrays" /&gt;&lt;Code&gt;string facilityUID = context.Data.GetProperty("NeoPLM", "FacilityUID");
context.Properties ["FacilityUID"] = facilityUID;
context.Instance.TraceInformation ("Process Material Lot - Transaction ID: " + context.Properties["TransactionID"] + " FacilityUID: " + context.Properties["FacilityUID"]);

string plantCodeUID = context.Data.GetProperty("NeoPLM", "PlantCodeUID");
context.Properties ["PlantCodeUID"] = plantCodeUID;
context.Instance.TraceInformation ("Process Material Lot - Transaction ID: " + context.Properties["TransactionID"] + " PlantCodeUID: " + context.Properties["PlantCodeUID"]);

string materialUID = context.Data.GetProperty("NeoPLM", "MaterialUID");
context.Properties ["MaterialMasterUID"] = materialUID;
context.Instance.TraceInformation ("Process Material Lot - Transaction ID: " + context.Properties["TransactionID"] + " MaterialUID: " + context.Properties["MaterialMasterUID"]);

string neoMaterialType = context.Data.GetProperty("NeoPLM", "NeoMaterialType");
context.Properties ["NeoMaterialType"] = neoMaterialType;
context.Instance.TraceInformation ("Process Material Lot - Transaction ID: " + context.Properties["TransactionID"] + " NeoMaterialType: " + context.Properties["NeoMaterialType"]);

&lt;/Code&gt;&lt;ReferencedAssemblies xmlns:d17p1="http://schemas.microsoft.com/2003/10/Serialization/Arrays"&gt;&lt;d17p1:string&gt;Neuron&lt;/d17p1:string&gt;&lt;d17p1:string&gt;Neuron.Pipelines&lt;/d17p1:string&gt;&lt;d17p1:string&gt;Neuron.Esb&lt;/d17p1:string&gt;&lt;d17p1:string&gt;System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d17p1:string&gt;&lt;d17p1:string&gt;System.Core, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d17p1:string&gt;&lt;d17p1:string&gt;System.Xml, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d17p1:string&gt;&lt;d17p1:string&gt;System.Xml.Linq, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d17p1:string&gt;&lt;d17p1:string&gt;System.Data, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d17p1:string&gt;&lt;d17p1:string&gt;System.Data.DataSetExtensions, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d17p1:string&gt;&lt;d17p1:string&gt;System.Runtime.Serialization, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d17p1:string&gt;&lt;d17p1:string&gt;System.ServiceModel, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d17p1:string&gt;&lt;d17p1:string&gt;Newtonsoft.Json, Version=8.0.0.0, Culture=neutral, PublicKeyToken=30ad4fe6b2a6aeed&lt;/d17p1:string&gt;&lt;d17p1:string&gt;Microsoft.CSharp, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a&lt;/d17p1:string&gt;&lt;/ReferencedAssemblies&gt;&lt;TypeName&gt;Type33682111aa0455a8c7246274422399&lt;/TypeName&gt;&lt;/ESBMessagePipelineStep&gt;&lt;ESBMessagePipelineStep i:type="DecisionPipelineStepOfESBMessagexAPWb1W4"&gt;&lt;Bindings xmlns:d17p1="http://schemas.datacontract.org/2004/07/Neuron.ComponentModel" /&gt;&lt;BreakPoint&gt;Disable&lt;/BreakPoint&gt;&lt;Disable&gt;false&lt;/Disable&gt;&lt;Id&gt;8f1413f0-e763-49fd-9fc9-c6a8661bda21&lt;/Id&gt;&lt;Name&gt;Decision&lt;/Name&gt;&lt;Uniquename /&gt;&lt;Branches&gt;&lt;BranchOfESBMessagexAPWb1W4&gt;&lt;BreakPoint&gt;Disable&lt;/BreakPoint&gt;&lt;Condition i:type="CodeBranchConditionOfESBMessagexAPWb1W4"&gt;&lt;Code&gt;if (context.Data.GetProperty("NeoPLM", "LookupError").ToUpper() == "FALSE")
	return true;
else
	return false;&lt;/Code&gt;&lt;ReferencedAssemblies xmlns:d20p1="http://schemas.microsoft.com/2003/10/Serialization/Arrays"&gt;&lt;d20p1:string&gt;Neuron&lt;/d20p1:string&gt;&lt;d20p1:string&gt;Neuron.Pipelines&lt;/d20p1:string&gt;&lt;d20p1:string&gt;Neuron.Esb&lt;/d20p1:string&gt;&lt;d20p1:string&gt;System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d20p1:string&gt;&lt;d20p1:string&gt;System.Core, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d20p1:string&gt;&lt;d20p1:string&gt;System.Xml, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d20p1:string&gt;&lt;d20p1:string&gt;System.Xml.Linq, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d20p1:string&gt;&lt;d20p1:string&gt;System.Data, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d20p1:string&gt;&lt;d20p1:string&gt;System.Data.DataSetExtensions, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d20p1:string&gt;&lt;d20p1:string&gt;System.Runtime.Serialization, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d20p1:string&gt;&lt;d20p1:string&gt;System.ServiceModel, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d20p1:string&gt;&lt;d20p1:string&gt;Newtonsoft.Json, Version=8.0.0.0, Culture=neutral, PublicKeyToken=30ad4fe6b2a6aeed&lt;/d20p1:string&gt;&lt;d20p1:string&gt;Microsoft.CSharp, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a&lt;/d20p1:string&gt;&lt;/ReferencedAssemblies&gt;&lt;/Condition&gt;&lt;Disable&gt;false&lt;/Disable&gt;&lt;EndJoined&gt;false&lt;/EndJoined&gt;&lt;Name&gt;If&lt;/Name&gt;&lt;Steps&gt;&lt;Bindings xmlns:d20p1="http://schemas.datacontract.org/2004/07/Neuron.ComponentModel" /&gt;&lt;BreakPoint&gt;Disable&lt;/BreakPoint&gt;&lt;Disable&gt;false&lt;/Disable&gt;&lt;Id&gt;14725818-b8c0-4dce-b718-019e96fddb77&lt;/Id&gt;&lt;Name&gt;Group&lt;/Name&gt;&lt;Uniquename /&gt;&lt;Children&gt;&lt;ESBMessagePipelineStep i:type="d3p1:EsbMessageCSharpCodePipelineStep"&gt;&lt;Bindings xmlns:d22p1="http://schemas.datacontract.org/2004/07/Neuron.ComponentModel" /&gt;&lt;BreakPoint&gt;Disable&lt;/BreakPoint&gt;&lt;Disable&gt;false&lt;/Disable&gt;&lt;Id&gt;d35aaf60-32a2-40f1-b835-917297a3b2c3&lt;/Id&gt;&lt;Name&gt;Map To Status Lookup&lt;/Name&gt;&lt;Uniquename /&gt;&lt;BreakPointLines xmlns:d22p1="http://schemas.microsoft.com/2003/10/Serialization/Arrays" /&gt;&lt;Code&gt;// Retrieve the response template message
string materialMasterRequestTemplate = context.Configuration.XmlDocs["MaterialLotStatusRequest"].Xml;

System.Xml.XmlNode node = (System.Xml.XmlNode) context.Properties["MaterialLot"];

string message = System.Net.WebUtility.HtmlEncode (node.OuterXml.ToString());

// Create the response message
string materialMasterRequest = string.Format(materialMasterRequestTemplate, context.Properties["TransactionID"], context.Properties["SourceSystemID"], context.Properties["PlantID"], context.Properties["StatusID"], "false", message);

//Send the trace message to document the response message.
context.Instance.TraceInformation ("Process Material Lot - Message ID: " + context.Data.Header.MessageId.ToString() + " Request Message: " + materialMasterRequest);
	
// Set message context to the response message 	
context.Data.Text = materialMasterRequest;&lt;/Code&gt;&lt;ReferencedAssemblies xmlns:d22p1="http://schemas.microsoft.com/2003/10/Serialization/Arrays"&gt;&lt;d22p1:string&gt;Neuron&lt;/d22p1:string&gt;&lt;d22p1:string&gt;Neuron.Pipelines&lt;/d22p1:string&gt;&lt;d22p1:string&gt;Neuron.Esb&lt;/d22p1:string&gt;&lt;d22p1:string&gt;System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d22p1:string&gt;&lt;d22p1:string&gt;System.Core, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d22p1:string&gt;&lt;d22p1:string&gt;System.Xml, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d22p1:string&gt;&lt;d22p1:string&gt;System.Xml.Linq, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d22p1:string&gt;&lt;d22p1:string&gt;System.Data, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d22p1:string&gt;&lt;d22p1:string&gt;System.Data.DataSetExtensions, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d22p1:string&gt;&lt;d22p1:string&gt;System.Runtime.Serialization, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d22p1:string&gt;&lt;d22p1:string&gt;System.ServiceModel, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d22p1:string&gt;&lt;d22p1:string&gt;Newtonsoft.Json, Version=8.0.0.0, Culture=neutral, PublicKeyToken=30ad4fe6b2a6aeed&lt;/d22p1:string&gt;&lt;d22p1:string&gt;Microsoft.CSharp, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a&lt;/d22p1:string&gt;&lt;/ReferencedAssemblies&gt;&lt;TypeName&gt;Typea8b6e3be2a844b28453667b3c845e5&lt;/TypeName&gt;&lt;/ESBMessagePipelineStep&gt;&lt;ESBMessagePipelineStep i:type="d3p1:EsbMessagePipelineExecutionPipelineStep"&gt;&lt;Bindings xmlns:d22p1="http://schemas.datacontract.org/2004/07/Neuron.ComponentModel" /&gt;&lt;BreakPoint&gt;Disable&lt;/BreakPoint&gt;&lt;Disable&gt;false&lt;/Disable&gt;&lt;Id&gt;594dc927-896e-445d-a931-758755909879&lt;/Id&gt;&lt;Name&gt;Lookup Status&lt;/Name&gt;&lt;Uniquename /&gt;&lt;d3p1:FileName i:nil="true" /&gt;&lt;d3p1:MaxInstances&gt;100&lt;/d3p1:MaxInstances&gt;&lt;d3p1:PipelineName&gt;Process_GetMaterialLotStatus - New&lt;/d3p1:PipelineName&gt;&lt;d3p1:PoolTimeout&gt;PT1M&lt;/d3p1:PoolTimeout&gt;&lt;/ESBMessagePipelineStep&gt;&lt;ESBMessagePipelineStep i:type="d3p1:EsbMessageCSharpCodePipelineStep"&gt;&lt;Bindings xmlns:d22p1="http://schemas.datacontract.org/2004/07/Neuron.ComponentModel" /&gt;&lt;BreakPoint&gt;Disable&lt;/BreakPoint&gt;&lt;Disable&gt;false&lt;/Disable&gt;&lt;Id&gt;a672034d-4c93-4d4e-864e-c023bfaa601e&lt;/Id&gt;&lt;Name&gt;Map From Status Lookup&lt;/Name&gt;&lt;Uniquename /&gt;&lt;BreakPointLines xmlns:d22p1="http://schemas.microsoft.com/2003/10/Serialization/Arrays" /&gt;&lt;Code&gt;string mlStatus = context.Data.ToXmlDocument().SelectSingleNode("/*[local-name()='MaterialLotStatusLookupResponse' and namespace-uri()='http://NeoPLM.com/EnterpriseIntegration']/*[local-name()='NeoPLMStatus' and namespace-uri()='http://NeoPLM.com/EnterpriseIntegration']").InnerText;

context.Properties ["StatusUID"] = mlStatus;

context.Instance.TraceInformation ("Process Material Lot - Transaction ID: " + context.Properties["TransactionID"] + " Material Lot Status " + context.Properties["StatusUID"]);&lt;/Code&gt;&lt;ReferencedAssemblies xmlns:d22p1="http://schemas.microsoft.com/2003/10/Serialization/Arrays"&gt;&lt;d22p1:string&gt;Neuron&lt;/d22p1:string&gt;&lt;d22p1:string&gt;Neuron.Pipelines&lt;/d22p1:string&gt;&lt;d22p1:string&gt;Neuron.Esb&lt;/d22p1:string&gt;&lt;d22p1:string&gt;System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d22p1:string&gt;&lt;d22p1:string&gt;System.Core, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d22p1:string&gt;&lt;d22p1:string&gt;System.Xml, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d22p1:string&gt;&lt;d22p1:string&gt;System.Xml.Linq, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d22p1:string&gt;&lt;d22p1:string&gt;System.Data, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d22p1:string&gt;&lt;d22p1:string&gt;System.Data.DataSetExtensions, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d22p1:string&gt;&lt;d22p1:string&gt;System.Runtime.Serialization, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d22p1:string&gt;&lt;d22p1:string&gt;System.ServiceModel, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d22p1:string&gt;&lt;d22p1:string&gt;Newtonsoft.Json, Version=8.0.0.0, Culture=neutral, PublicKeyToken=30ad4fe6b2a6aeed&lt;/d22p1:string&gt;&lt;d22p1:string&gt;Microsoft.CSharp, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a&lt;/d22p1:string&gt;&lt;/ReferencedAssemblies&gt;&lt;TypeName&gt;Type923bc944d8242d3bc66ba4a4fd010b&lt;/TypeName&gt;&lt;/ESBMessagePipelineStep&gt;&lt;ESBMessagePipelineStep i:type="DecisionPipelineStepOfESBMessagexAPWb1W4"&gt;&lt;Bindings xmlns:d22p1="http://schemas.datacontract.org/2004/07/Neuron.ComponentModel" /&gt;&lt;BreakPoint&gt;Disable&lt;/BreakPoint&gt;&lt;Disable&gt;false&lt;/Disable&gt;&lt;Id&gt;122b3886-77a3-4355-8429-b425410301c5&lt;/Id&gt;&lt;Name&gt;Decision&lt;/Name&gt;&lt;Uniquename /&gt;&lt;Branches&gt;&lt;BranchOfESBMessagexAPWb1W4&gt;&lt;BreakPoint&gt;Disable&lt;/BreakPoint&gt;&lt;Condition i:type="CodeBranchConditionOfESBMessagexAPWb1W4"&gt;&lt;Code&gt;if (context.Data.GetProperty("NeoPLM", "LookupError").ToUpper() == "FALSE")
	return true;
else
	return false;&lt;/Code&gt;&lt;ReferencedAssemblies xmlns:d25p1="http://schemas.microsoft.com/2003/10/Serialization/Arrays"&gt;&lt;d25p1:string&gt;Neuron&lt;/d25p1:string&gt;&lt;d25p1:string&gt;Neuron.Pipelines&lt;/d25p1:string&gt;&lt;d25p1:string&gt;Neuron.Esb&lt;/d25p1:string&gt;&lt;d25p1:string&gt;System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d25p1:string&gt;&lt;d25p1:string&gt;System.Core, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d25p1:string&gt;&lt;d25p1:string&gt;System.Xml, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d25p1:string&gt;&lt;d25p1:string&gt;System.Xml.Linq, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d25p1:string&gt;&lt;d25p1:string&gt;System.Data, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d25p1:string&gt;&lt;d25p1:string&gt;System.Data.DataSetExtensions, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d25p1:string&gt;&lt;d25p1:string&gt;System.Runtime.Serialization, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d25p1:string&gt;&lt;d25p1:string&gt;System.ServiceModel, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d25p1:string&gt;&lt;d25p1:string&gt;Newtonsoft.Json, Version=8.0.0.0, Culture=neutral, PublicKeyToken=30ad4fe6b2a6aeed&lt;/d25p1:string&gt;&lt;d25p1:string&gt;Microsoft.CSharp, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a&lt;/d25p1:string&gt;&lt;/ReferencedAssemblies&gt;&lt;/Condition&gt;&lt;Disable&gt;false&lt;/Disable&gt;&lt;EndJoined&gt;false&lt;/EndJoined&gt;&lt;Name&gt;If&lt;/Name&gt;&lt;Steps&gt;&lt;Bindings xmlns:d25p1="http://schemas.datacontract.org/2004/07/Neuron.ComponentModel" /&gt;&lt;BreakPoint&gt;Disable&lt;/BreakPoint&gt;&lt;Disable&gt;false&lt;/Disable&gt;&lt;Id&gt;ee491e2f-8baf-4f5e-9253-48afc05b3851&lt;/Id&gt;&lt;Name&gt;Group&lt;/Name&gt;&lt;Uniquename /&gt;&lt;Children&gt;&lt;ESBMessagePipelineStep i:type="d3p1:EsbMessageCSharpCodePipelineStep"&gt;&lt;Bindings xmlns:d27p1="http://schemas.datacontract.org/2004/07/Neuron.ComponentModel" /&gt;&lt;BreakPoint&gt;Disable&lt;/BreakPoint&gt;&lt;Disable&gt;false&lt;/Disable&gt;&lt;Id&gt;be7776f9-bb30-4423-b359-e5adf5417f89&lt;/Id&gt;&lt;Name&gt;Map to EU Lookup&lt;/Name&gt;&lt;Uniquename /&gt;&lt;BreakPointLines xmlns:d27p1="http://schemas.microsoft.com/2003/10/Serialization/Arrays" /&gt;&lt;Code&gt;// Retrieve the response template message
string eURequestTemplate = context.Configuration.XmlDocs["EngineeringUnitRequest"].Xml;

System.Xml.XmlNode node = (System.Xml.XmlNode) context.Properties["MaterialLot"];

string message = System.Net.WebUtility.HtmlEncode (node.OuterXml.ToString());

// Create the response message
string eURequest = string.Format(eURequestTemplate, context.Properties["TransactionID"], context.Properties["SourceSystemID"], context.Properties["EngineeringUnitID"], "false", message);

//Send the trace message to document the response message.
context.Instance.TraceInformation ("Process Material Lot - Message ID: " + context.Data.Header.MessageId.ToString() + " Request Message: " + eURequest);
	
// Set message context to the response message 	
context.Data.Text = eURequest;&lt;/Code&gt;&lt;ReferencedAssemblies xmlns:d27p1="http://schemas.microsoft.com/2003/10/Serialization/Arrays"&gt;&lt;d27p1:string&gt;Neuron&lt;/d27p1:string&gt;&lt;d27p1:string&gt;Neuron.Pipelines&lt;/d27p1:string&gt;&lt;d27p1:string&gt;Neuron.Esb&lt;/d27p1:string&gt;&lt;d27p1:string&gt;System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d27p1:string&gt;&lt;d27p1:string&gt;System.Core, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d27p1:string&gt;&lt;d27p1:string&gt;System.Xml, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d27p1:string&gt;&lt;d27p1:string&gt;System.Xml.Linq, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d27p1:string&gt;&lt;d27p1:string&gt;System.Data, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d27p1:string&gt;&lt;d27p1:string&gt;System.Data.DataSetExtensions, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d27p1:string&gt;&lt;d27p1:string&gt;System.Runtime.Serialization, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d27p1:string&gt;&lt;d27p1:string&gt;System.ServiceModel, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d27p1:string&gt;&lt;d27p1:string&gt;Newtonsoft.Json, Version=8.0.0.0, Culture=neutral, PublicKeyToken=30ad4fe6b2a6aeed&lt;/d27p1:string&gt;&lt;d27p1:string&gt;Microsoft.CSharp, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a&lt;/d27p1:string&gt;&lt;/ReferencedAssemblies&gt;&lt;TypeName&gt;Typec063e2bc0504a0789ccdf9945e8899&lt;/TypeName&gt;&lt;/ESBMessagePipelineStep&gt;&lt;ESBMessagePipelineStep i:type="d3p1:EsbMessagePipelineExecutionPipelineStep"&gt;&lt;Bindings xmlns:d27p1="http://schemas.datacontract.org/2004/07/Neuron.ComponentModel" /&gt;&lt;BreakPoint&gt;Disable&lt;/BreakPoint&gt;&lt;Disable&gt;false&lt;/Disable&gt;&lt;Id&gt;3983c6ba-0cbc-4040-9330-04e291f66039&lt;/Id&gt;&lt;Name&gt;EU Lookup&lt;/Name&gt;&lt;Uniquename /&gt;&lt;d3p1:FileName i:nil="true" /&gt;&lt;d3p1:MaxInstances&gt;100&lt;/d3p1:MaxInstances&gt;&lt;d3p1:PipelineName&gt;Process_GetEngineeringUID - New&lt;/d3p1:PipelineName&gt;&lt;d3p1:PoolTimeout&gt;PT1M&lt;/d3p1:PoolTimeout&gt;&lt;/ESBMessagePipelineStep&gt;&lt;ESBMessagePipelineStep i:type="d3p1:EsbMessageCSharpCodePipelineStep"&gt;&lt;Bindings xmlns:d27p1="http://schemas.datacontract.org/2004/07/Neuron.ComponentModel" /&gt;&lt;BreakPoint&gt;Disable&lt;/BreakPoint&gt;&lt;Disable&gt;false&lt;/Disable&gt;&lt;Id&gt;4603a078-13ed-486f-bf99-1a63a47ce28c&lt;/Id&gt;&lt;Name&gt;Map From EU Lookup&lt;/Name&gt;&lt;Uniquename /&gt;&lt;BreakPointLines xmlns:d27p1="http://schemas.microsoft.com/2003/10/Serialization/Arrays" /&gt;&lt;Code&gt;string eUUID = context.Data.ToXmlDocument().SelectSingleNode("/*[local-name()='EngineeringUnitLookupResponse' and namespace-uri()='http://NeoPLM.com/EnterpriseIntegration']/*[local-name()='NeoPLMEngineeringUnitUID' and namespace-uri()='http://NeoPLM.com/EnterpriseIntegration']").InnerText;

context.Properties ["EngineeringUnitUID"] = eUUID;

context.Instance.TraceInformation ("Process Material Lot - Transaction ID: " + context.Properties["TransactionID"] + " Engineering Unit UID " + context.Properties["EngineeringUnitUID"]);&lt;/Code&gt;&lt;ReferencedAssemblies xmlns:d27p1="http://schemas.microsoft.com/2003/10/Serialization/Arrays"&gt;&lt;d27p1:string&gt;Neuron&lt;/d27p1:string&gt;&lt;d27p1:string&gt;Neuron.Pipelines&lt;/d27p1:string&gt;&lt;d27p1:string&gt;Neuron.Esb&lt;/d27p1:string&gt;&lt;d27p1:string&gt;System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d27p1:string&gt;&lt;d27p1:string&gt;System.Core, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d27p1:string&gt;&lt;d27p1:string&gt;System.Xml, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d27p1:string&gt;&lt;d27p1:string&gt;System.Xml.Linq, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d27p1:string&gt;&lt;d27p1:string&gt;System.Data, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d27p1:string&gt;&lt;d27p1:string&gt;System.Data.DataSetExtensions, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d27p1:string&gt;&lt;d27p1:string&gt;System.Runtime.Serialization, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d27p1:string&gt;&lt;d27p1:string&gt;System.ServiceModel, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d27p1:string&gt;&lt;d27p1:string&gt;Newtonsoft.Json, Version=8.0.0.0, Culture=neutral, PublicKeyToken=30ad4fe6b2a6aeed&lt;/d27p1:string&gt;&lt;d27p1:string&gt;Microsoft.CSharp, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a&lt;/d27p1:string&gt;&lt;/ReferencedAssemblies&gt;&lt;TypeName&gt;Type539d214a1e34e79a6e860161cb99db&lt;/TypeName&gt;&lt;/ESBMessagePipelineStep&gt;&lt;ESBMessagePipelineStep i:type="DecisionPipelineStepOfESBMessagexAPWb1W4"&gt;&lt;Bindings xmlns:d27p1="http://schemas.datacontract.org/2004/07/Neuron.ComponentModel" /&gt;&lt;BreakPoint&gt;Disable&lt;/BreakPoint&gt;&lt;Disable&gt;false&lt;/Disable&gt;&lt;Id&gt;2b8c0edc-a91a-4b8c-86f3-5a829145f943&lt;/Id&gt;&lt;Name&gt;Decision&lt;/Name&gt;&lt;Uniquename /&gt;&lt;Branches&gt;&lt;BranchOfESBMessagexAPWb1W4&gt;&lt;BreakPoint&gt;Disable&lt;/BreakPoint&gt;&lt;Condition i:type="CodeBranchConditionOfESBMessagexAPWb1W4"&gt;&lt;Code&gt;if (context.Data.GetProperty("NeoPLM", "LookupError").ToUpper() == "FALSE")
	return true;
else
	return false;&lt;/Code&gt;&lt;ReferencedAssemblies xmlns:d30p1="http://schemas.microsoft.com/2003/10/Serialization/Arrays"&gt;&lt;d30p1:string&gt;Neuron&lt;/d30p1:string&gt;&lt;d30p1:string&gt;Neuron.Pipelines&lt;/d30p1:string&gt;&lt;d30p1:string&gt;Neuron.Esb&lt;/d30p1:string&gt;&lt;d30p1:string&gt;System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d30p1:string&gt;&lt;d30p1:string&gt;System.Core, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d30p1:string&gt;&lt;d30p1:string&gt;System.Xml, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d30p1:string&gt;&lt;d30p1:string&gt;System.Xml.Linq, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d30p1:string&gt;&lt;d30p1:string&gt;System.Data, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d30p1:string&gt;&lt;d30p1:string&gt;System.Data.DataSetExtensions, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d30p1:string&gt;&lt;d30p1:string&gt;System.Runtime.Serialization, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d30p1:string&gt;&lt;d30p1:string&gt;System.ServiceModel, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d30p1:string&gt;&lt;d30p1:string&gt;Newtonsoft.Json, Version=8.0.0.0, Culture=neutral, PublicKeyToken=30ad4fe6b2a6aeed&lt;/d30p1:string&gt;&lt;d30p1:string&gt;Microsoft.CSharp, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a&lt;/d30p1:string&gt;&lt;/ReferencedAssemblies&gt;&lt;/Condition&gt;&lt;Disable&gt;false&lt;/Disable&gt;&lt;EndJoined&gt;false&lt;/EndJoined&gt;&lt;Name&gt;If&lt;/Name&gt;&lt;Steps&gt;&lt;Bindings xmlns:d30p1="http://schemas.datacontract.org/2004/07/Neuron.ComponentModel" /&gt;&lt;BreakPoint&gt;Disable&lt;/BreakPoint&gt;&lt;Disable&gt;false&lt;/Disable&gt;&lt;Id&gt;6ba82e33-18b8-45f1-908d-c6320f8ba41f&lt;/Id&gt;&lt;Name&gt;Group&lt;/Name&gt;&lt;Uniquename /&gt;&lt;Children&gt;&lt;ESBMessagePipelineStep i:type="d3p1:EsbMessageCSharpCodePipelineStep"&gt;&lt;Bindings xmlns:d32p1="http://schemas.datacontract.org/2004/07/Neuron.ComponentModel" /&gt;&lt;BreakPoint&gt;Disable&lt;/BreakPoint&gt;&lt;Disable&gt;false&lt;/Disable&gt;&lt;Id&gt;7bc8f492-3f06-470c-ba16-511e18dd1932&lt;/Id&gt;&lt;Name&gt;Map To Local URI&lt;/Name&gt;&lt;Uniquename /&gt;&lt;BreakPointLines xmlns:d32p1="http://schemas.microsoft.com/2003/10/Serialization/Arrays" /&gt;&lt;Code&gt;// Retrieve the response template message
string localServiceURIRequestTemplate = context.Configuration.XmlDocs["LocalServiceURIRequest"].Xml;
	
System.Xml.XmlNode node = (System.Xml.XmlNode) context.Properties["MaterialLot"];

string message = System.Net.WebUtility.HtmlEncode (node.OuterXml.ToString());

// Create the request message
string localServiceURIRequest = string.Format(localServiceURIRequestTemplate, context.Properties["TransactionID"], context.Properties["FacilityUID"], message);

//Send the trace message to document the request message.
context.Instance.TraceInformation ("Process Material Lot - Message ID: " + context.Data.Header.MessageId.ToString() + " Request Message: " + localServiceURIRequest);
	
// Set message context to the request message 	
context.Data.Text = localServiceURIRequest;&lt;/Code&gt;&lt;ReferencedAssemblies xmlns:d32p1="http://schemas.microsoft.com/2003/10/Serialization/Arrays"&gt;&lt;d32p1:string&gt;Neuron&lt;/d32p1:string&gt;&lt;d32p1:string&gt;Neuron.Pipelines&lt;/d32p1:string&gt;&lt;d32p1:string&gt;Neuron.Esb&lt;/d32p1:string&gt;&lt;d32p1:string&gt;System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d32p1:string&gt;&lt;d32p1:string&gt;System.Core, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d32p1:string&gt;&lt;d32p1:string&gt;System.Xml, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d32p1:string&gt;&lt;d32p1:string&gt;System.Xml.Linq, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d32p1:string&gt;&lt;d32p1:string&gt;System.Data, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d32p1:string&gt;&lt;d32p1:string&gt;System.Data.DataSetExtensions, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d32p1:string&gt;&lt;d32p1:string&gt;System.Runtime.Serialization, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d32p1:string&gt;&lt;d32p1:string&gt;System.ServiceModel, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d32p1:string&gt;&lt;d32p1:string&gt;Newtonsoft.Json, Version=8.0.0.0, Culture=neutral, PublicKeyToken=30ad4fe6b2a6aeed&lt;/d32p1:string&gt;&lt;d32p1:string&gt;Microsoft.CSharp, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a&lt;/d32p1:string&gt;&lt;/ReferencedAssemblies&gt;&lt;TypeName&gt;Type462126ea05c4d04b42064c3255e287&lt;/TypeName&gt;&lt;/ESBMessagePipelineStep&gt;&lt;ESBMessagePipelineStep i:type="d3p1:EsbMessagePipelineExecutionPipelineStep"&gt;&lt;Bindings xmlns:d32p1="http://schemas.datacontract.org/2004/07/Neuron.ComponentModel" /&gt;&lt;BreakPoint&gt;Disable&lt;/BreakPoint&gt;&lt;Disable&gt;false&lt;/Disable&gt;&lt;Id&gt;d3ade7a0-cf31-4751-83a2-e810ca58f168&lt;/Id&gt;&lt;Name&gt;Local URI&lt;/Name&gt;&lt;Uniquename /&gt;&lt;d3p1:FileName i:nil="true" /&gt;&lt;d3p1:MaxInstances&gt;100&lt;/d3p1:MaxInstances&gt;&lt;d3p1:PipelineName&gt;Process_GetLocalServiceURI - New&lt;/d3p1:PipelineName&gt;&lt;d3p1:PoolTimeout&gt;PT1M&lt;/d3p1:PoolTimeout&gt;&lt;/ESBMessagePipelineStep&gt;&lt;ESBMessagePipelineStep i:type="d3p1:EsbMessageCSharpCodePipelineStep"&gt;&lt;Bindings xmlns:d32p1="http://schemas.datacontract.org/2004/07/Neuron.ComponentModel" /&gt;&lt;BreakPoint&gt;Disable&lt;/BreakPoint&gt;&lt;Disable&gt;false&lt;/Disable&gt;&lt;Id&gt;bdd82578-da90-4c67-91cf-b4e7b47cb8b6&lt;/Id&gt;&lt;Name&gt;Map From Local URI&lt;/Name&gt;&lt;Uniquename /&gt;&lt;BreakPointLines xmlns:d32p1="http://schemas.microsoft.com/2003/10/Serialization/Arrays" /&gt;&lt;Code&gt;string localServiceURI = context.Data.ToXmlDocument().SelectSingleNode("/*[local-name()='LocalServiceURIResponse' and namespace-uri()='http://NeoPLM.com/EnterpriseIntegration']/*[local-name()='LocalServiceURI' and namespace-uri()='http://NeoPLM.com/EnterpriseIntegration']").InnerText;

context.Properties ["LocalServiceURI"] = localServiceURI;

context.Instance.TraceInformation ("Process Material Lot - Transaction ID: " + context.Properties["TransactionID"] + " LocalServiceURI: " + context.Properties["LocalServiceURI"]);&lt;/Code&gt;&lt;ReferencedAssemblies xmlns:d32p1="http://schemas.microsoft.com/2003/10/Serialization/Arrays"&gt;&lt;d32p1:string&gt;Neuron&lt;/d32p1:string&gt;&lt;d32p1:string&gt;Neuron.Pipelines&lt;/d32p1:string&gt;&lt;d32p1:string&gt;Neuron.Esb&lt;/d32p1:string&gt;&lt;d32p1:string&gt;System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d32p1:string&gt;&lt;d32p1:string&gt;System.Core, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d32p1:string&gt;&lt;d32p1:string&gt;System.Xml, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d32p1:string&gt;&lt;d32p1:string&gt;System.Xml.Linq, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d32p1:string&gt;&lt;d32p1:string&gt;System.Data, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d32p1:string&gt;&lt;d32p1:string&gt;System.Data.DataSetExtensions, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d32p1:string&gt;&lt;d32p1:string&gt;System.Runtime.Serialization, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d32p1:string&gt;&lt;d32p1:string&gt;System.ServiceModel, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d32p1:string&gt;&lt;d32p1:string&gt;Newtonsoft.Json, Version=8.0.0.0, Culture=neutral, PublicKeyToken=30ad4fe6b2a6aeed&lt;/d32p1:string&gt;&lt;d32p1:string&gt;Microsoft.CSharp, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a&lt;/d32p1:string&gt;&lt;/ReferencedAssemblies&gt;&lt;TypeName&gt;Type9b5f9b02d894592bae05ea79ecad56&lt;/TypeName&gt;&lt;/ESBMessagePipelineStep&gt;&lt;ESBMessagePipelineStep i:type="DecisionPipelineStepOfESBMessagexAPWb1W4"&gt;&lt;Bindings xmlns:d32p1="http://schemas.datacontract.org/2004/07/Neuron.ComponentModel" /&gt;&lt;BreakPoint&gt;Disable&lt;/BreakPoint&gt;&lt;Disable&gt;false&lt;/Disable&gt;&lt;Id&gt;dd7dfa0b-4a37-4cc0-9e2f-f8e6d411fdc0&lt;/Id&gt;&lt;Name&gt;Decision&lt;/Name&gt;&lt;Uniquename /&gt;&lt;Branches&gt;&lt;BranchOfESBMessagexAPWb1W4&gt;&lt;BreakPoint&gt;Disable&lt;/BreakPoint&gt;&lt;Condition i:type="CodeBranchConditionOfESBMessagexAPWb1W4"&gt;&lt;Code&gt;if (context.Data.GetProperty("NeoPLM", "LookupError").ToUpper() == "FALSE")
	return true;
else
	return false;&lt;/Code&gt;&lt;ReferencedAssemblies xmlns:d35p1="http://schemas.microsoft.com/2003/10/Serialization/Arrays"&gt;&lt;d35p1:string&gt;Neuron&lt;/d35p1:string&gt;&lt;d35p1:string&gt;Neuron.Pipelines&lt;/d35p1:string&gt;&lt;d35p1:string&gt;Neuron.Esb&lt;/d35p1:string&gt;&lt;d35p1:string&gt;System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d35p1:string&gt;&lt;d35p1:string&gt;System.Core, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d35p1:string&gt;&lt;d35p1:string&gt;System.Xml, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d35p1:string&gt;&lt;d35p1:string&gt;System.Xml.Linq, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d35p1:string&gt;&lt;d35p1:string&gt;System.Data, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d35p1:string&gt;&lt;d35p1:string&gt;System.Data.DataSetExtensions, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d35p1:string&gt;&lt;d35p1:string&gt;System.Runtime.Serialization, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d35p1:string&gt;&lt;d35p1:string&gt;System.ServiceModel, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d35p1:string&gt;&lt;d35p1:string&gt;Newtonsoft.Json, Version=8.0.0.0, Culture=neutral, PublicKeyToken=30ad4fe6b2a6aeed&lt;/d35p1:string&gt;&lt;d35p1:string&gt;Microsoft.CSharp, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a&lt;/d35p1:string&gt;&lt;/ReferencedAssemblies&gt;&lt;/Condition&gt;&lt;Disable&gt;false&lt;/Disable&gt;&lt;EndJoined&gt;false&lt;/EndJoined&gt;&lt;Name&gt;If&lt;/Name&gt;&lt;Steps&gt;&lt;Bindings xmlns:d35p1="http://schemas.datacontract.org/2004/07/Neuron.ComponentModel" /&gt;&lt;BreakPoint&gt;Disable&lt;/BreakPoint&gt;&lt;Disable&gt;false&lt;/Disable&gt;&lt;Id&gt;cea2d354-7a88-4192-ba0c-0139d043cbfc&lt;/Id&gt;&lt;Name&gt;Group&lt;/Name&gt;&lt;Uniquename /&gt;&lt;Children&gt;&lt;ESBMessagePipelineStep i:type="d3p1:EsbMessageCSharpCodePipelineStep"&gt;&lt;Bindings xmlns:d37p1="http://schemas.datacontract.org/2004/07/Neuron.ComponentModel" /&gt;&lt;BreakPoint&gt;Disable&lt;/BreakPoint&gt;&lt;Disable&gt;false&lt;/Disable&gt;&lt;Id&gt;03f9d94e-538c-4a45-a555-f85c9452a75b&lt;/Id&gt;&lt;Name&gt;Map To Create Material Lot&lt;/Name&gt;&lt;Uniquename /&gt;&lt;BreakPointLines xmlns:d37p1="http://schemas.microsoft.com/2003/10/Serialization/Arrays" /&gt;&lt;Code&gt;// Retrieve the response template message
string materialLotRequestTemplate = context.Configuration.XmlDocs["MaterialLotSave"].Xml;

// This is a placeholder material Lot.  These properties are set to the default values below.
string externalStatus = context.Properties["StatusID"].ToString();
string externalStatusDescription = context.Properties["StatusDescription"].ToString();
string lotStatus = context.Properties["StatusUID"].ToString();
string potency = context.Properties["Potency"].ToString();
string potencyLabel = context.Properties["EngineeringUnitID"].ToString();
string potencyUnits = context.Properties["EngineeringUnitUID"].ToString();
string supplierID = context.Properties["SupplierID"].ToString();
string supplierName = System.Net.WebUtility.HtmlEncode (context.Properties["SupplierName"].ToString());
string supplierLotID = context.Properties["SupplierLotID"].ToString();
string lastModified = System.DateTime.UtcNow.ToString("yyyy-MM-ddTHH:mm:ssZ").ToString();

System.DateTime dt = System.DateTime.Parse(context.Properties["LastUpdateDateTime"].ToString());

string sourceLastModified = dt.ToUniversalTime().ToString ("yyyy-MM-ddTHH:mm:ssZ");

// Create the request message
string materialLotRequest = string.Format(materialLotRequestTemplate, "Create/Update", context.Properties["LocalServiceURI"], 
	                        context.Properties["MaterialLotID"], context.Properties["FacilityUID"], 
	                        context.Properties["PlantCodeUID"], context.Properties["MaterialMasterUID"], 
	                        context.Properties["NeoMaterialType"], externalStatus, externalStatusDescription, 
	                        lotStatus, potency, potencyLabel, potencyUnits, supplierID, supplierName, 
	                        supplierLotID, lastModified, sourceLastModified );

//Send the trace message to document the request message.
context.Instance.TraceInformation ("Process Material Lot - Message ID: " + context.Data.Header.MessageId.ToString() + " Request Message: " + materialLotRequest);
	
// Set message context to the request message 	
context.Data.Text = materialLotRequest;&lt;/Code&gt;&lt;ReferencedAssemblies xmlns:d37p1="http://schemas.microsoft.com/2003/10/Serialization/Arrays"&gt;&lt;d37p1:string&gt;Neuron&lt;/d37p1:string&gt;&lt;d37p1:string&gt;Neuron.Pipelines&lt;/d37p1:string&gt;&lt;d37p1:string&gt;Neuron.Esb&lt;/d37p1:string&gt;&lt;d37p1:string&gt;System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d37p1:string&gt;&lt;d37p1:string&gt;System.Core, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d37p1:string&gt;&lt;d37p1:string&gt;System.Xml, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d37p1:string&gt;&lt;d37p1:string&gt;System.Xml.Linq, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d37p1:string&gt;&lt;d37p1:string&gt;System.Data, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d37p1:string&gt;&lt;d37p1:string&gt;System.Data.DataSetExtensions, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d37p1:string&gt;&lt;d37p1:string&gt;System.Runtime.Serialization, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d37p1:string&gt;&lt;d37p1:string&gt;System.ServiceModel, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d37p1:string&gt;&lt;d37p1:string&gt;Newtonsoft.Json, Version=8.0.0.0, Culture=neutral, PublicKeyToken=30ad4fe6b2a6aeed&lt;/d37p1:string&gt;&lt;d37p1:string&gt;Microsoft.CSharp, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a&lt;/d37p1:string&gt;&lt;/ReferencedAssemblies&gt;&lt;TypeName&gt;Type462126ea05c4d04b42064c3255e287&lt;/TypeName&gt;&lt;/ESBMessagePipelineStep&gt;&lt;ESBMessagePipelineStep i:type="d3p1:EsbMessagePipelineExecutionPipelineStep"&gt;&lt;Bindings xmlns:d37p1="http://schemas.datacontract.org/2004/07/Neuron.ComponentModel" /&gt;&lt;BreakPoint&gt;Disable&lt;/BreakPoint&gt;&lt;Disable&gt;false&lt;/Disable&gt;&lt;Id&gt;eec3b363-7baa-41a1-a551-3e801f206d99&lt;/Id&gt;&lt;Name&gt;Create Material Lot&lt;/Name&gt;&lt;Uniquename /&gt;&lt;d3p1:FileName i:nil="true" /&gt;&lt;d3p1:MaxInstances&gt;100&lt;/d3p1:MaxInstances&gt;&lt;d3p1:PipelineName&gt;Process_CreateUpdateMaterialLot&lt;/d3p1:PipelineName&gt;&lt;d3p1:PoolTimeout&gt;PT1M&lt;/d3p1:PoolTimeout&gt;&lt;/ESBMessagePipelineStep&gt;&lt;ESBMessagePipelineStep i:type="d3p1:EsbMessageCSharpCodePipelineStep"&gt;&lt;Bindings xmlns:d37p1="http://schemas.datacontract.org/2004/07/Neuron.ComponentModel" /&gt;&lt;BreakPoint&gt;Disable&lt;/BreakPoint&gt;&lt;Disable&gt;false&lt;/Disable&gt;&lt;Id&gt;cf88b46d-823b-44f9-9c23-1c42963ee971&lt;/Id&gt;&lt;Name&gt;Map From Material Lot &lt;/Name&gt;&lt;Uniquename /&gt;&lt;BreakPointLines xmlns:d37p1="http://schemas.microsoft.com/2003/10/Serialization/Arrays" /&gt;&lt;Code&gt;string materialLotUID = context.Data.GetProperty ("NeoPLM", "MaterialLotUID");

context.Properties ["MaterialLotUID"] = materialLotUID;

context.Instance.TraceInformation ("Process Operations Performance - Transaction ID: " + context.Properties["TransactionID"] + " MaterialLotUID: " + context.Properties["MaterialLotUID"]);&lt;/Code&gt;&lt;ReferencedAssemblies xmlns:d37p1="http://schemas.microsoft.com/2003/10/Serialization/Arrays"&gt;&lt;d37p1:string&gt;Neuron&lt;/d37p1:string&gt;&lt;d37p1:string&gt;Neuron.Pipelines&lt;/d37p1:string&gt;&lt;d37p1:string&gt;Neuron.Esb&lt;/d37p1:string&gt;&lt;d37p1:string&gt;System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d37p1:string&gt;&lt;d37p1:string&gt;System.Core, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d37p1:string&gt;&lt;d37p1:string&gt;System.Xml, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d37p1:string&gt;&lt;d37p1:string&gt;System.Xml.Linq, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d37p1:string&gt;&lt;d37p1:string&gt;System.Data, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d37p1:string&gt;&lt;d37p1:string&gt;System.Data.DataSetExtensions, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d37p1:string&gt;&lt;d37p1:string&gt;System.Runtime.Serialization, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d37p1:string&gt;&lt;d37p1:string&gt;System.ServiceModel, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d37p1:string&gt;&lt;d37p1:string&gt;Newtonsoft.Json, Version=8.0.0.0, Culture=neutral, PublicKeyToken=30ad4fe6b2a6aeed&lt;/d37p1:string&gt;&lt;d37p1:string&gt;Microsoft.CSharp, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a&lt;/d37p1:string&gt;&lt;/ReferencedAssemblies&gt;&lt;TypeName&gt;Type9b5f9b02d894592bae05ea79ecad56&lt;/TypeName&gt;&lt;/ESBMessagePipelineStep&gt;&lt;ESBMessagePipelineStep i:type="DecisionPipelineStepOfESBMessagexAPWb1W4"&gt;&lt;Bindings xmlns:d37p1="http://schemas.datacontract.org/2004/07/Neuron.ComponentModel" /&gt;&lt;BreakPoint&gt;Disable&lt;/BreakPoint&gt;&lt;Disable&gt;false&lt;/Disable&gt;&lt;Id&gt;32be836d-9ff5-493b-9173-025b1e57774a&lt;/Id&gt;&lt;Name&gt;Decision&lt;/Name&gt;&lt;Uniquename /&gt;&lt;Branches&gt;&lt;BranchOfESBMessagexAPWb1W4&gt;&lt;BreakPoint&gt;Disable&lt;/BreakPoint&gt;&lt;Condition i:type="CodeBranchConditionOfESBMessagexAPWb1W4"&gt;&lt;Code&gt;		int count = 0;
		if (context.Properties["ReferencedLots"] != "")
		{		
			var referencedLots = (System.Xml.XmlNode)context.Properties["ReferencedLots"];
			count = referencedLots.ChildNodes.Count;
		}
		
		if (count &amp;gt; 0)
			return true;
		else
			return false;&lt;/Code&gt;&lt;ReferencedAssemblies xmlns:d40p1="http://schemas.microsoft.com/2003/10/Serialization/Arrays"&gt;&lt;d40p1:string&gt;Neuron&lt;/d40p1:string&gt;&lt;d40p1:string&gt;Neuron.Pipelines&lt;/d40p1:string&gt;&lt;d40p1:string&gt;Neuron.Esb&lt;/d40p1:string&gt;&lt;d40p1:string&gt;System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d40p1:string&gt;&lt;d40p1:string&gt;System.Core, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d40p1:string&gt;&lt;d40p1:string&gt;System.Xml, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d40p1:string&gt;&lt;d40p1:string&gt;System.Xml.Linq, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d40p1:string&gt;&lt;d40p1:string&gt;System.Data, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d40p1:string&gt;&lt;d40p1:string&gt;System.Data.DataSetExtensions, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d40p1:string&gt;&lt;d40p1:string&gt;System.Runtime.Serialization, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d40p1:string&gt;&lt;d40p1:string&gt;System.ServiceModel, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d40p1:string&gt;&lt;d40p1:string&gt;Newtonsoft.Json, Version=8.0.0.0, Culture=neutral, PublicKeyToken=30ad4fe6b2a6aeed&lt;/d40p1:string&gt;&lt;d40p1:string&gt;Microsoft.CSharp, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a&lt;/d40p1:string&gt;&lt;/ReferencedAssemblies&gt;&lt;/Condition&gt;&lt;Disable&gt;false&lt;/Disable&gt;&lt;EndJoined&gt;false&lt;/EndJoined&gt;&lt;Name&gt;If&lt;/Name&gt;&lt;Steps&gt;&lt;Bindings xmlns:d40p1="http://schemas.datacontract.org/2004/07/Neuron.ComponentModel" /&gt;&lt;BreakPoint&gt;Disable&lt;/BreakPoint&gt;&lt;Disable&gt;false&lt;/Disable&gt;&lt;Id&gt;353b0af0-f3f9-49d4-8d48-f5296fe4abf6&lt;/Id&gt;&lt;Name&gt;Group&lt;/Name&gt;&lt;Uniquename /&gt;&lt;Children&gt;&lt;ESBMessagePipelineStep i:type="ForEachPipelineStepOfESBMessagexAPWb1W4"&gt;&lt;Bindings xmlns:d42p1="http://schemas.datacontract.org/2004/07/Neuron.ComponentModel" /&gt;&lt;BreakPoint&gt;Disable&lt;/BreakPoint&gt;&lt;Disable&gt;false&lt;/Disable&gt;&lt;Id&gt;34bb321e-2fa4-4ee3-8dff-b6df192418f4&lt;/Id&gt;&lt;Name&gt;ForEach&lt;/Name&gt;&lt;Uniquename /&gt;&lt;Children&gt;&lt;ESBMessagePipelineStep i:type="d3p1:EsbMessageCSharpCodePipelineStep"&gt;&lt;Bindings xmlns:d44p1="http://schemas.datacontract.org/2004/07/Neuron.ComponentModel" /&gt;&lt;BreakPoint&gt;Disable&lt;/BreakPoint&gt;&lt;Disable&gt;false&lt;/Disable&gt;&lt;Id&gt;a7f0bbd0-f0d6-46c2-8dc8-ea507ea5ec19&lt;/Id&gt;&lt;Name&gt;Initialize Properties&lt;/Name&gt;&lt;Uniquename /&gt;&lt;BreakPointLines xmlns:d44p1="http://schemas.microsoft.com/2003/10/Serialization/Arrays" /&gt;&lt;Code&gt;//Load the Material Lot
var materialLot = (System.Xml.XmlNode)context.Properties["ReferencedLot"];

context.Properties["ReferencedLotSourceSystemID"] = "";
context.Properties["ReferencedLotPlantID"] = "";
context.Properties["ReferencedLotMaterialID"] = "";
context.Properties["ReferencedLotMaterialLotID"] = "";

string sourceSystemID = "";
string plantCodeID = "";
string materialID = "";
string materialLotID = "";

//SourceSystemID
foreach(System.Xml.XmlNode node in materialLot.ChildNodes) { if(node.Name == "SourceSystemID") { sourceSystemID = node.InnerText; break; } }

//SourceSystemID
foreach(System.Xml.XmlNode node in materialLot.ChildNodes) { if(node.Name == "PlantID") { plantCodeID = node.InnerText; break; } }

//SourceSystemID
foreach(System.Xml.XmlNode node in materialLot.ChildNodes) { if(node.Name == "MaterialID") { materialID = node.InnerText; break; } }

//SourceSystemID
foreach(System.Xml.XmlNode node in materialLot.ChildNodes) { if(node.Name == "MaterialLotID") { materialLotID = node.InnerText; break; } }

context.Properties["ReferencedLotSourceSystemID"] = sourceSystemID;
context.Properties["ReferencedLotPlantID"] = plantCodeID;
context.Properties["ReferencedLotMaterialID"] = materialID;
context.Properties["ReferencedLotMaterialLotID"] = materialLotID;

context.Instance.TraceInformation ("Process Material Lot - Transaction ID: " + context.Properties["TransactionID"] +  " Referenced Source System ID: " + context.Properties["ReferencedLotSourceSystemID"]);
context.Instance.TraceInformation ("Process Material Lot - Transaction ID: " + context.Properties["TransactionID"] +  " Referenced Plant Code ID: " + context.Properties["ReferencedLotPlantID"]);
context.Instance.TraceInformation ("Process Material Lot - Transaction ID: " + context.Properties["TransactionID"] +  " Referenced MaterialID: " + context.Properties["ReferencedLotMaterialID"]);
context.Instance.TraceInformation ("Process Material Lot - Transaction ID: " + context.Properties["TransactionID"] +  " Referenced MaterialLotID: " + context.Properties["ReferencedLotMaterialLotID"]);&lt;/Code&gt;&lt;ReferencedAssemblies xmlns:d44p1="http://schemas.microsoft.com/2003/10/Serialization/Arrays"&gt;&lt;d44p1:string&gt;Neuron&lt;/d44p1:string&gt;&lt;d44p1:string&gt;Neuron.Pipelines&lt;/d44p1:string&gt;&lt;d44p1:string&gt;Neuron.Esb&lt;/d44p1:string&gt;&lt;d44p1:string&gt;System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d44p1:string&gt;&lt;d44p1:string&gt;System.Core, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d44p1:string&gt;&lt;d44p1:string&gt;System.Xml, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d44p1:string&gt;&lt;d44p1:string&gt;System.Xml.Linq, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d44p1:string&gt;&lt;d44p1:string&gt;System.Data, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d44p1:string&gt;&lt;d44p1:string&gt;System.Data.DataSetExtensions, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d44p1:string&gt;&lt;d44p1:string&gt;System.Runtime.Serialization, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d44p1:string&gt;&lt;d44p1:string&gt;System.ServiceModel, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d44p1:string&gt;&lt;d44p1:string&gt;Newtonsoft.Json, Version=8.0.0.0, Culture=neutral, PublicKeyToken=30ad4fe6b2a6aeed&lt;/d44p1:string&gt;&lt;d44p1:string&gt;Microsoft.CSharp, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a&lt;/d44p1:string&gt;&lt;/ReferencedAssemblies&gt;&lt;TypeName&gt;Type658e4f8c57e4b57b52b1f33da53abc&lt;/TypeName&gt;&lt;/ESBMessagePipelineStep&gt;&lt;ESBMessagePipelineStep i:type="DecisionPipelineStepOfESBMessagexAPWb1W4"&gt;&lt;Bindings xmlns:d44p1="http://schemas.datacontract.org/2004/07/Neuron.ComponentModel" /&gt;&lt;BreakPoint&gt;Disable&lt;/BreakPoint&gt;&lt;Disable&gt;false&lt;/Disable&gt;&lt;Id&gt;de55f7f7-406d-4a40-b80b-299e519585af&lt;/Id&gt;&lt;Name&gt;Decision&lt;/Name&gt;&lt;Uniquename /&gt;&lt;Branches&gt;&lt;BranchOfESBMessagexAPWb1W4&gt;&lt;BreakPoint&gt;Disable&lt;/BreakPoint&gt;&lt;Condition i:type="CodeBranchConditionOfESBMessagexAPWb1W4"&gt;&lt;Code&gt;if (context.Properties["ReferencedLotPlantID"].ToString().ToUpper() != "VENDOR")
	return true;
else
	return false;&lt;/Code&gt;&lt;ReferencedAssemblies xmlns:d47p1="http://schemas.microsoft.com/2003/10/Serialization/Arrays"&gt;&lt;d47p1:string&gt;Neuron&lt;/d47p1:string&gt;&lt;d47p1:string&gt;Neuron.Pipelines&lt;/d47p1:string&gt;&lt;d47p1:string&gt;Neuron.Esb&lt;/d47p1:string&gt;&lt;d47p1:string&gt;System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d47p1:string&gt;&lt;d47p1:string&gt;System.Core, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d47p1:string&gt;&lt;d47p1:string&gt;System.Xml, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d47p1:string&gt;&lt;d47p1:string&gt;System.Xml.Linq, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d47p1:string&gt;&lt;d47p1:string&gt;System.Data, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d47p1:string&gt;&lt;d47p1:string&gt;System.Data.DataSetExtensions, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d47p1:string&gt;&lt;d47p1:string&gt;System.Runtime.Serialization, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d47p1:string&gt;&lt;d47p1:string&gt;System.ServiceModel, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d47p1:string&gt;&lt;d47p1:string&gt;Newtonsoft.Json, Version=8.0.0.0, Culture=neutral, PublicKeyToken=30ad4fe6b2a6aeed&lt;/d47p1:string&gt;&lt;d47p1:string&gt;Microsoft.CSharp, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a&lt;/d47p1:string&gt;&lt;/ReferencedAssemblies&gt;&lt;/Condition&gt;&lt;Disable&gt;false&lt;/Disable&gt;&lt;EndJoined&gt;false&lt;/EndJoined&gt;&lt;Name&gt;Internal Material Lot&lt;/Name&gt;&lt;Steps&gt;&lt;Bindings xmlns:d47p1="http://schemas.datacontract.org/2004/07/Neuron.ComponentModel" /&gt;&lt;BreakPoint&gt;Disable&lt;/BreakPoint&gt;&lt;Disable&gt;false&lt;/Disable&gt;&lt;Id&gt;6c1be9bd-2b79-4042-b8e5-0274b6936559&lt;/Id&gt;&lt;Name&gt;Group&lt;/Name&gt;&lt;Uniquename /&gt;&lt;Children&gt;&lt;ESBMessagePipelineStep i:type="d3p1:EsbMessageCSharpCodePipelineStep"&gt;&lt;Bindings xmlns:d49p1="http://schemas.datacontract.org/2004/07/Neuron.ComponentModel" /&gt;&lt;BreakPoint&gt;Disable&lt;/BreakPoint&gt;&lt;Disable&gt;false&lt;/Disable&gt;&lt;Id&gt;5205bed9-8c99-4063-94d7-353deef46443&lt;/Id&gt;&lt;Name&gt;Map to Reference Lot Lookup&lt;/Name&gt;&lt;Uniquename /&gt;&lt;BreakPointLines xmlns:d49p1="http://schemas.microsoft.com/2003/10/Serialization/Arrays" /&gt;&lt;Code&gt;//Load the Material Lot
var materialLot = (System.Xml.XmlNode)context.Properties["ReferencedLot"];

string sourceSystemID = "";
string plantCodeID = "";
string materialID = "";
string materialLotID = "";

//SourceSystemID
foreach(System.Xml.XmlNode node in materialLot.ChildNodes) { if(node.Name == "SourceSystemID") { sourceSystemID = node.InnerText; break; } }

//SourceSystemID
foreach(System.Xml.XmlNode node in materialLot.ChildNodes) { if(node.Name == "PlantID") { plantCodeID = node.InnerText; break; } }

//SourceSystemID
foreach(System.Xml.XmlNode node in materialLot.ChildNodes) { if(node.Name == "MaterialID") { materialID = node.InnerText; break; } }

//SourceSystemID
foreach(System.Xml.XmlNode node in materialLot.ChildNodes) { if(node.Name == "MaterialLotID") { materialLotID = node.InnerText; break; } }

// Retrieve the response template message
string materialMasterRequestTemplate = context.Configuration.XmlDocs["MasterMasterCompositeRequest"].Xml;

System.Xml.XmlNode messageNode = (System.Xml.XmlNode) context.Properties["MaterialLot"];

string message = System.Net.WebUtility.HtmlEncode (messageNode.OuterXml.ToString());

// Create the response message
string materialMasterRequest = string.Format(materialMasterRequestTemplate, context.Properties["TransactionID"], sourceSystemID, plantCodeID, materialID, "true", message);

//Send the trace message to document the response message.
context.Instance.TraceInformation ("Process Material Lot - Message ID: " + context.Data.Header.MessageId.ToString() + " Request Message: " + materialMasterRequest);
	
// Set message context to the response message 	
context.Data.Text = materialMasterRequest;&lt;/Code&gt;&lt;ReferencedAssemblies xmlns:d49p1="http://schemas.microsoft.com/2003/10/Serialization/Arrays"&gt;&lt;d49p1:string&gt;Neuron&lt;/d49p1:string&gt;&lt;d49p1:string&gt;Neuron.Pipelines&lt;/d49p1:string&gt;&lt;d49p1:string&gt;Neuron.Esb&lt;/d49p1:string&gt;&lt;d49p1:string&gt;System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d49p1:string&gt;&lt;d49p1:string&gt;System.Core, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d49p1:string&gt;&lt;d49p1:string&gt;System.Xml, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d49p1:string&gt;&lt;d49p1:string&gt;System.Xml.Linq, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d49p1:string&gt;&lt;d49p1:string&gt;System.Data, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d49p1:string&gt;&lt;d49p1:string&gt;System.Data.DataSetExtensions, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d49p1:string&gt;&lt;d49p1:string&gt;System.Runtime.Serialization, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d49p1:string&gt;&lt;d49p1:string&gt;System.ServiceModel, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d49p1:string&gt;&lt;d49p1:string&gt;Newtonsoft.Json, Version=8.0.0.0, Culture=neutral, PublicKeyToken=30ad4fe6b2a6aeed&lt;/d49p1:string&gt;&lt;d49p1:string&gt;Microsoft.CSharp, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a&lt;/d49p1:string&gt;&lt;/ReferencedAssemblies&gt;&lt;TypeName&gt;Type07b8779e7f040f19ec9e76dd1f80eb&lt;/TypeName&gt;&lt;/ESBMessagePipelineStep&gt;&lt;ESBMessagePipelineStep i:type="d3p1:EsbMessagePipelineExecutionPipelineStep"&gt;&lt;Bindings xmlns:d49p1="http://schemas.datacontract.org/2004/07/Neuron.ComponentModel" /&gt;&lt;BreakPoint&gt;Disable&lt;/BreakPoint&gt;&lt;Disable&gt;false&lt;/Disable&gt;&lt;Id&gt;1c079ef1-7436-4068-8e25-6aab5269909b&lt;/Id&gt;&lt;Name&gt;Referenced Lot Material Composite&lt;/Name&gt;&lt;Uniquename /&gt;&lt;d3p1:FileName i:nil="true" /&gt;&lt;d3p1:MaxInstances&gt;100&lt;/d3p1:MaxInstances&gt;&lt;d3p1:PipelineName&gt;Process_GetMaterialMasterComposite&lt;/d3p1:PipelineName&gt;&lt;d3p1:PoolTimeout&gt;PT1M&lt;/d3p1:PoolTimeout&gt;&lt;/ESBMessagePipelineStep&gt;&lt;ESBMessagePipelineStep i:type="d3p1:EsbMessageCSharpCodePipelineStep"&gt;&lt;Bindings xmlns:d49p1="http://schemas.datacontract.org/2004/07/Neuron.ComponentModel" /&gt;&lt;BreakPoint&gt;Disable&lt;/BreakPoint&gt;&lt;Disable&gt;false&lt;/Disable&gt;&lt;Id&gt;b8df802b-8c3e-4b98-b31a-5ed17224e9c9&lt;/Id&gt;&lt;Name&gt;Map From Referenced Lot Lookup&lt;/Name&gt;&lt;Uniquename /&gt;&lt;BreakPointLines xmlns:d49p1="http://schemas.microsoft.com/2003/10/Serialization/Arrays" /&gt;&lt;Code&gt;string facilityUID = context.Data.GetProperty("NeoPLM", "FacilityUID");
context.Properties ["ReferencedLotFacilityUID"] = facilityUID;
context.Instance.TraceInformation ("Process Material Lot - Transaction ID: " + context.Properties["TransactionID"] + " Referenced Lot FacilityUID: " + context.Properties["ReferencedLotFacilityUID"]);

string plantCodeUID = context.Data.GetProperty("NeoPLM", "PlantCodeUID");
context.Properties ["ReferencedLotPlantCodeUID"] = plantCodeUID;
context.Instance.TraceInformation ("Process Material Lot - Transaction ID: " + context.Properties["TransactionID"] + " Referenced Lot PlantCodeUID: " + context.Properties["ReferencedLotPlantCodeUID"]);

string materialUID = context.Data.GetProperty("NeoPLM", "MaterialUID");
context.Properties ["ReferencedLotMaterialUID"] = materialUID;
context.Instance.TraceInformation ("Process Material Lot - Transaction ID: " + context.Properties["TransactionID"] + " Referenced Lot MaterialUID: " + context.Properties["ReferencedLotMaterialUID"]);

string neoMaterialType = context.Data.GetProperty("NeoPLM", "NeoMaterialType");
context.Properties ["ReferencedLotNeoMaterialType"] = neoMaterialType;
context.Instance.TraceInformation ("Process Material Lot - Transaction ID: " + context.Properties["TransactionID"] + " Referenced Lot NeoMaterialType: " + context.Properties["ReferencedLotNeoMaterialType"]);

&lt;/Code&gt;&lt;ReferencedAssemblies xmlns:d49p1="http://schemas.microsoft.com/2003/10/Serialization/Arrays"&gt;&lt;d49p1:string&gt;Neuron&lt;/d49p1:string&gt;&lt;d49p1:string&gt;Neuron.Pipelines&lt;/d49p1:string&gt;&lt;d49p1:string&gt;Neuron.Esb&lt;/d49p1:string&gt;&lt;d49p1:string&gt;System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d49p1:string&gt;&lt;d49p1:string&gt;System.Core, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d49p1:string&gt;&lt;d49p1:string&gt;System.Xml, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d49p1:string&gt;&lt;d49p1:string&gt;System.Xml.Linq, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d49p1:string&gt;&lt;d49p1:string&gt;System.Data, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d49p1:string&gt;&lt;d49p1:string&gt;System.Data.DataSetExtensions, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d49p1:string&gt;&lt;d49p1:string&gt;System.Runtime.Serialization, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d49p1:string&gt;&lt;d49p1:string&gt;System.ServiceModel, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d49p1:string&gt;&lt;d49p1:string&gt;Newtonsoft.Json, Version=8.0.0.0, Culture=neutral, PublicKeyToken=30ad4fe6b2a6aeed&lt;/d49p1:string&gt;&lt;d49p1:string&gt;Microsoft.CSharp, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a&lt;/d49p1:string&gt;&lt;/ReferencedAssemblies&gt;&lt;TypeName&gt;Typea6b20f589444f45841b22d29e8ef62&lt;/TypeName&gt;&lt;/ESBMessagePipelineStep&gt;&lt;ESBMessagePipelineStep i:type="DecisionPipelineStepOfESBMessagexAPWb1W4"&gt;&lt;Bindings xmlns:d49p1="http://schemas.datacontract.org/2004/07/Neuron.ComponentModel" /&gt;&lt;BreakPoint&gt;Disable&lt;/BreakPoint&gt;&lt;Disable&gt;false&lt;/Disable&gt;&lt;Id&gt;edff6b7e-978f-4813-af11-744ba81ece27&lt;/Id&gt;&lt;Name&gt;Decision&lt;/Name&gt;&lt;Uniquename /&gt;&lt;Branches&gt;&lt;BranchOfESBMessagexAPWb1W4&gt;&lt;BreakPoint&gt;Disable&lt;/BreakPoint&gt;&lt;Condition i:type="CodeBranchConditionOfESBMessagexAPWb1W4"&gt;&lt;Code&gt;if (context.Properties["ReferencedLotFacilityUID"].ToString()  != System.Guid.Empty.ToString() &amp;amp;&amp;amp;
	context.Properties["ReferencedLotPlantCodeUID"].ToString() != System.Guid.Empty.ToString() &amp;amp;&amp;amp;
	context.Properties["ReferencedLotMaterialUID"].ToString() != System.Guid.Empty.ToString()) 
{
	return true;
}
else
{
	return false;
}&lt;/Code&gt;&lt;ReferencedAssemblies xmlns:d52p1="http://schemas.microsoft.com/2003/10/Serialization/Arrays"&gt;&lt;d52p1:string&gt;Neuron&lt;/d52p1:string&gt;&lt;d52p1:string&gt;Neuron.Pipelines&lt;/d52p1:string&gt;&lt;d52p1:string&gt;Neuron.Esb&lt;/d52p1:string&gt;&lt;d52p1:string&gt;System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d52p1:string&gt;&lt;d52p1:string&gt;System.Core, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d52p1:string&gt;&lt;d52p1:string&gt;System.Xml, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d52p1:string&gt;&lt;d52p1:string&gt;System.Xml.Linq, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d52p1:string&gt;&lt;d52p1:string&gt;System.Data, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d52p1:string&gt;&lt;d52p1:string&gt;System.Data.DataSetExtensions, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d52p1:string&gt;&lt;d52p1:string&gt;System.Runtime.Serialization, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d52p1:string&gt;&lt;d52p1:string&gt;System.ServiceModel, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d52p1:string&gt;&lt;d52p1:string&gt;Newtonsoft.Json, Version=8.0.0.0, Culture=neutral, PublicKeyToken=30ad4fe6b2a6aeed&lt;/d52p1:string&gt;&lt;d52p1:string&gt;Microsoft.CSharp, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a&lt;/d52p1:string&gt;&lt;/ReferencedAssemblies&gt;&lt;/Condition&gt;&lt;Disable&gt;false&lt;/Disable&gt;&lt;EndJoined&gt;false&lt;/EndJoined&gt;&lt;Name&gt;If&lt;/Name&gt;&lt;Steps&gt;&lt;Bindings xmlns:d52p1="http://schemas.datacontract.org/2004/07/Neuron.ComponentModel" /&gt;&lt;BreakPoint&gt;Disable&lt;/BreakPoint&gt;&lt;Disable&gt;false&lt;/Disable&gt;&lt;Id&gt;95da1b30-a4d9-4db8-b202-98fe8661f70e&lt;/Id&gt;&lt;Name&gt;Group&lt;/Name&gt;&lt;Uniquename /&gt;&lt;Children&gt;&lt;ESBMessagePipelineStep i:type="d3p1:EsbMessageCSharpCodePipelineStep"&gt;&lt;Bindings xmlns:d54p1="http://schemas.datacontract.org/2004/07/Neuron.ComponentModel" /&gt;&lt;BreakPoint&gt;Disable&lt;/BreakPoint&gt;&lt;Disable&gt;false&lt;/Disable&gt;&lt;Id&gt;768b02c3-1c6c-413f-871e-b5a3ec613704&lt;/Id&gt;&lt;Name&gt;Map To Local URI&lt;/Name&gt;&lt;Uniquename /&gt;&lt;BreakPointLines xmlns:d54p1="http://schemas.microsoft.com/2003/10/Serialization/Arrays" /&gt;&lt;Code&gt;// Retrieve the response template message
string localServiceURIRequestTemplate = context.Configuration.XmlDocs["LocalServiceURIRequest"].Xml;
	
System.Xml.XmlNode node = (System.Xml.XmlNode) context.Properties["MaterialLot"];

string message = System.Net.WebUtility.HtmlEncode (node.OuterXml.ToString());

// Create the request message
string localServiceURIRequest = string.Format(localServiceURIRequestTemplate, context.Properties["TransactionID"], context.Properties["ReferencedLotFacilityUID"], message);

//Send the trace message to document the request message.
context.Instance.TraceInformation ("Process Material Lot - Message ID: " + context.Data.Header.MessageId.ToString() + " Request Message: " + localServiceURIRequest);
	
// Set message context to the request message 	
context.Data.Text = localServiceURIRequest;&lt;/Code&gt;&lt;ReferencedAssemblies xmlns:d54p1="http://schemas.microsoft.com/2003/10/Serialization/Arrays"&gt;&lt;d54p1:string&gt;Neuron&lt;/d54p1:string&gt;&lt;d54p1:string&gt;Neuron.Pipelines&lt;/d54p1:string&gt;&lt;d54p1:string&gt;Neuron.Esb&lt;/d54p1:string&gt;&lt;d54p1:string&gt;System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d54p1:string&gt;&lt;d54p1:string&gt;System.Core, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d54p1:string&gt;&lt;d54p1:string&gt;System.Xml, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d54p1:string&gt;&lt;d54p1:string&gt;System.Xml.Linq, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d54p1:string&gt;&lt;d54p1:string&gt;System.Data, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d54p1:string&gt;&lt;d54p1:string&gt;System.Data.DataSetExtensions, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d54p1:string&gt;&lt;d54p1:string&gt;System.Runtime.Serialization, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d54p1:string&gt;&lt;d54p1:string&gt;System.ServiceModel, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d54p1:string&gt;&lt;d54p1:string&gt;Newtonsoft.Json, Version=8.0.0.0, Culture=neutral, PublicKeyToken=30ad4fe6b2a6aeed&lt;/d54p1:string&gt;&lt;d54p1:string&gt;Microsoft.CSharp, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a&lt;/d54p1:string&gt;&lt;/ReferencedAssemblies&gt;&lt;TypeName&gt;Type462126ea05c4d04b42064c3255e287&lt;/TypeName&gt;&lt;/ESBMessagePipelineStep&gt;&lt;ESBMessagePipelineStep i:type="d3p1:EsbMessagePipelineExecutionPipelineStep"&gt;&lt;Bindings xmlns:d54p1="http://schemas.datacontract.org/2004/07/Neuron.ComponentModel" /&gt;&lt;BreakPoint&gt;Disable&lt;/BreakPoint&gt;&lt;Disable&gt;false&lt;/Disable&gt;&lt;Id&gt;11310705-b414-415e-afaf-a2ccbd2a54a3&lt;/Id&gt;&lt;Name&gt;Local URI&lt;/Name&gt;&lt;Uniquename /&gt;&lt;d3p1:FileName i:nil="true" /&gt;&lt;d3p1:MaxInstances&gt;100&lt;/d3p1:MaxInstances&gt;&lt;d3p1:PipelineName&gt;Process_GetLocalServiceURI - New&lt;/d3p1:PipelineName&gt;&lt;d3p1:PoolTimeout&gt;PT1M&lt;/d3p1:PoolTimeout&gt;&lt;/ESBMessagePipelineStep&gt;&lt;ESBMessagePipelineStep i:type="d3p1:EsbMessageCSharpCodePipelineStep"&gt;&lt;Bindings xmlns:d54p1="http://schemas.datacontract.org/2004/07/Neuron.ComponentModel" /&gt;&lt;BreakPoint&gt;Disable&lt;/BreakPoint&gt;&lt;Disable&gt;false&lt;/Disable&gt;&lt;Id&gt;28cd88be-5845-46a4-b9da-24de5c685d0d&lt;/Id&gt;&lt;Name&gt;Map From Local URI&lt;/Name&gt;&lt;Uniquename /&gt;&lt;BreakPointLines xmlns:d54p1="http://schemas.microsoft.com/2003/10/Serialization/Arrays" /&gt;&lt;Code&gt;string localServiceURI = context.Data.ToXmlDocument().SelectSingleNode("/*[local-name()='LocalServiceURIResponse' and namespace-uri()='http://NeoPLM.com/EnterpriseIntegration']/*[local-name()='LocalServiceURI' and namespace-uri()='http://NeoPLM.com/EnterpriseIntegration']").InnerText;

context.Properties ["ReferencedLotLocalServiceURI"] = localServiceURI;

context.Instance.TraceInformation ("Process Material Lot - Transaction ID: " + context.Properties["TransactionID"] + " Referenced LotLocalServiceURI: " + context.Properties["ReferencedLotLocalServiceURI"]);&lt;/Code&gt;&lt;ReferencedAssemblies xmlns:d54p1="http://schemas.microsoft.com/2003/10/Serialization/Arrays"&gt;&lt;d54p1:string&gt;Neuron&lt;/d54p1:string&gt;&lt;d54p1:string&gt;Neuron.Pipelines&lt;/d54p1:string&gt;&lt;d54p1:string&gt;Neuron.Esb&lt;/d54p1:string&gt;&lt;d54p1:string&gt;System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d54p1:string&gt;&lt;d54p1:string&gt;System.Core, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d54p1:string&gt;&lt;d54p1:string&gt;System.Xml, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d54p1:string&gt;&lt;d54p1:string&gt;System.Xml.Linq, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d54p1:string&gt;&lt;d54p1:string&gt;System.Data, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d54p1:string&gt;&lt;d54p1:string&gt;System.Data.DataSetExtensions, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d54p1:string&gt;&lt;d54p1:string&gt;System.Runtime.Serialization, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d54p1:string&gt;&lt;d54p1:string&gt;System.ServiceModel, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d54p1:string&gt;&lt;d54p1:string&gt;Newtonsoft.Json, Version=8.0.0.0, Culture=neutral, PublicKeyToken=30ad4fe6b2a6aeed&lt;/d54p1:string&gt;&lt;d54p1:string&gt;Microsoft.CSharp, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a&lt;/d54p1:string&gt;&lt;/ReferencedAssemblies&gt;&lt;TypeName&gt;Type9b5f9b02d894592bae05ea79ecad56&lt;/TypeName&gt;&lt;/ESBMessagePipelineStep&gt;&lt;ESBMessagePipelineStep i:type="d3p1:EsbMessageCSharpCodePipelineStep"&gt;&lt;Bindings xmlns:d54p1="http://schemas.datacontract.org/2004/07/Neuron.ComponentModel" /&gt;&lt;BreakPoint&gt;Disable&lt;/BreakPoint&gt;&lt;Disable&gt;false&lt;/Disable&gt;&lt;Id&gt;28505fea-2647-402f-a87a-9a6aa8b35421&lt;/Id&gt;&lt;Name&gt;Map To Create Referenced Material Lot&lt;/Name&gt;&lt;Uniquename /&gt;&lt;BreakPointLines xmlns:d54p1="http://schemas.microsoft.com/2003/10/Serialization/Arrays" /&gt;&lt;Code&gt;// Retrieve the response template message
string materialLotRequestTemplate = context.Configuration.XmlDocs["MaterialLotSave"].Xml;

// This is a placeholder material Lot.  These properties are set to the default values below.
string externalStatus = "";
string externalStatusDescription = "";
string lotStatus = "20";
string potency = "100";
string potencyLabel = "";
string potencyUnits = System.Guid.Empty.ToString();
string supplierID = "";
string supplierName = "";
string supplierLotID = "";
string lastModified = System.DateTime.UtcNow.ToString("yyyy-MM-ddTHH:mm:ssZ");

System.DateTime dt = System.DateTime.Parse(context.Properties["LastUpdateDateTime"].ToString());

string sourceLastModified = dt.ToUniversalTime().ToString ("yyyy-MM-ddTHH:mm:ssZ");

// Create the request message
string materialLotRequest = string.Format(materialLotRequestTemplate, "Create", context.Properties["ReferencedLotLocalServiceURI"], 
	                        context.Properties["ReferencedLotMaterialLotID"], context.Properties["ReferencedLotFacilityUID"], 
	                        context.Properties["ReferencedLotPlantCodeUID"], context.Properties["ReferencedLotMaterialUID"], 
	                        context.Properties["ReferencedLotNeoMaterialType"], externalStatus, externalStatusDescription, 
	                        lotStatus, potency, potencyLabel, potencyUnits, supplierID, supplierName, 
	                        supplierLotID, lastModified, sourceLastModified );

//Send the trace message to document the request message.
context.Instance.TraceInformation ("Process Material Lot - Message ID: " + context.Data.Header.MessageId.ToString() + " Request Message: " + materialLotRequest);
	
// Set message context to the request message 	
context.Data.Text = materialLotRequest;&lt;/Code&gt;&lt;ReferencedAssemblies xmlns:d54p1="http://schemas.microsoft.com/2003/10/Serialization/Arrays"&gt;&lt;d54p1:string&gt;Neuron&lt;/d54p1:string&gt;&lt;d54p1:string&gt;Neuron.Pipelines&lt;/d54p1:string&gt;&lt;d54p1:string&gt;Neuron.Esb&lt;/d54p1:string&gt;&lt;d54p1:string&gt;System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d54p1:string&gt;&lt;d54p1:string&gt;System.Core, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d54p1:string&gt;&lt;d54p1:string&gt;System.Xml, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d54p1:string&gt;&lt;d54p1:string&gt;System.Xml.Linq, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d54p1:string&gt;&lt;d54p1:string&gt;System.Data, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d54p1:string&gt;&lt;d54p1:string&gt;System.Data.DataSetExtensions, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d54p1:string&gt;&lt;d54p1:string&gt;System.Runtime.Serialization, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d54p1:string&gt;&lt;d54p1:string&gt;System.ServiceModel, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d54p1:string&gt;&lt;d54p1:string&gt;Newtonsoft.Json, Version=8.0.0.0, Culture=neutral, PublicKeyToken=30ad4fe6b2a6aeed&lt;/d54p1:string&gt;&lt;d54p1:string&gt;Microsoft.CSharp, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a&lt;/d54p1:string&gt;&lt;/ReferencedAssemblies&gt;&lt;TypeName&gt;Type7b9ea41dd4b4ed293caf0dbbd42b76&lt;/TypeName&gt;&lt;/ESBMessagePipelineStep&gt;&lt;ESBMessagePipelineStep i:type="d3p1:EsbMessagePipelineExecutionPipelineStep"&gt;&lt;Bindings xmlns:d54p1="http://schemas.datacontract.org/2004/07/Neuron.ComponentModel" /&gt;&lt;BreakPoint&gt;Disable&lt;/BreakPoint&gt;&lt;Disable&gt;false&lt;/Disable&gt;&lt;Id&gt;ece9b6e6-1f0a-4a19-a818-4a103d1d0706&lt;/Id&gt;&lt;Name&gt;Create Referenced Material Lot&lt;/Name&gt;&lt;Uniquename /&gt;&lt;d3p1:FileName i:nil="true" /&gt;&lt;d3p1:MaxInstances&gt;100&lt;/d3p1:MaxInstances&gt;&lt;d3p1:PipelineName&gt;Process_CreateUpdateMaterialLot&lt;/d3p1:PipelineName&gt;&lt;d3p1:PoolTimeout&gt;PT1M&lt;/d3p1:PoolTimeout&gt;&lt;/ESBMessagePipelineStep&gt;&lt;ESBMessagePipelineStep i:type="d3p1:EsbMessageCSharpCodePipelineStep"&gt;&lt;Bindings xmlns:d54p1="http://schemas.datacontract.org/2004/07/Neuron.ComponentModel" /&gt;&lt;BreakPoint&gt;Disable&lt;/BreakPoint&gt;&lt;Disable&gt;false&lt;/Disable&gt;&lt;Id&gt;fd6396ad-6d6a-47ac-b7a1-07eb1e337262&lt;/Id&gt;&lt;Name&gt;Map From Create Material Lot&lt;/Name&gt;&lt;Uniquename /&gt;&lt;BreakPointLines xmlns:d54p1="http://schemas.microsoft.com/2003/10/Serialization/Arrays" /&gt;&lt;Code&gt;string materialLotUID = context.Data.GetProperty ("NeoPLM", "MaterialLotUID");

context.Properties ["ReferencedLotMaterialLotUID"] = materialLotUID;

context.Instance.TraceInformation ("Process Material Lot - Transaction ID: " + context.Properties["TransactionID"] + " Referenced MaterialLotUID: " + context.Properties["ReferencedLotMaterialLotUID"]);&lt;/Code&gt;&lt;ReferencedAssemblies xmlns:d54p1="http://schemas.microsoft.com/2003/10/Serialization/Arrays"&gt;&lt;d54p1:string&gt;Neuron&lt;/d54p1:string&gt;&lt;d54p1:string&gt;Neuron.Pipelines&lt;/d54p1:string&gt;&lt;d54p1:string&gt;Neuron.Esb&lt;/d54p1:string&gt;&lt;d54p1:string&gt;System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d54p1:string&gt;&lt;d54p1:string&gt;System.Core, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d54p1:string&gt;&lt;d54p1:string&gt;System.Xml, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d54p1:string&gt;&lt;d54p1:string&gt;System.Xml.Linq, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d54p1:string&gt;&lt;d54p1:string&gt;System.Data, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d54p1:string&gt;&lt;d54p1:string&gt;System.Data.DataSetExtensions, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d54p1:string&gt;&lt;d54p1:string&gt;System.Runtime.Serialization, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d54p1:string&gt;&lt;d54p1:string&gt;System.ServiceModel, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d54p1:string&gt;&lt;d54p1:string&gt;Newtonsoft.Json, Version=8.0.0.0, Culture=neutral, PublicKeyToken=30ad4fe6b2a6aeed&lt;/d54p1:string&gt;&lt;d54p1:string&gt;Microsoft.CSharp, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a&lt;/d54p1:string&gt;&lt;/ReferencedAssemblies&gt;&lt;TypeName&gt;Typece568c3124e4400a5ac44bc4bf86e0&lt;/TypeName&gt;&lt;/ESBMessagePipelineStep&gt;&lt;ESBMessagePipelineStep i:type="d3p1:EsbMessageCSharpCodePipelineStep"&gt;&lt;Bindings xmlns:d54p1="http://schemas.datacontract.org/2004/07/Neuron.ComponentModel" /&gt;&lt;BreakPoint&gt;Disable&lt;/BreakPoint&gt;&lt;Disable&gt;false&lt;/Disable&gt;&lt;Id&gt;c3c0a660-c2ac-4238-b22f-0ef81b190076&lt;/Id&gt;&lt;Name&gt;Map To Create Material Lot Ancestor Maps&lt;/Name&gt;&lt;Uniquename /&gt;&lt;BreakPointLines xmlns:d54p1="http://schemas.microsoft.com/2003/10/Serialization/Arrays" /&gt;&lt;Code&gt;// Retrieve the response template message
string mLAMRequestTemplate = context.Configuration.XmlDocs["MaterialLotAncestorMapSaveRequest"].Xml;

// Create the request message
string mLAMRequest = string.Format(mLAMRequestTemplate, "Create", context.Properties["LocalServiceURI"], 
	                        context.Properties["MaterialLotUID"], context.Properties["ReferencedLotMaterialLotUID"], 
	                        context.Properties["ReferencedLotFacilityUID"], "");

//Send the trace message to document the request message.
context.Instance.TraceInformation ("Process Material Lot - Message ID: " + context.Data.Header.MessageId.ToString() + " Request Message: " + mLAMRequest);
	
// Set message context to the request message 	
context.Data.Text = mLAMRequest;&lt;/Code&gt;&lt;ReferencedAssemblies xmlns:d54p1="http://schemas.microsoft.com/2003/10/Serialization/Arrays"&gt;&lt;d54p1:string&gt;Neuron&lt;/d54p1:string&gt;&lt;d54p1:string&gt;Neuron.Pipelines&lt;/d54p1:string&gt;&lt;d54p1:string&gt;Neuron.Esb&lt;/d54p1:string&gt;&lt;d54p1:string&gt;System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d54p1:string&gt;&lt;d54p1:string&gt;System.Core, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d54p1:string&gt;&lt;d54p1:string&gt;System.Xml, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d54p1:string&gt;&lt;d54p1:string&gt;System.Xml.Linq, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d54p1:string&gt;&lt;d54p1:string&gt;System.Data, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d54p1:string&gt;&lt;d54p1:string&gt;System.Data.DataSetExtensions, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d54p1:string&gt;&lt;d54p1:string&gt;System.Runtime.Serialization, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d54p1:string&gt;&lt;d54p1:string&gt;System.ServiceModel, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d54p1:string&gt;&lt;d54p1:string&gt;Newtonsoft.Json, Version=8.0.0.0, Culture=neutral, PublicKeyToken=30ad4fe6b2a6aeed&lt;/d54p1:string&gt;&lt;d54p1:string&gt;Microsoft.CSharp, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a&lt;/d54p1:string&gt;&lt;/ReferencedAssemblies&gt;&lt;TypeName&gt;Type7b9ea41dd4b4ed293caf0dbbd42b76&lt;/TypeName&gt;&lt;/ESBMessagePipelineStep&gt;&lt;ESBMessagePipelineStep i:type="d3p1:EsbMessagePipelineExecutionPipelineStep"&gt;&lt;Bindings xmlns:d54p1="http://schemas.datacontract.org/2004/07/Neuron.ComponentModel" /&gt;&lt;BreakPoint&gt;Disable&lt;/BreakPoint&gt;&lt;Disable&gt;false&lt;/Disable&gt;&lt;Id&gt;7c77ed87-f934-456a-abed-365101c9c197&lt;/Id&gt;&lt;Name&gt;Create Material Lot Ancestor Map&lt;/Name&gt;&lt;Uniquename /&gt;&lt;d3p1:FileName i:nil="true" /&gt;&lt;d3p1:MaxInstances&gt;100&lt;/d3p1:MaxInstances&gt;&lt;d3p1:PipelineName&gt;Process_CreateUpdateMaterialLotAncestors&lt;/d3p1:PipelineName&gt;&lt;d3p1:PoolTimeout&gt;PT1M&lt;/d3p1:PoolTimeout&gt;&lt;/ESBMessagePipelineStep&gt;&lt;ESBMessagePipelineStep i:type="d3p1:EsbMessageCSharpCodePipelineStep"&gt;&lt;Bindings xmlns:d54p1="http://schemas.datacontract.org/2004/07/Neuron.ComponentModel" /&gt;&lt;BreakPoint&gt;Disable&lt;/BreakPoint&gt;&lt;Disable&gt;false&lt;/Disable&gt;&lt;Id&gt;ce4847d0-9047-436e-8cba-946318a7a909&lt;/Id&gt;&lt;Name&gt;Map From Create Material Lot Ancestor Map&lt;/Name&gt;&lt;Uniquename /&gt;&lt;BreakPointLines xmlns:d54p1="http://schemas.microsoft.com/2003/10/Serialization/Arrays" /&gt;&lt;Code&gt;string mLAMUID = context.Data.GetProperty ("NeoPLM", "MaterialLotAncestorMapUID");

context.Instance.TraceInformation ("Process Material Lot - Transaction ID: " + context.Properties["TransactionID"] + " Referenced MaterialLotAncestorMapUID: " + mLAMUID);&lt;/Code&gt;&lt;ReferencedAssemblies xmlns:d54p1="http://schemas.microsoft.com/2003/10/Serialization/Arrays"&gt;&lt;d54p1:string&gt;Neuron&lt;/d54p1:string&gt;&lt;d54p1:string&gt;Neuron.Pipelines&lt;/d54p1:string&gt;&lt;d54p1:string&gt;Neuron.Esb&lt;/d54p1:string&gt;&lt;d54p1:string&gt;System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d54p1:string&gt;&lt;d54p1:string&gt;System.Core, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d54p1:string&gt;&lt;d54p1:string&gt;System.Xml, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d54p1:string&gt;&lt;d54p1:string&gt;System.Xml.Linq, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d54p1:string&gt;&lt;d54p1:string&gt;System.Data, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d54p1:string&gt;&lt;d54p1:string&gt;System.Data.DataSetExtensions, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d54p1:string&gt;&lt;d54p1:string&gt;System.Runtime.Serialization, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d54p1:string&gt;&lt;d54p1:string&gt;System.ServiceModel, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d54p1:string&gt;&lt;d54p1:string&gt;Newtonsoft.Json, Version=8.0.0.0, Culture=neutral, PublicKeyToken=30ad4fe6b2a6aeed&lt;/d54p1:string&gt;&lt;d54p1:string&gt;Microsoft.CSharp, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a&lt;/d54p1:string&gt;&lt;/ReferencedAssemblies&gt;&lt;TypeName&gt;Typece568c3124e4400a5ac44bc4bf86e0&lt;/TypeName&gt;&lt;/ESBMessagePipelineStep&gt;&lt;/Children&gt;&lt;/Steps&gt;&lt;/BranchOfESBMessagexAPWb1W4&gt;&lt;BranchOfESBMessagexAPWb1W4&gt;&lt;BreakPoint&gt;Disable&lt;/BreakPoint&gt;&lt;Condition i:type="AlwaysBranchConditionOfESBMessagexAPWb1W4" /&gt;&lt;Disable&gt;false&lt;/Disable&gt;&lt;EndJoined&gt;false&lt;/EndJoined&gt;&lt;Name&gt;Else&lt;/Name&gt;&lt;Steps&gt;&lt;Bindings xmlns:d52p1="http://schemas.datacontract.org/2004/07/Neuron.ComponentModel" /&gt;&lt;BreakPoint&gt;Disable&lt;/BreakPoint&gt;&lt;Disable&gt;false&lt;/Disable&gt;&lt;Id&gt;8c0b78f1-4042-4eb8-9e14-9492e3fbcd3c&lt;/Id&gt;&lt;Name&gt;Group&lt;/Name&gt;&lt;Uniquename /&gt;&lt;Children&gt;&lt;ESBMessagePipelineStep i:type="d3p1:EsbMessageCSharpCodePipelineStep"&gt;&lt;Bindings xmlns:d54p1="http://schemas.datacontract.org/2004/07/Neuron.ComponentModel" /&gt;&lt;BreakPoint&gt;Disable&lt;/BreakPoint&gt;&lt;Disable&gt;false&lt;/Disable&gt;&lt;Id&gt;669aa0cb-2697-4e6b-aedd-1adaa9fa6f9f&lt;/Id&gt;&lt;Name&gt;Map To Get Referenced Material Lot&lt;/Name&gt;&lt;Uniquename /&gt;&lt;BreakPointLines xmlns:d54p1="http://schemas.microsoft.com/2003/10/Serialization/Arrays" /&gt;&lt;Code&gt;// Retrieve the response template message
string mLAMRequestTemplate = context.Configuration.XmlDocs["MaterialLotAncestorRequest"].Xml;

// Create the request message
string mLAMRequest = string.Format (mLAMRequestTemplate, context.Properties["TransactionID"], 
	                                context.Properties["LocalServiceURI"], context.Properties["MaterialLotUID"], 
									System.Guid.Empty.ToString(), "true", context.Properties["MaterialLot"].ToString());

//Send the trace message to document the request message.
context.Instance.TraceInformation ("Process Material Lot - Message ID: " + context.Data.Header.MessageId.ToString() + " Request Message: " + mLAMRequest);
	
// Set message context to the request message 	
context.Data.Text = mLAMRequest;&lt;/Code&gt;&lt;ReferencedAssemblies xmlns:d54p1="http://schemas.microsoft.com/2003/10/Serialization/Arrays"&gt;&lt;d54p1:string&gt;Neuron&lt;/d54p1:string&gt;&lt;d54p1:string&gt;Neuron.Pipelines&lt;/d54p1:string&gt;&lt;d54p1:string&gt;Neuron.Esb&lt;/d54p1:string&gt;&lt;d54p1:string&gt;System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d54p1:string&gt;&lt;d54p1:string&gt;System.Core, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d54p1:string&gt;&lt;d54p1:string&gt;System.Xml, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d54p1:string&gt;&lt;d54p1:string&gt;System.Xml.Linq, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d54p1:string&gt;&lt;d54p1:string&gt;System.Data, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d54p1:string&gt;&lt;d54p1:string&gt;System.Data.DataSetExtensions, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d54p1:string&gt;&lt;d54p1:string&gt;System.Runtime.Serialization, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d54p1:string&gt;&lt;d54p1:string&gt;System.ServiceModel, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d54p1:string&gt;&lt;d54p1:string&gt;Newtonsoft.Json, Version=8.0.0.0, Culture=neutral, PublicKeyToken=30ad4fe6b2a6aeed&lt;/d54p1:string&gt;&lt;d54p1:string&gt;Microsoft.CSharp, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a&lt;/d54p1:string&gt;&lt;/ReferencedAssemblies&gt;&lt;TypeName&gt;Type7b9ea41dd4b4ed293caf0dbbd42b76&lt;/TypeName&gt;&lt;/ESBMessagePipelineStep&gt;&lt;ESBMessagePipelineStep i:type="d3p1:EsbMessagePipelineExecutionPipelineStep"&gt;&lt;Bindings xmlns:d54p1="http://schemas.datacontract.org/2004/07/Neuron.ComponentModel" /&gt;&lt;BreakPoint&gt;Disable&lt;/BreakPoint&gt;&lt;Disable&gt;false&lt;/Disable&gt;&lt;Id&gt;b42e8492-0aa0-4e38-8d1f-6583cafd60ac&lt;/Id&gt;&lt;Name&gt;Get Referenced Material Lot Map&lt;/Name&gt;&lt;Uniquename /&gt;&lt;d3p1:FileName i:nil="true" /&gt;&lt;d3p1:MaxInstances&gt;100&lt;/d3p1:MaxInstances&gt;&lt;d3p1:PipelineName&gt;Process_GetMaterialLotAncestors-New&lt;/d3p1:PipelineName&gt;&lt;d3p1:PoolTimeout&gt;PT1M&lt;/d3p1:PoolTimeout&gt;&lt;/ESBMessagePipelineStep&gt;&lt;ESBMessagePipelineStep i:type="d3p1:EsbMessageCSharpCodePipelineStep"&gt;&lt;Bindings xmlns:d54p1="http://schemas.datacontract.org/2004/07/Neuron.ComponentModel" /&gt;&lt;BreakPoint&gt;Disable&lt;/BreakPoint&gt;&lt;Disable&gt;false&lt;/Disable&gt;&lt;Id&gt;30f33308-33bb-41d7-aec6-544dbc731cd6&lt;/Id&gt;&lt;Name&gt;Map From Get ML Ancestor&lt;/Name&gt;&lt;Uniquename /&gt;&lt;BreakPointLines xmlns:d54p1="http://schemas.microsoft.com/2003/10/Serialization/Arrays" /&gt;&lt;Code&gt;string uid = context.Data.ToXmlDocument().SelectSingleNode("/*[local-name()='MaterialLotAncestorResponse' and namespace-uri()='http://NeoPLM.com/EnterpriseIntegration']/*[local-name()='UID' and namespace-uri()='http://NeoPLM.com/EnterpriseIntegration']").InnerText;

context.Properties["ReferencedLotMaterialLotAncestorUID"] = uid;

context.Instance.TraceInformation ("Process Material Lot - Transaction ID: " + context.Properties["TransactionID"] + " Referenced MaterialLotAncestorMapUID: " + context.Properties["ReferencedLotMaterialLotAncestorUID"]);&lt;/Code&gt;&lt;ReferencedAssemblies xmlns:d54p1="http://schemas.microsoft.com/2003/10/Serialization/Arrays"&gt;&lt;d54p1:string&gt;Neuron&lt;/d54p1:string&gt;&lt;d54p1:string&gt;Neuron.Pipelines&lt;/d54p1:string&gt;&lt;d54p1:string&gt;Neuron.Esb&lt;/d54p1:string&gt;&lt;d54p1:string&gt;System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d54p1:string&gt;&lt;d54p1:string&gt;System.Core, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d54p1:string&gt;&lt;d54p1:string&gt;System.Xml, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d54p1:string&gt;&lt;d54p1:string&gt;System.Xml.Linq, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d54p1:string&gt;&lt;d54p1:string&gt;System.Data, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d54p1:string&gt;&lt;d54p1:string&gt;System.Data.DataSetExtensions, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d54p1:string&gt;&lt;d54p1:string&gt;System.Runtime.Serialization, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d54p1:string&gt;&lt;d54p1:string&gt;System.ServiceModel, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d54p1:string&gt;&lt;d54p1:string&gt;Newtonsoft.Json, Version=8.0.0.0, Culture=neutral, PublicKeyToken=30ad4fe6b2a6aeed&lt;/d54p1:string&gt;&lt;d54p1:string&gt;Microsoft.CSharp, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a&lt;/d54p1:string&gt;&lt;/ReferencedAssemblies&gt;&lt;TypeName&gt;Typece568c3124e4400a5ac44bc4bf86e0&lt;/TypeName&gt;&lt;/ESBMessagePipelineStep&gt;&lt;ESBMessagePipelineStep i:type="DecisionPipelineStepOfESBMessagexAPWb1W4"&gt;&lt;Bindings xmlns:d54p1="http://schemas.datacontract.org/2004/07/Neuron.ComponentModel" /&gt;&lt;BreakPoint&gt;Disable&lt;/BreakPoint&gt;&lt;Disable&gt;false&lt;/Disable&gt;&lt;Id&gt;9609a923-c7a4-4d6b-92c3-7bbef5fca815&lt;/Id&gt;&lt;Name&gt;Decision&lt;/Name&gt;&lt;Uniquename /&gt;&lt;Branches&gt;&lt;BranchOfESBMessagexAPWb1W4&gt;&lt;BreakPoint&gt;Disable&lt;/BreakPoint&gt;&lt;Condition i:type="CodeBranchConditionOfESBMessagexAPWb1W4"&gt;&lt;Code&gt;if (context.Properties["ReferencedLotMaterialLotAncestorUID"].ToString() == System.Guid.Empty.ToString())
	return true;
else
	return false;&lt;/Code&gt;&lt;ReferencedAssemblies xmlns:d57p1="http://schemas.microsoft.com/2003/10/Serialization/Arrays"&gt;&lt;d57p1:string&gt;Neuron&lt;/d57p1:string&gt;&lt;d57p1:string&gt;Neuron.Pipelines&lt;/d57p1:string&gt;&lt;d57p1:string&gt;Neuron.Esb&lt;/d57p1:string&gt;&lt;d57p1:string&gt;System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d57p1:string&gt;&lt;d57p1:string&gt;System.Core, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d57p1:string&gt;&lt;d57p1:string&gt;System.Xml, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d57p1:string&gt;&lt;d57p1:string&gt;System.Xml.Linq, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d57p1:string&gt;&lt;d57p1:string&gt;System.Data, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d57p1:string&gt;&lt;d57p1:string&gt;System.Data.DataSetExtensions, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d57p1:string&gt;&lt;d57p1:string&gt;System.Runtime.Serialization, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d57p1:string&gt;&lt;d57p1:string&gt;System.ServiceModel, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d57p1:string&gt;&lt;d57p1:string&gt;Newtonsoft.Json, Version=8.0.0.0, Culture=neutral, PublicKeyToken=30ad4fe6b2a6aeed&lt;/d57p1:string&gt;&lt;d57p1:string&gt;Microsoft.CSharp, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a&lt;/d57p1:string&gt;&lt;/ReferencedAssemblies&gt;&lt;/Condition&gt;&lt;Disable&gt;false&lt;/Disable&gt;&lt;EndJoined&gt;false&lt;/EndJoined&gt;&lt;Name&gt;Create Additional Data&lt;/Name&gt;&lt;Steps&gt;&lt;Bindings xmlns:d57p1="http://schemas.datacontract.org/2004/07/Neuron.ComponentModel" /&gt;&lt;BreakPoint&gt;Disable&lt;/BreakPoint&gt;&lt;Disable&gt;false&lt;/Disable&gt;&lt;Id&gt;5f6a37c8-8e0e-48fb-8b5b-f0c2d9c6463f&lt;/Id&gt;&lt;Name&gt;Group&lt;/Name&gt;&lt;Uniquename /&gt;&lt;Children&gt;&lt;ESBMessagePipelineStep i:type="d3p1:EsbMessageCSharpCodePipelineStep"&gt;&lt;Bindings xmlns:d59p1="http://schemas.datacontract.org/2004/07/Neuron.ComponentModel" /&gt;&lt;BreakPoint&gt;Disable&lt;/BreakPoint&gt;&lt;Disable&gt;false&lt;/Disable&gt;&lt;Id&gt;562f8fbd-d1f9-4741-93b0-18387b4f44c2&lt;/Id&gt;&lt;Name&gt;Map To Create ML Ancestor Map&lt;/Name&gt;&lt;Uniquename /&gt;&lt;BreakPointLines xmlns:d59p1="http://schemas.microsoft.com/2003/10/Serialization/Arrays" /&gt;&lt;Code&gt;// Retrieve the response template message
string mLAMRequestTemplate = context.Configuration.XmlDocs["MaterialLotAncestorMapSaveRequest"].Xml;

// Retrieve the Referenced Lot Template
string additionalDataTemplate = context.Configuration.XmlDocs["ReferencedLotTemplate"].Xml;

string additionalData = "&amp;lt;ReferencedLots&amp;gt;";

additionalData = additionalData + string.Format(additionalDataTemplate, context.Properties["ReferencedLotSourceSystemID"], 
	                        context.Properties["ReferencedLotPlantID"], context.Properties["ReferencedLotMaterialID"], 
	                        context.Properties["ReferencedLotMaterialLotID"]);

additionalData = additionalData + "&amp;lt;/ReferencedLots&amp;gt;";

additionalData = System.Net.WebUtility.HtmlEncode (additionalData);

// Create the request message
string mLAMRequest = string.Format(mLAMRequestTemplate, "Create", context.Properties["LocalServiceURI"], 
	                        context.Properties["MaterialLotUID"], System.Guid.Empty.ToString(), 
	                        context.Properties["ReferencedLotFacilityUID"], additionalData);

//Send the trace message to document the request message.
context.Instance.TraceInformation ("Process Material Lot - Message ID: " + context.Data.Header.MessageId.ToString() + " Request Message: " + mLAMRequest);
	
// Set message context to the request message 	
context.Data.Text = mLAMRequest;&lt;/Code&gt;&lt;ReferencedAssemblies xmlns:d59p1="http://schemas.microsoft.com/2003/10/Serialization/Arrays"&gt;&lt;d59p1:string&gt;Neuron&lt;/d59p1:string&gt;&lt;d59p1:string&gt;Neuron.Pipelines&lt;/d59p1:string&gt;&lt;d59p1:string&gt;Neuron.Esb&lt;/d59p1:string&gt;&lt;d59p1:string&gt;System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d59p1:string&gt;&lt;d59p1:string&gt;System.Core, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d59p1:string&gt;&lt;d59p1:string&gt;System.Xml, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d59p1:string&gt;&lt;d59p1:string&gt;System.Xml.Linq, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d59p1:string&gt;&lt;d59p1:string&gt;System.Data, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d59p1:string&gt;&lt;d59p1:string&gt;System.Data.DataSetExtensions, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d59p1:string&gt;&lt;d59p1:string&gt;System.Runtime.Serialization, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d59p1:string&gt;&lt;d59p1:string&gt;System.ServiceModel, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d59p1:string&gt;&lt;d59p1:string&gt;Newtonsoft.Json, Version=8.0.0.0, Culture=neutral, PublicKeyToken=30ad4fe6b2a6aeed&lt;/d59p1:string&gt;&lt;d59p1:string&gt;Microsoft.CSharp, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a&lt;/d59p1:string&gt;&lt;/ReferencedAssemblies&gt;&lt;TypeName&gt;Type53d7bb09f5b4e459d29b1eea21b471&lt;/TypeName&gt;&lt;/ESBMessagePipelineStep&gt;&lt;ESBMessagePipelineStep i:type="d3p1:EsbMessagePipelineExecutionPipelineStep"&gt;&lt;Bindings xmlns:d59p1="http://schemas.datacontract.org/2004/07/Neuron.ComponentModel" /&gt;&lt;BreakPoint&gt;Disable&lt;/BreakPoint&gt;&lt;Disable&gt;false&lt;/Disable&gt;&lt;Id&gt;4642167a-9f1a-49bf-86e6-ea0a422da4fe&lt;/Id&gt;&lt;Name&gt;Create ML Ancestor Map&lt;/Name&gt;&lt;Uniquename /&gt;&lt;d3p1:FileName i:nil="true" /&gt;&lt;d3p1:MaxInstances&gt;100&lt;/d3p1:MaxInstances&gt;&lt;d3p1:PipelineName&gt;Process_CreateUpdateMaterialLotAncestors&lt;/d3p1:PipelineName&gt;&lt;d3p1:PoolTimeout&gt;PT1M&lt;/d3p1:PoolTimeout&gt;&lt;/ESBMessagePipelineStep&gt;&lt;ESBMessagePipelineStep i:type="d3p1:EsbMessageCSharpCodePipelineStep"&gt;&lt;Bindings xmlns:d59p1="http://schemas.datacontract.org/2004/07/Neuron.ComponentModel" /&gt;&lt;BreakPoint&gt;Disable&lt;/BreakPoint&gt;&lt;Disable&gt;false&lt;/Disable&gt;&lt;Id&gt;95e89949-57b4-447d-8d9b-60cfda8fe3bb&lt;/Id&gt;&lt;Name&gt;Map From Create Ancestor Map&lt;/Name&gt;&lt;Uniquename /&gt;&lt;BreakPointLines xmlns:d59p1="http://schemas.microsoft.com/2003/10/Serialization/Arrays" /&gt;&lt;Code&gt;string mLAMUID = context.Data.GetProperty ("NeoPLM", "MaterialLotAncestorMapUID");

context.Instance.TraceInformation ("Process Material Lot - Transaction ID: " + context.Properties["TransactionID"] + " Referenced MaterialLotAncestorMapUID: " + mLAMUID);&lt;/Code&gt;&lt;ReferencedAssemblies xmlns:d59p1="http://schemas.microsoft.com/2003/10/Serialization/Arrays"&gt;&lt;d59p1:string&gt;Neuron&lt;/d59p1:string&gt;&lt;d59p1:string&gt;Neuron.Pipelines&lt;/d59p1:string&gt;&lt;d59p1:string&gt;Neuron.Esb&lt;/d59p1:string&gt;&lt;d59p1:string&gt;System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d59p1:string&gt;&lt;d59p1:string&gt;System.Core, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d59p1:string&gt;&lt;d59p1:string&gt;System.Xml, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d59p1:string&gt;&lt;d59p1:string&gt;System.Xml.Linq, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d59p1:string&gt;&lt;d59p1:string&gt;System.Data, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d59p1:string&gt;&lt;d59p1:string&gt;System.Data.DataSetExtensions, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d59p1:string&gt;&lt;d59p1:string&gt;System.Runtime.Serialization, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d59p1:string&gt;&lt;d59p1:string&gt;System.ServiceModel, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d59p1:string&gt;&lt;d59p1:string&gt;Newtonsoft.Json, Version=8.0.0.0, Culture=neutral, PublicKeyToken=30ad4fe6b2a6aeed&lt;/d59p1:string&gt;&lt;d59p1:string&gt;Microsoft.CSharp, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a&lt;/d59p1:string&gt;&lt;/ReferencedAssemblies&gt;&lt;TypeName&gt;Typeb6bc01bb6934ac4aaded15aa7b2612&lt;/TypeName&gt;&lt;/ESBMessagePipelineStep&gt;&lt;/Children&gt;&lt;/Steps&gt;&lt;/BranchOfESBMessagexAPWb1W4&gt;&lt;BranchOfESBMessagexAPWb1W4&gt;&lt;BreakPoint&gt;Disable&lt;/BreakPoint&gt;&lt;Condition i:type="AlwaysBranchConditionOfESBMessagexAPWb1W4" /&gt;&lt;Disable&gt;false&lt;/Disable&gt;&lt;EndJoined&gt;false&lt;/EndJoined&gt;&lt;Name&gt;Append Additional Data&lt;/Name&gt;&lt;Steps&gt;&lt;Bindings xmlns:d57p1="http://schemas.datacontract.org/2004/07/Neuron.ComponentModel" /&gt;&lt;BreakPoint&gt;Disable&lt;/BreakPoint&gt;&lt;Disable&gt;false&lt;/Disable&gt;&lt;Id&gt;e0412c7b-a274-4bf6-a71d-a7f1f6f33a31&lt;/Id&gt;&lt;Name&gt;Group&lt;/Name&gt;&lt;Uniquename /&gt;&lt;Children&gt;&lt;ESBMessagePipelineStep i:type="d3p1:EsbMessageCSharpCodePipelineStep"&gt;&lt;Bindings xmlns:d59p1="http://schemas.datacontract.org/2004/07/Neuron.ComponentModel" /&gt;&lt;BreakPoint&gt;Disable&lt;/BreakPoint&gt;&lt;Disable&gt;false&lt;/Disable&gt;&lt;Id&gt;5446db00-ba79-42c6-afbf-076c67c6b352&lt;/Id&gt;&lt;Name&gt;Map to Update ML Ancestor&lt;/Name&gt;&lt;Uniquename /&gt;&lt;BreakPointLines xmlns:d59p1="http://schemas.microsoft.com/2003/10/Serialization/Arrays" /&gt;&lt;Code&gt;string sourceSystemID = "";
string plantCodeID = "";
string materialID = "";
string materialLotID = "";
string additionalData = "";

// Retrieve the response template message
string mLAMRequestTemplate = context.Configuration.XmlDocs["MaterialLotAncestorMapSaveRequest"].Xml;

// Retrieve the Referenced Lot Template
string additionalDataTemplate = context.Configuration.XmlDocs["ReferencedLotTemplate"].Xml;

string moreAdditionalData = string.Format(additionalDataTemplate, context.Properties["ReferencedLotSourceSystemID"], 
	                        context.Properties["ReferencedLotPlantID"], context.Properties["ReferencedLotMaterialID"], 
	                        context.Properties["ReferencedLotMaterialLotID"]);

string priorAdditionalData = context.Data.ToXmlDocument().SelectSingleNode("/*[local-name()='MaterialLotAncestorResponse' and namespace-uri()='http://NeoPLM.com/EnterpriseIntegration']/*[local-name()='AdditionalData' and namespace-uri()='http://NeoPLM.com/EnterpriseIntegration']").InnerText;

priorAdditionalData = System.Net.WebUtility.HtmlDecode (priorAdditionalData);
context.Instance.TraceInformation (priorAdditionalData);

try
{

	// Load the previous state of the additional Data
	
	System.Xml.XmlDocument xDoc = new XmlDocument();
	xDoc.LoadXml (priorAdditionalData);
	

	context.Instance.TraceInformation ("Root Node: " + xDoc.DocumentElement.Name);
	if (xDoc.DocumentElement.Name == "ReferencedLots")
	{
		bool isMatch = false;
		foreach (System.Xml.XmlNode rLNode in xDoc.ChildNodes)
		{
			foreach (System.Xml.XmlNode cNode in rLNode.ChildNodes)
			{
				
			// SourceSystemID
			foreach(System.Xml.XmlNode node in cNode.ChildNodes) { 
				context.Instance.TraceInformation (node.LocalName);
				if(node.LocalName == "SourceSystemID") { sourceSystemID = node.InnerText; break; } 
			}
		
			// PlantID
			foreach(System.Xml.XmlNode node in cNode.ChildNodes) { if(node.LocalName == "PlantID") { plantCodeID = node.InnerText; break; } }

			// Material ID
			foreach(System.Xml.XmlNode node in cNode.ChildNodes) { if(node.LocalName == "MaterialID") { materialID = node.InnerText; break; } }

			// Material Lot ID
			foreach(System.Xml.XmlNode node in cNode.ChildNodes) { if(node.LocalName == "MaterialLotID") { materialLotID = node.InnerText; break; } }
		
			context.Instance.TraceInformation ("Source System ID: " + sourceSystemID);
			context.Instance.TraceInformation ("Plant ID: " + plantCodeID);
			context.Instance.TraceInformation ("Material ID: " + materialID);
			context.Instance.TraceInformation ("Material Lot ID: " + materialLotID);
			
			if (context.Properties["ReferencedLotSourceSystemID"].ToString() == sourceSystemID &amp;amp;&amp;amp;
				context.Properties["ReferencedLotPlantID"].ToString() == plantCodeID &amp;amp;&amp;amp;
				context.Properties["ReferencedLotMaterialID"].ToString() == materialID &amp;amp;&amp;amp;
				context.Properties["ReferencedLotMaterialLotID"].ToString() == materialLotID)
			{
				isMatch = true;
				context.Instance.TraceInformation ("We have a winner");
				additionalData = priorAdditionalData;
				break;
			}
			}
		}
		if (isMatch == false)
		{
			var doc1 = XDocument.Parse(moreAdditionalData);
			var doc2 = XDocument.Parse(priorAdditionalData).Element("ReferencedLots");
			context.Instance.TraceInformation (doc1.ToString());
			context.Instance.TraceInformation (doc2.ToString());
			
			doc2.Add(doc1.Nodes());
			
			additionalData = doc2.ToString();

			context.Instance.TraceInformation (additionalData);
			
		}
		
	}

	else
	{
		
	 	// Persisted Data is crapola, start a new document with the current data.
		additionalData = "&amp;lt;ReferencedLots&amp;gt;" + moreAdditionalData + "&amp;lt;/ReferencedLots&amp;gt;";
		context.Instance.TraceInformation ("Additional Data in the database is not of the expected structure; Starting a new collection");

		
	}
}
catch 
{

	//Persisted Data is crapola, start a new document with the current data.
	additionalData = "&amp;lt;ReferencedLots&amp;gt;" + moreAdditionalData + "&amp;lt;/ReferencedLots&amp;gt;";
	context.Instance.TraceInformation ("Additional Data in the database is not XML; Starting a new collection");
	
}

context.Instance.TraceInformation ("New Value of AdditionalData: " + additionalData);
additionalData = System.Net.WebUtility.HtmlEncode (additionalData);

// Create the request message
string mLAMRequest = string.Format(mLAMRequestTemplate, "Create/Update", context.Properties["LocalServiceURI"], 
	                        context.Properties["MaterialLotUID"], System.Guid.Empty.ToString(), 
	                        context.Properties["ReferencedLotFacilityUID"], additionalData);

//Send the trace message to document the request message.
context.Instance.TraceInformation ("Process Material Lot - Message ID: " + context.Data.Header.MessageId.ToString() + " Request Message: " + mLAMRequest);
	
// Set message context to the request message 	
context.Data.Text = mLAMRequest;&lt;/Code&gt;&lt;ReferencedAssemblies xmlns:d59p1="http://schemas.microsoft.com/2003/10/Serialization/Arrays"&gt;&lt;d59p1:string&gt;Neuron&lt;/d59p1:string&gt;&lt;d59p1:string&gt;Neuron.Pipelines&lt;/d59p1:string&gt;&lt;d59p1:string&gt;Neuron.Esb&lt;/d59p1:string&gt;&lt;d59p1:string&gt;System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d59p1:string&gt;&lt;d59p1:string&gt;System.Core, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d59p1:string&gt;&lt;d59p1:string&gt;System.Xml, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d59p1:string&gt;&lt;d59p1:string&gt;System.Xml.Linq, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d59p1:string&gt;&lt;d59p1:string&gt;System.Data, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d59p1:string&gt;&lt;d59p1:string&gt;System.Data.DataSetExtensions, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d59p1:string&gt;&lt;d59p1:string&gt;System.Runtime.Serialization, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d59p1:string&gt;&lt;d59p1:string&gt;System.ServiceModel, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d59p1:string&gt;&lt;d59p1:string&gt;Newtonsoft.Json, Version=8.0.0.0, Culture=neutral, PublicKeyToken=30ad4fe6b2a6aeed&lt;/d59p1:string&gt;&lt;d59p1:string&gt;Microsoft.CSharp, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a&lt;/d59p1:string&gt;&lt;/ReferencedAssemblies&gt;&lt;TypeName&gt;Typef88d7fdd36e4049a24f8c7e795027c&lt;/TypeName&gt;&lt;/ESBMessagePipelineStep&gt;&lt;ESBMessagePipelineStep i:type="d3p1:EsbMessagePipelineExecutionPipelineStep"&gt;&lt;Bindings xmlns:d59p1="http://schemas.datacontract.org/2004/07/Neuron.ComponentModel" /&gt;&lt;BreakPoint&gt;Disable&lt;/BreakPoint&gt;&lt;Disable&gt;false&lt;/Disable&gt;&lt;Id&gt;b3570f86-8c73-4700-8ab8-30a7b689a0b6&lt;/Id&gt;&lt;Name&gt;Update ML Ancestor Map&lt;/Name&gt;&lt;Uniquename /&gt;&lt;d3p1:FileName i:nil="true" /&gt;&lt;d3p1:MaxInstances&gt;100&lt;/d3p1:MaxInstances&gt;&lt;d3p1:PipelineName&gt;Process_CreateUpdateMaterialLotAncestors&lt;/d3p1:PipelineName&gt;&lt;d3p1:PoolTimeout&gt;PT1M&lt;/d3p1:PoolTimeout&gt;&lt;/ESBMessagePipelineStep&gt;&lt;ESBMessagePipelineStep i:type="d3p1:EsbMessageCSharpCodePipelineStep"&gt;&lt;Bindings xmlns:d59p1="http://schemas.datacontract.org/2004/07/Neuron.ComponentModel" /&gt;&lt;BreakPoint&gt;Disable&lt;/BreakPoint&gt;&lt;Disable&gt;false&lt;/Disable&gt;&lt;Id&gt;4ace3fc3-8541-457c-a835-bddb081c3278&lt;/Id&gt;&lt;Name&gt;Map From Update ML Ancestor&lt;/Name&gt;&lt;Uniquename /&gt;&lt;BreakPointLines xmlns:d59p1="http://schemas.microsoft.com/2003/10/Serialization/Arrays" /&gt;&lt;Code&gt;string mLAMUID = context.Data.GetProperty ("NeoPLM", "MaterialLotAncestorMapUID");

context.Instance.TraceInformation ("Process Material Lot - Transaction ID: " + context.Properties["TransactionID"] + " Referenced MaterialLotAncestorMapUID: " + mLAMUID);&lt;/Code&gt;&lt;ReferencedAssemblies xmlns:d59p1="http://schemas.microsoft.com/2003/10/Serialization/Arrays"&gt;&lt;d59p1:string&gt;Neuron&lt;/d59p1:string&gt;&lt;d59p1:string&gt;Neuron.Pipelines&lt;/d59p1:string&gt;&lt;d59p1:string&gt;Neuron.Esb&lt;/d59p1:string&gt;&lt;d59p1:string&gt;System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d59p1:string&gt;&lt;d59p1:string&gt;System.Core, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d59p1:string&gt;&lt;d59p1:string&gt;System.Xml, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d59p1:string&gt;&lt;d59p1:string&gt;System.Xml.Linq, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d59p1:string&gt;&lt;d59p1:string&gt;System.Data, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d59p1:string&gt;&lt;d59p1:string&gt;System.Data.DataSetExtensions, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d59p1:string&gt;&lt;d59p1:string&gt;System.Runtime.Serialization, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d59p1:string&gt;&lt;d59p1:string&gt;System.ServiceModel, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d59p1:string&gt;&lt;d59p1:string&gt;Newtonsoft.Json, Version=8.0.0.0, Culture=neutral, PublicKeyToken=30ad4fe6b2a6aeed&lt;/d59p1:string&gt;&lt;d59p1:string&gt;Microsoft.CSharp, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a&lt;/d59p1:string&gt;&lt;/ReferencedAssemblies&gt;&lt;TypeName&gt;Typee398f3014bb4f4d810d536b659c554&lt;/TypeName&gt;&lt;/ESBMessagePipelineStep&gt;&lt;/Children&gt;&lt;/Steps&gt;&lt;/BranchOfESBMessagexAPWb1W4&gt;&lt;/Branches&gt;&lt;/ESBMessagePipelineStep&gt;&lt;/Children&gt;&lt;/Steps&gt;&lt;/BranchOfESBMessagexAPWb1W4&gt;&lt;/Branches&gt;&lt;/ESBMessagePipelineStep&gt;&lt;/Children&gt;&lt;/Steps&gt;&lt;/BranchOfESBMessagexAPWb1W4&gt;&lt;BranchOfESBMessagexAPWb1W4&gt;&lt;BreakPoint&gt;Disable&lt;/BreakPoint&gt;&lt;Condition i:type="AlwaysBranchConditionOfESBMessagexAPWb1W4" /&gt;&lt;Disable&gt;false&lt;/Disable&gt;&lt;EndJoined&gt;false&lt;/EndJoined&gt;&lt;Name&gt;Vendor Lot&lt;/Name&gt;&lt;Steps&gt;&lt;Bindings xmlns:d47p1="http://schemas.datacontract.org/2004/07/Neuron.ComponentModel" /&gt;&lt;BreakPoint&gt;Disable&lt;/BreakPoint&gt;&lt;Disable&gt;false&lt;/Disable&gt;&lt;Id&gt;019340ea-d629-4d87-9fc4-e5af18e8dc76&lt;/Id&gt;&lt;Name&gt;Group&lt;/Name&gt;&lt;Uniquename /&gt;&lt;Children&gt;&lt;ESBMessagePipelineStep i:type="d3p1:EsbMessageCSharpCodePipelineStep"&gt;&lt;Bindings xmlns:d49p1="http://schemas.datacontract.org/2004/07/Neuron.ComponentModel" /&gt;&lt;BreakPoint&gt;Disable&lt;/BreakPoint&gt;&lt;Disable&gt;false&lt;/Disable&gt;&lt;Id&gt;026aa9b5-2549-43bf-9665-86ca681f9b21&lt;/Id&gt;&lt;Name&gt;Map To Create Material Lot&lt;/Name&gt;&lt;Uniquename /&gt;&lt;BreakPointLines xmlns:d49p1="http://schemas.microsoft.com/2003/10/Serialization/Arrays" /&gt;&lt;Code&gt;// Retrieve the response template message
string materialLotRequestTemplate = context.Configuration.XmlDocs["MaterialLotSave"].Xml;

// This is a placeholder material Lot.  These properties are set to the default values below.
string externalStatus = context.Properties["StatusID"].ToString();
string externalStatusDescription = context.Properties["StatusDescription"].ToString();
string lotStatus = context.Properties["StatusUID"].ToString();
string potency = context.Properties["Potency"].ToString();
string potencyLabel = context.Properties["EngineeringUnitID"].ToString();
string potencyUnits = context.Properties["EngineeringUnitUID"].ToString();
string supplierID = context.Properties["SupplierID"].ToString();
string supplierName = System.Net.WebUtility.HtmlEncode (context.Properties["SupplierName"].ToString());
string supplierLotID = context.Properties["ReferencedLotMaterialLotID"].ToString();
string lastModified = System.DateTime.UtcNow.ToString("yyyy-MM-ddTHH:mm:ssZ").ToString();

System.DateTime dt = System.DateTime.Parse(context.Properties["LastUpdateDateTime"].ToString());

string sourceLastModified = dt.ToUniversalTime().ToString ("yyyy-MM-ddTHH:mm:ssZ");

// Create the request message
string materialLotRequest = string.Format(materialLotRequestTemplate, "Update", context.Properties["LocalServiceURI"], 
	                        context.Properties["MaterialLotID"], context.Properties["FacilityUID"], 
	                        context.Properties["PlantCodeUID"], context.Properties["MaterialMasterUID"], 
	                        context.Properties["NeoMaterialType"], externalStatus, externalStatusDescription, 
	                        lotStatus, potency, potencyLabel, potencyUnits, supplierID, supplierName, 
	                        supplierLotID, lastModified, sourceLastModified );

//Send the trace message to document the request message.
context.Instance.TraceInformation ("Process Material Lot - Message ID: " + context.Data.Header.MessageId.ToString() + " Request Message: " + materialLotRequest);
	
// Set message context to the request message 	
context.Data.Text = materialLotRequest;&lt;/Code&gt;&lt;ReferencedAssemblies xmlns:d49p1="http://schemas.microsoft.com/2003/10/Serialization/Arrays"&gt;&lt;d49p1:string&gt;Neuron&lt;/d49p1:string&gt;&lt;d49p1:string&gt;Neuron.Pipelines&lt;/d49p1:string&gt;&lt;d49p1:string&gt;Neuron.Esb&lt;/d49p1:string&gt;&lt;d49p1:string&gt;System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d49p1:string&gt;&lt;d49p1:string&gt;System.Core, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d49p1:string&gt;&lt;d49p1:string&gt;System.Xml, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d49p1:string&gt;&lt;d49p1:string&gt;System.Xml.Linq, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d49p1:string&gt;&lt;d49p1:string&gt;System.Data, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d49p1:string&gt;&lt;d49p1:string&gt;System.Data.DataSetExtensions, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d49p1:string&gt;&lt;d49p1:string&gt;System.Runtime.Serialization, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d49p1:string&gt;&lt;d49p1:string&gt;System.ServiceModel, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d49p1:string&gt;&lt;d49p1:string&gt;Newtonsoft.Json, Version=8.0.0.0, Culture=neutral, PublicKeyToken=30ad4fe6b2a6aeed&lt;/d49p1:string&gt;&lt;d49p1:string&gt;Microsoft.CSharp, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a&lt;/d49p1:string&gt;&lt;/ReferencedAssemblies&gt;&lt;TypeName&gt;Type462126ea05c4d04b42064c3255e287&lt;/TypeName&gt;&lt;/ESBMessagePipelineStep&gt;&lt;ESBMessagePipelineStep i:type="d3p1:EsbMessagePipelineExecutionPipelineStep"&gt;&lt;Bindings xmlns:d49p1="http://schemas.datacontract.org/2004/07/Neuron.ComponentModel" /&gt;&lt;BreakPoint&gt;Disable&lt;/BreakPoint&gt;&lt;Disable&gt;false&lt;/Disable&gt;&lt;Id&gt;a103ed2b-35a8-4f9a-9821-5bcad06ed3c8&lt;/Id&gt;&lt;Name&gt;Update Material Lot&lt;/Name&gt;&lt;Uniquename /&gt;&lt;d3p1:FileName i:nil="true" /&gt;&lt;d3p1:MaxInstances&gt;100&lt;/d3p1:MaxInstances&gt;&lt;d3p1:PipelineName&gt;Process_CreateUpdateMaterialLot&lt;/d3p1:PipelineName&gt;&lt;d3p1:PoolTimeout&gt;PT1M&lt;/d3p1:PoolTimeout&gt;&lt;/ESBMessagePipelineStep&gt;&lt;ESBMessagePipelineStep i:type="d3p1:EsbMessageCSharpCodePipelineStep"&gt;&lt;Bindings xmlns:d49p1="http://schemas.datacontract.org/2004/07/Neuron.ComponentModel" /&gt;&lt;BreakPoint&gt;Disable&lt;/BreakPoint&gt;&lt;Disable&gt;false&lt;/Disable&gt;&lt;Id&gt;992fe8a4-52d0-4801-9770-48b9740dcab8&lt;/Id&gt;&lt;Name&gt;Map From Material Lot &lt;/Name&gt;&lt;Uniquename /&gt;&lt;BreakPointLines xmlns:d49p1="http://schemas.microsoft.com/2003/10/Serialization/Arrays" /&gt;&lt;Code&gt;string materialLotUID = context.Data.GetProperty ("NeoPLM", "MaterialLotUID");

context.Properties ["MaterialLotUID"] = materialLotUID;

context.Instance.TraceInformation ("Process Operations Performance - Transaction ID: " + context.Properties["TransactionID"] + " MaterialLotUID: " + context.Properties["MaterialLotUID"]);&lt;/Code&gt;&lt;ReferencedAssemblies xmlns:d49p1="http://schemas.microsoft.com/2003/10/Serialization/Arrays"&gt;&lt;d49p1:string&gt;Neuron&lt;/d49p1:string&gt;&lt;d49p1:string&gt;Neuron.Pipelines&lt;/d49p1:string&gt;&lt;d49p1:string&gt;Neuron.Esb&lt;/d49p1:string&gt;&lt;d49p1:string&gt;System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d49p1:string&gt;&lt;d49p1:string&gt;System.Core, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d49p1:string&gt;&lt;d49p1:string&gt;System.Xml, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d49p1:string&gt;&lt;d49p1:string&gt;System.Xml.Linq, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d49p1:string&gt;&lt;d49p1:string&gt;System.Data, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d49p1:string&gt;&lt;d49p1:string&gt;System.Data.DataSetExtensions, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d49p1:string&gt;&lt;d49p1:string&gt;System.Runtime.Serialization, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d49p1:string&gt;&lt;d49p1:string&gt;System.ServiceModel, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d49p1:string&gt;&lt;d49p1:string&gt;Newtonsoft.Json, Version=8.0.0.0, Culture=neutral, PublicKeyToken=30ad4fe6b2a6aeed&lt;/d49p1:string&gt;&lt;d49p1:string&gt;Microsoft.CSharp, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a&lt;/d49p1:string&gt;&lt;/ReferencedAssemblies&gt;&lt;TypeName&gt;Type9b5f9b02d894592bae05ea79ecad56&lt;/TypeName&gt;&lt;/ESBMessagePipelineStep&gt;&lt;/Children&gt;&lt;/Steps&gt;&lt;/BranchOfESBMessagexAPWb1W4&gt;&lt;/Branches&gt;&lt;/ESBMessagePipelineStep&gt;&lt;/Children&gt;&lt;CollectionPropertyName&gt;ReferencedLots&lt;/CollectionPropertyName&gt;&lt;ItemPropertyName&gt;ReferencedLot&lt;/ItemPropertyName&gt;&lt;TurnOffTrackExecution&gt;false&lt;/TurnOffTrackExecution&gt;&lt;/ESBMessagePipelineStep&gt;&lt;/Children&gt;&lt;/Steps&gt;&lt;/BranchOfESBMessagexAPWb1W4&gt;&lt;BranchOfESBMessagexAPWb1W4&gt;&lt;BreakPoint&gt;Disable&lt;/BreakPoint&gt;&lt;Condition i:type="AlwaysBranchConditionOfESBMessagexAPWb1W4" /&gt;&lt;Disable&gt;false&lt;/Disable&gt;&lt;EndJoined&gt;false&lt;/EndJoined&gt;&lt;Name&gt;Else&lt;/Name&gt;&lt;Steps&gt;&lt;Bindings xmlns:d40p1="http://schemas.datacontract.org/2004/07/Neuron.ComponentModel" /&gt;&lt;BreakPoint&gt;Disable&lt;/BreakPoint&gt;&lt;Disable&gt;false&lt;/Disable&gt;&lt;Id&gt;003b3bc0-fdac-41fd-8ca8-4797c0b5c41f&lt;/Id&gt;&lt;Name&gt;Group&lt;/Name&gt;&lt;Uniquename /&gt;&lt;Children /&gt;&lt;/Steps&gt;&lt;/BranchOfESBMessagexAPWb1W4&gt;&lt;/Branches&gt;&lt;/ESBMessagePipelineStep&gt;&lt;/Children&gt;&lt;/Steps&gt;&lt;/BranchOfESBMessagexAPWb1W4&gt;&lt;BranchOfESBMessagexAPWb1W4&gt;&lt;BreakPoint&gt;Disable&lt;/BreakPoint&gt;&lt;Condition i:type="AlwaysBranchConditionOfESBMessagexAPWb1W4" /&gt;&lt;Disable&gt;false&lt;/Disable&gt;&lt;EndJoined&gt;false&lt;/EndJoined&gt;&lt;Name&gt;Else&lt;/Name&gt;&lt;Steps&gt;&lt;Bindings xmlns:d35p1="http://schemas.datacontract.org/2004/07/Neuron.ComponentModel" /&gt;&lt;BreakPoint&gt;Disable&lt;/BreakPoint&gt;&lt;Disable&gt;false&lt;/Disable&gt;&lt;Id&gt;e6a1e93b-cc85-4290-85b3-95783e3b2f4c&lt;/Id&gt;&lt;Name&gt;Group&lt;/Name&gt;&lt;Uniquename /&gt;&lt;Children&gt;&lt;ESBMessagePipelineStep i:type="d3p1:EsbMessageCSharpCodePipelineStep"&gt;&lt;Bindings xmlns:d37p1="http://schemas.datacontract.org/2004/07/Neuron.ComponentModel" /&gt;&lt;BreakPoint&gt;Disable&lt;/BreakPoint&gt;&lt;Disable&gt;false&lt;/Disable&gt;&lt;Id&gt;52a9746c-e94d-4057-b912-849268e21cb8&lt;/Id&gt;&lt;Name&gt;Internal Tracing - Transaction Material Master&lt;/Name&gt;&lt;Uniquename /&gt;&lt;BreakPointLines xmlns:d37p1="http://schemas.microsoft.com/2003/10/Serialization/Arrays" /&gt;&lt;Code&gt;context.Instance.TraceInformation ("The Material Lot Transaction Lccal Service URI could not be resolved.");&lt;/Code&gt;&lt;ReferencedAssemblies xmlns:d37p1="http://schemas.microsoft.com/2003/10/Serialization/Arrays"&gt;&lt;d37p1:string&gt;Neuron&lt;/d37p1:string&gt;&lt;d37p1:string&gt;Neuron.Pipelines&lt;/d37p1:string&gt;&lt;d37p1:string&gt;Neuron.Esb&lt;/d37p1:string&gt;&lt;d37p1:string&gt;System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d37p1:string&gt;&lt;d37p1:string&gt;System.Core, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d37p1:string&gt;&lt;d37p1:string&gt;System.Xml, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d37p1:string&gt;&lt;d37p1:string&gt;System.Xml.Linq, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d37p1:string&gt;&lt;d37p1:string&gt;System.Data, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d37p1:string&gt;&lt;d37p1:string&gt;System.Data.DataSetExtensions, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d37p1:string&gt;&lt;d37p1:string&gt;System.Runtime.Serialization, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d37p1:string&gt;&lt;d37p1:string&gt;System.ServiceModel, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d37p1:string&gt;&lt;d37p1:string&gt;Newtonsoft.Json, Version=8.0.0.0, Culture=neutral, PublicKeyToken=30ad4fe6b2a6aeed&lt;/d37p1:string&gt;&lt;d37p1:string&gt;Microsoft.CSharp, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a&lt;/d37p1:string&gt;&lt;/ReferencedAssemblies&gt;&lt;TypeName&gt;Type8116962f77a4b0aaf7edfc5654be6c&lt;/TypeName&gt;&lt;/ESBMessagePipelineStep&gt;&lt;/Children&gt;&lt;/Steps&gt;&lt;/BranchOfESBMessagexAPWb1W4&gt;&lt;/Branches&gt;&lt;/ESBMessagePipelineStep&gt;&lt;/Children&gt;&lt;/Steps&gt;&lt;/BranchOfESBMessagexAPWb1W4&gt;&lt;BranchOfESBMessagexAPWb1W4&gt;&lt;BreakPoint&gt;Disable&lt;/BreakPoint&gt;&lt;Condition i:type="AlwaysBranchConditionOfESBMessagexAPWb1W4" /&gt;&lt;Disable&gt;false&lt;/Disable&gt;&lt;EndJoined&gt;false&lt;/EndJoined&gt;&lt;Name&gt;Else&lt;/Name&gt;&lt;Steps&gt;&lt;Bindings xmlns:d30p1="http://schemas.datacontract.org/2004/07/Neuron.ComponentModel" /&gt;&lt;BreakPoint&gt;Disable&lt;/BreakPoint&gt;&lt;Disable&gt;false&lt;/Disable&gt;&lt;Id&gt;f32598c2-0b1a-4ff4-84db-e11b08ab0250&lt;/Id&gt;&lt;Name&gt;Group&lt;/Name&gt;&lt;Uniquename /&gt;&lt;Children&gt;&lt;ESBMessagePipelineStep i:type="d3p1:EsbMessageCSharpCodePipelineStep"&gt;&lt;Bindings xmlns:d32p1="http://schemas.datacontract.org/2004/07/Neuron.ComponentModel" /&gt;&lt;BreakPoint&gt;Disable&lt;/BreakPoint&gt;&lt;Disable&gt;false&lt;/Disable&gt;&lt;Id&gt;d7853d56-30a6-479c-b5ad-76e3727f27fe&lt;/Id&gt;&lt;Name&gt;Internal Tracing - Transaction Material Master&lt;/Name&gt;&lt;Uniquename /&gt;&lt;BreakPointLines xmlns:d32p1="http://schemas.microsoft.com/2003/10/Serialization/Arrays" /&gt;&lt;Code&gt;context.Instance.TraceInformation ("The Material Lot Transaction Engineering Unit Label could not be resolved.");&lt;/Code&gt;&lt;ReferencedAssemblies xmlns:d32p1="http://schemas.microsoft.com/2003/10/Serialization/Arrays"&gt;&lt;d32p1:string&gt;Neuron&lt;/d32p1:string&gt;&lt;d32p1:string&gt;Neuron.Pipelines&lt;/d32p1:string&gt;&lt;d32p1:string&gt;Neuron.Esb&lt;/d32p1:string&gt;&lt;d32p1:string&gt;System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d32p1:string&gt;&lt;d32p1:string&gt;System.Core, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d32p1:string&gt;&lt;d32p1:string&gt;System.Xml, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d32p1:string&gt;&lt;d32p1:string&gt;System.Xml.Linq, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d32p1:string&gt;&lt;d32p1:string&gt;System.Data, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d32p1:string&gt;&lt;d32p1:string&gt;System.Data.DataSetExtensions, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d32p1:string&gt;&lt;d32p1:string&gt;System.Runtime.Serialization, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d32p1:string&gt;&lt;d32p1:string&gt;System.ServiceModel, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d32p1:string&gt;&lt;d32p1:string&gt;Newtonsoft.Json, Version=8.0.0.0, Culture=neutral, PublicKeyToken=30ad4fe6b2a6aeed&lt;/d32p1:string&gt;&lt;d32p1:string&gt;Microsoft.CSharp, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a&lt;/d32p1:string&gt;&lt;/ReferencedAssemblies&gt;&lt;TypeName&gt;Type8116962f77a4b0aaf7edfc5654be6c&lt;/TypeName&gt;&lt;/ESBMessagePipelineStep&gt;&lt;/Children&gt;&lt;/Steps&gt;&lt;/BranchOfESBMessagexAPWb1W4&gt;&lt;/Branches&gt;&lt;/ESBMessagePipelineStep&gt;&lt;/Children&gt;&lt;/Steps&gt;&lt;/BranchOfESBMessagexAPWb1W4&gt;&lt;BranchOfESBMessagexAPWb1W4&gt;&lt;BreakPoint&gt;Disable&lt;/BreakPoint&gt;&lt;Condition i:type="AlwaysBranchConditionOfESBMessagexAPWb1W4" /&gt;&lt;Disable&gt;false&lt;/Disable&gt;&lt;EndJoined&gt;false&lt;/EndJoined&gt;&lt;Name&gt;Else&lt;/Name&gt;&lt;Steps&gt;&lt;Bindings xmlns:d25p1="http://schemas.datacontract.org/2004/07/Neuron.ComponentModel" /&gt;&lt;BreakPoint&gt;Disable&lt;/BreakPoint&gt;&lt;Disable&gt;false&lt;/Disable&gt;&lt;Id&gt;0fc63af7-8826-4e22-9b42-345e54e3a6e4&lt;/Id&gt;&lt;Name&gt;Group&lt;/Name&gt;&lt;Uniquename /&gt;&lt;Children&gt;&lt;ESBMessagePipelineStep i:type="d3p1:EsbMessageCSharpCodePipelineStep"&gt;&lt;Bindings xmlns:d27p1="http://schemas.datacontract.org/2004/07/Neuron.ComponentModel" /&gt;&lt;BreakPoint&gt;Disable&lt;/BreakPoint&gt;&lt;Disable&gt;false&lt;/Disable&gt;&lt;Id&gt;786cef01-41ee-4bcc-8772-d8da3504e381&lt;/Id&gt;&lt;Name&gt;Internal Tracing - Transaction Material Master&lt;/Name&gt;&lt;Uniquename /&gt;&lt;BreakPointLines xmlns:d27p1="http://schemas.microsoft.com/2003/10/Serialization/Arrays" /&gt;&lt;Code&gt;context.Instance.TraceInformation ("The Goods Issue / Goods Receipt Transaction Material Lot Status could not be resolved.");&lt;/Code&gt;&lt;ReferencedAssemblies xmlns:d27p1="http://schemas.microsoft.com/2003/10/Serialization/Arrays"&gt;&lt;d27p1:string&gt;Neuron&lt;/d27p1:string&gt;&lt;d27p1:string&gt;Neuron.Pipelines&lt;/d27p1:string&gt;&lt;d27p1:string&gt;Neuron.Esb&lt;/d27p1:string&gt;&lt;d27p1:string&gt;System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d27p1:string&gt;&lt;d27p1:string&gt;System.Core, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d27p1:string&gt;&lt;d27p1:string&gt;System.Xml, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d27p1:string&gt;&lt;d27p1:string&gt;System.Xml.Linq, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d27p1:string&gt;&lt;d27p1:string&gt;System.Data, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d27p1:string&gt;&lt;d27p1:string&gt;System.Data.DataSetExtensions, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d27p1:string&gt;&lt;d27p1:string&gt;System.Runtime.Serialization, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d27p1:string&gt;&lt;d27p1:string&gt;System.ServiceModel, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d27p1:string&gt;&lt;d27p1:string&gt;Newtonsoft.Json, Version=8.0.0.0, Culture=neutral, PublicKeyToken=30ad4fe6b2a6aeed&lt;/d27p1:string&gt;&lt;d27p1:string&gt;Microsoft.CSharp, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a&lt;/d27p1:string&gt;&lt;/ReferencedAssemblies&gt;&lt;TypeName&gt;Type8116962f77a4b0aaf7edfc5654be6c&lt;/TypeName&gt;&lt;/ESBMessagePipelineStep&gt;&lt;/Children&gt;&lt;/Steps&gt;&lt;/BranchOfESBMessagexAPWb1W4&gt;&lt;/Branches&gt;&lt;/ESBMessagePipelineStep&gt;&lt;/Children&gt;&lt;/Steps&gt;&lt;/BranchOfESBMessagexAPWb1W4&gt;&lt;BranchOfESBMessagexAPWb1W4&gt;&lt;BreakPoint&gt;Disable&lt;/BreakPoint&gt;&lt;Condition i:type="AlwaysBranchConditionOfESBMessagexAPWb1W4" /&gt;&lt;Disable&gt;false&lt;/Disable&gt;&lt;EndJoined&gt;false&lt;/EndJoined&gt;&lt;Name&gt;Else&lt;/Name&gt;&lt;Steps&gt;&lt;Bindings xmlns:d20p1="http://schemas.datacontract.org/2004/07/Neuron.ComponentModel" /&gt;&lt;BreakPoint&gt;Disable&lt;/BreakPoint&gt;&lt;Disable&gt;false&lt;/Disable&gt;&lt;Id&gt;cf78b0fb-993f-4453-b04d-3699399bddd4&lt;/Id&gt;&lt;Name&gt;Group&lt;/Name&gt;&lt;Uniquename /&gt;&lt;Children&gt;&lt;ESBMessagePipelineStep i:type="d3p1:EsbMessageCSharpCodePipelineStep"&gt;&lt;Bindings xmlns:d22p1="http://schemas.datacontract.org/2004/07/Neuron.ComponentModel" /&gt;&lt;BreakPoint&gt;Disable&lt;/BreakPoint&gt;&lt;Disable&gt;false&lt;/Disable&gt;&lt;Id&gt;6d017b1a-41ca-4bad-8988-724956ce7aa8&lt;/Id&gt;&lt;Name&gt;Internal Tracing - Transaction Material Master&lt;/Name&gt;&lt;Uniquename /&gt;&lt;BreakPointLines xmlns:d22p1="http://schemas.microsoft.com/2003/10/Serialization/Arrays" /&gt;&lt;Code&gt;context.Instance.TraceInformation ("The Material Lot Transaction Material Master could not be resolved.");&lt;/Code&gt;&lt;ReferencedAssemblies xmlns:d22p1="http://schemas.microsoft.com/2003/10/Serialization/Arrays"&gt;&lt;d22p1:string&gt;Neuron&lt;/d22p1:string&gt;&lt;d22p1:string&gt;Neuron.Pipelines&lt;/d22p1:string&gt;&lt;d22p1:string&gt;Neuron.Esb&lt;/d22p1:string&gt;&lt;d22p1:string&gt;System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d22p1:string&gt;&lt;d22p1:string&gt;System.Core, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d22p1:string&gt;&lt;d22p1:string&gt;System.Xml, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d22p1:string&gt;&lt;d22p1:string&gt;System.Xml.Linq, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d22p1:string&gt;&lt;d22p1:string&gt;System.Data, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d22p1:string&gt;&lt;d22p1:string&gt;System.Data.DataSetExtensions, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d22p1:string&gt;&lt;d22p1:string&gt;System.Runtime.Serialization, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d22p1:string&gt;&lt;d22p1:string&gt;System.ServiceModel, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d22p1:string&gt;&lt;d22p1:string&gt;Newtonsoft.Json, Version=8.0.0.0, Culture=neutral, PublicKeyToken=30ad4fe6b2a6aeed&lt;/d22p1:string&gt;&lt;d22p1:string&gt;Microsoft.CSharp, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a&lt;/d22p1:string&gt;&lt;/ReferencedAssemblies&gt;&lt;TypeName&gt;Type8116962f77a4b0aaf7edfc5654be6c&lt;/TypeName&gt;&lt;/ESBMessagePipelineStep&gt;&lt;/Children&gt;&lt;/Steps&gt;&lt;/BranchOfESBMessagexAPWb1W4&gt;&lt;/Branches&gt;&lt;/ESBMessagePipelineStep&gt;&lt;/Children&gt;&lt;/Steps&gt;&lt;/BranchOfESBMessagexAPWb1W4&gt;&lt;BranchOfESBMessagexAPWb1W4&gt;&lt;BreakPoint&gt;Disable&lt;/BreakPoint&gt;&lt;Condition i:type="AlwaysBranchConditionOfESBMessagexAPWb1W4" /&gt;&lt;Disable&gt;false&lt;/Disable&gt;&lt;EndJoined&gt;false&lt;/EndJoined&gt;&lt;Name&gt;Else&lt;/Name&gt;&lt;Steps&gt;&lt;Bindings xmlns:d15p1="http://schemas.datacontract.org/2004/07/Neuron.ComponentModel" /&gt;&lt;BreakPoint&gt;Disable&lt;/BreakPoint&gt;&lt;Disable&gt;false&lt;/Disable&gt;&lt;Id&gt;75344b43-511a-424b-b50c-17f594cd5234&lt;/Id&gt;&lt;Name&gt;Group&lt;/Name&gt;&lt;Uniquename /&gt;&lt;Children&gt;&lt;ESBMessagePipelineStep i:type="d3p1:EsbMessageCSharpCodePipelineStep"&gt;&lt;Bindings xmlns:d17p1="http://schemas.datacontract.org/2004/07/Neuron.ComponentModel" /&gt;&lt;BreakPoint&gt;Disable&lt;/BreakPoint&gt;&lt;Disable&gt;false&lt;/Disable&gt;&lt;Id&gt;bd1bdf4c-0f46-46ce-b604-0fd058796195&lt;/Id&gt;&lt;Name&gt;Internal Tracing - External System UID&lt;/Name&gt;&lt;Uniquename /&gt;&lt;BreakPointLines xmlns:d17p1="http://schemas.microsoft.com/2003/10/Serialization/Arrays" /&gt;&lt;Code&gt;context.Instance.TraceInformation ("The Last Update Timestamp is not UTC Aware.");&lt;/Code&gt;&lt;ReferencedAssemblies xmlns:d17p1="http://schemas.microsoft.com/2003/10/Serialization/Arrays"&gt;&lt;d17p1:string&gt;Neuron&lt;/d17p1:string&gt;&lt;d17p1:string&gt;Neuron.Pipelines&lt;/d17p1:string&gt;&lt;d17p1:string&gt;Neuron.Esb&lt;/d17p1:string&gt;&lt;d17p1:string&gt;System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d17p1:string&gt;&lt;d17p1:string&gt;System.Core, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d17p1:string&gt;&lt;d17p1:string&gt;System.Xml, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d17p1:string&gt;&lt;d17p1:string&gt;System.Xml.Linq, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d17p1:string&gt;&lt;d17p1:string&gt;System.Data, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d17p1:string&gt;&lt;d17p1:string&gt;System.Data.DataSetExtensions, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d17p1:string&gt;&lt;d17p1:string&gt;System.Runtime.Serialization, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d17p1:string&gt;&lt;d17p1:string&gt;System.ServiceModel, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/d17p1:string&gt;&lt;d17p1:string&gt;Newtonsoft.Json, Version=8.0.0.0, Culture=neutral, PublicKeyToken=30ad4fe6b2a6aeed&lt;/d17p1:string&gt;&lt;d17p1:string&gt;Microsoft.CSharp, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a&lt;/d17p1:string&gt;&lt;/ReferencedAssemblies&gt;&lt;TypeName&gt;Type8116962f77a4b0aaf7edfc5654be6c&lt;/TypeName&gt;&lt;/ESBMessagePipelineStep&gt;&lt;/Children&gt;&lt;/Steps&gt;&lt;/BranchOfESBMessagexAPWb1W4&gt;&lt;/Branches&gt;&lt;/ESBMessagePipelineStep&gt;&lt;/Children&gt;&lt;CollectionPropertyName&gt;MaterialLots&lt;/CollectionPropertyName&gt;&lt;ItemPropertyName&gt;MaterialLot&lt;/ItemPropertyName&gt;&lt;TurnOffTrackExecution&gt;false&lt;/TurnOffTrackExecution&gt;&lt;/ESBMessagePipelineStep&gt;&lt;/Children&gt;&lt;/Try&gt;&lt;/ESBMessagePipelineStep&gt;&lt;/Children&gt;&lt;/OnValid&gt;&lt;Properties xmlns:d4p1="http://schemas.microsoft.com/2003/10/Serialization/Arrays" /&gt;&lt;Schemas xmlns:d4p1="http://schemas.microsoft.com/2003/10/Serialization/Arrays" /&gt;&lt;ValidationFlags&gt;ReportValidationWarnings&lt;/ValidationFlags&gt;&lt;d3p1:SchemaLocation i:nil="true" /&gt;&lt;d3p1:SchemaNames&gt;Guid;NeoPlmErpMaterialLot&lt;/d3p1:SchemaNames&gt;&lt;/ESBMessagePipelineStep&gt;&lt;ESBMessagePipelineStep i:type="CancelPipelineStepOfESBMessagexAPWb1W4"&gt;&lt;Bindings xmlns:d4p1="http://schemas.datacontract.org/2004/07/Neuron.ComponentModel" /&gt;&lt;BreakPoint&gt;Disable&lt;/BreakPoint&gt;&lt;Disable&gt;false&lt;/Disable&gt;&lt;Id&gt;10147642-45a6-4cee-9d02-f3b1fb7a7eee&lt;/Id&gt;&lt;Name&gt;Cancel&lt;/Name&gt;&lt;Uniquename /&gt;&lt;/ESBMessagePipelineStep&gt;&lt;/Steps&gt;&lt;/ESBMessagePipeline&gt;</PipelineBlob>
  <IsProcessFlow>false</IsProcessFlow>
</ESBMessagePipelineStorage>